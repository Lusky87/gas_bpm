<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ include file="/hncis/include/common_sub.gas" %>
<%
	String menuId = "XBT10";
	String hid_doc_no = StringUtil.replaceParameter(StringUtil.isNullToString(request.getParameter("hid_doc_no")));
	String hid_eeno  = StringUtil.replaceParameter(StringUtil.isNullToString(request.getParameter("hid_eeno")));
	String temp_doc_no = StringUtil.replaceParameter(StringUtil.isNullToString(request.getParameter("hid_doc_no")));
	String hid_csrfToken  = StringUtil.replaceParameter(StringUtil.isNullToString(request.getParameter("hid_csrfToken")));
	String hid_cond 	  = StringUtil.replaceParameter(StringUtil.isNullToString(request.getParameter("hid_cond")));
	String hid_view_nm    = StringUtil.replaceParameter(StringUtil.isNullToString(request.getParameter("hid_view_nm")));

	String param1 = "PT002";

	String yy = CurrentDateTime.getDate().substring(0, 4);
	String mm = CurrentDateTime.getDate().substring(4, 6);
	String dd = CurrentDateTime.getDate().substring(6, 8);
	String yymmdd = yy + "-" + mm + "-" + dd;

	String strNew = JSPMessageSource.getMessage("BUTTON.NEW",locale);
	String strSav = JSPMessageSource.getMessage("BUTTON.SAVE", locale);
	String strDel = JSPMessageSource.getMessage("BUTTON.DELETE", locale);
	String strReq = JSPMessageSource.getMessage("BUTTON.REQUEST", locale);
	String strRqc = JSPMessageSource.getMessage("BUTTON.REQUESTCANCEL", locale);
	String strCfc = JSPMessageSource.getMessage("BUTTON.CONFIRMCANCEL", locale);
	String strPrn = JSPMessageSource.getMessage("BUTTON.PRINT", locale);
	String strBck = JSPMessageSource.getMessage("BUTTON.BACK", locale);
	String str1stCfm = JSPMessageSource.getMessage("BUTTON.1STCONFIRM", locale);
	String str2stCfm = JSPMessageSource.getMessage("BUTTON.2NDCONFIRM", locale);
	String strAtc = JSPMessageSource.getMessage("BUTTON.AFTERCAL", locale);

	if(StringUtil.isEmpty(hid_doc_no)){
		temp_doc_no = StringUtil.getDocNo();
	}

	String strBtn = "";
	strBtn = strNew+"/new@"+strSav+"/save@"+strDel+"/delete@"+strReq+"/request@"+strRqc+"/requestCancel@"+strAtc+"/afterCal@"+str1stCfm+"/confirm3@"+str2stCfm+"/confirm@"+strCfc+"/reject";

	if(!"".equals(hid_doc_no)){
		strBtn += "@"+strBck+"/back";
	}

	String approveStepLevel = CommonGasc.getApproveStepLevel(menuId, request);

	String tempPath     = request.getServletPath().toString();
	String stepHelpUrl  = StringUtil.getStepHelp(tempPath);
%>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<title>국내출장 신청</title>
	</head>
	<body>
		<div id="wrap">
    	<form id="mainForm" name="mainForm">
			<input type="hidden" id="nSource" name="nSource">
			<input type="hidden" id="hid_doc_no" name="hid_doc_no" value="<%=hid_doc_no%>">
			<input type="hidden" id="hid_eeno" name="hid_eeno" value="<%=hid_eeno%>">
			<input type="hidden" id="temp_doc_no" name="temp_doc_no" value="<%=temp_doc_no%>">
			<input type="hidden" id="if_id" name="if_id">
			<input type="hidden" id="cancel_yn" name="cancel_yn">
			<input type="hidden" id="process_yn" value="N">
			<input type="hidden" id="nat_g_scn_cd" name="nat_g_scn_cd">
			<input type="hidden" id="dest_nat_cd" name="dest_nat_cd">
			<input type="hidden" id="ipe_eeno" name="ipe_eeno">
			<input type="hidden" id="acpc_pgs_st_cd" name="acpc_pgs_st_cd">
			<input type="hidden" id="dom_abrd_scn_cd" name="dom_abrd_scn_cd" value="<%=param1%>">
			<input type="hidden" id="hid_cond" name="hid_cond" value="<%=hid_cond%>">
			<input type="hidden" id="hid_view_nm" name="hid_view_nm" value="<%=hid_view_nm%>">
			<input type="hidden" id="approveStepLevel" value="<%=approveStepLevel%>">
			<input type="hidden" id="help_url" name="help_url" value="<%=stepHelpUrl%>">

	    	<%@ include file="../include/hncis_header.gas"%>
	        <div id="contents_wrap">
	        	<%@ include file="../include/hncis_left.gas"%>
	            <div id="contents">
	            	<%=CommonGasc.getTitleAndButtonNew(sess_empno
						,menuId
						,strBtn
						,"1"
						,"2"
						,null
						,"Y"
						,request)
					%>
	                <div class="con_t_area mt10">
	                	<h3><fmt:message key="basic_info"/></h3>
	                </div>
	                <div class="search_area">
	                	<table>
	                        <colgroup>
	                        	<col style="width:110px;" />

	                            <col style="width:158px;" />
	                            <col style="width:73px;" />
	                            <col style="width:158px;" />
	                            <col style="width:80px;" />
	                            <col style="width:158px;" />
	                            <col style="width:73px;" />
	                            <col style="width:158px;" />
	                        </colgroup>
	                        <tbody>
	                            <tr>
									<th class="div_nameF"><fmt:message key="eeno"/></th>
									<td class="inputF">
										<input type="text" id="eeno" name="eeno" style="width:140px;" onkeyup="setInsaInfo();" class="disabled">
									</td>
									<th class="div_name"><fmt:message key="eenm"/></th>
									<td class="inputS">
										<input type="text" id="ee_nm" name="ee_nm" style="width:140px;" class="disabled" readonly>
									</td>
									<th class="div_name"><fmt:message key="position"/></th>
									<td class="inputT">
										<input type="text" id="poa_nm" name="poa_nm" style="width:140px;" class="disabled" readonly>
									</td>
									<th class="div_nameF"><fmt:message key="dept_nm"/></th>
									<td class="inputF">
										<input type="text" id="ops_nm" name="ops_nm" style="width:140px;" class="disabled" readonly>
										<input type="hidden" id="ops_cd" name="ops_cd" readonly>
										<input type="hidden" id="keyOpsCd" name="keyOpsCd" readonly>
									</td>
								</tr>
								<tr>
									<th class="div_nameF"><fmt:message key="req_ymd"/></th>
									<td class="inputF">
										<input type="text" id="ptt_ymd" name="ptt_ymd" style="width:140px;" value="<%=yymmdd%>"  class="disabled">
									</td>
									<th class="div_name"><fmt:message key="doc_no"/></th>
									<td class="inputS">
										<input type="text" id="doc_no" name="doc_no" style="width:140px;" class="disabled">
									</td>
									<th class="div_name"><fmt:message key="pgs_st_nm"/></th>
									<td class="inputT">
										<input type="hidden" id="pgs_st_cd" name="pgs_st_cd" style="width:30px" readOnly>
										<input type="text" id="pgs_st_nm" name="pgs_st_nm" style="width:140px;" class="disabled">
									</td>
									<th class="div_name"><fmt:message key="tel_no"/></th>
									<td class="inputT">
										<input type="text" id="tel_no" name="tel_no" style="width:140px;" class="disabled"/>
									</td>
								</tr>
								<tr>
									<th class="div_nameF"><fmt:message key="rtn_rsn"/></th>
									<td class="inputF" colspan="7">
										<input type="text" id="snb_rson_sbc" name="snb_rson_sbc" style="width:843px" class="disabled">
									</td>
								</tr>
	                        </tbody>
	                    </table>
	                </div>
	                <div class="con_t_area">
	                	<h3 class="fl"><fmt:message key="bns_tr_info"/></h3>
	                	<div class="btn_area mt0">
		                    <ul class="btns fr">
		                        <li><a href="javascript:doFileAttach();"><fmt:message key="BUTTON.FILE_ATTACH.TR"/><span></span></a></li>
		                    </ul>
		                </div>
	                </div>
	                <div class="search_area">
	                	<table>
	                        <colgroup>
	                        	<col style="width:100px;" />
	                            <col style="width:350px;" />
	                            <col style="width:100px;" />
	                            <col style="width:auto;" />
	                        </colgroup>
	                        <tbody>
	                            <tr style="display:none;">
									<th><fmt:message key="cont"/></th>
									<td>
										<select id="nat_g_scn_cd_temp" name="nat_g_scn_cd_temp" style="width:200px" onChange="changeCountryGroup(this.value);">
											<option value=""><fmt:message key="select"/></option>
										</select>
									</td>
								</tr>
								<tr>
									<th><fmt:message key="ntn"/></th>
									<td>
										<select id="dest_nat_cd_temp" name="dest_nat_cd_temp" style="width:105px" class="req-data">
											<option value=""><fmt:message key="select"/></option>
										</select>
										<input type="text" id="dest_dtl_sbc" name="dest_dtl_sbc" style="width:200px" class="req-data"/>
									</td>
									<th><fmt:message key="schedule"/></th>
									<td>
										<input type="text" id="strt_ymd" style="width:100px" onPropertyChange="setDateGap();" maxlength="10" class="req-data" readonly/>
										~
										<input type="text" id="fnh_ymd" style="width:100px" onPropertyChange="setDateGap();" maxlength="10" class="req-data" readonly/>
									</td>
								</tr>
								<tr>
									<th><fmt:message key="purp"/></th>
									<td colspan="3">
										<input type="text" id="vsit_purp_sbc" name="vsit_purp_sbc" style="width:100%" class="req-data"/>
									</td>
								</tr>
	                        </tbody>
	                    </table>
	                </div>
	                <div class="con_t_area">
	                	<h3 class="fl"><fmt:message key="bns_prsn_info"/></h3>
	                	<div class="btn_area mt0">
		                    <ul class="btns fr">
		                        <li><a href="javascript:doStandardExpenseOpen();"><fmt:message key="BUTTON.STANDARD.TR"/><span></span></a></li>
		                        <li><a href="javascript:addRow();"><fmt:message key="BUTTON.ADD.ROW"/><span></span></a></li>
		                        <li><a href="javascript:travelerDelete();"><fmt:message key="BUTTON.DELETE"/><span></span></a></li>
		                    </ul>
		                </div>
	                </div>
	                <div class="jq_tbl">
	                	<table id="htmlTable1" class="scroll"></table>
	                </div>

	                <div id="oversee_area">
		                <div class="con_t_area">
		                	<h3 class="fl"><fmt:message key="air_info"/></h3>
		                	<div class="btn_area mt0">
			                    <ul class="btns fr">
			                        <li><a href="javascript:addFlightRow();"><fmt:message key="BUTTON.ADD.ROW"/><span></span></a></li>
			                        <li><a href="javascript:flightDelete();"><fmt:message key="BUTTON.DELETE"/><span></span></a></li>
			                        <li><a href="javascript:doFileAttachCmpx('FC');"><fmt:message key="BUTTON.FILE_ATTACH"/><span></span></a></li>
			                    </ul>
			                </div>
		                </div>
		                <div class="jq_tbl">
		                	<table id="htmlTable3" class="scroll"></table>
		                </div>

		                <div class="con_t_area">
		                	<h3 class="fl"><fmt:message key="sty_info"/></h3>
		                	<div class="btn_area mt0">
			                    <ul class="btns fr">
			                        <li><a href="javascript:addHotelRow();"><fmt:message key="BUTTON.ADD.ROW"/><span></span></a></li>
			                        <li><a href="javascript:hotelDelete();"><fmt:message key="BUTTON.DELETE"/><span></span></a></li>
			                        <li><a href="javascript:doFileAttachCmpx('HC');"><fmt:message key="BUTTON.FILE_ATTACH"/><span></span></a></li>
			                    </ul>
			                </div>
		                </div>
		                <div class="jq_tbl">
		                	<table id="htmlTable4" class="scroll"></table>
		                </div>

		                <div class="con_t_area">
		                	<h3 class="fl"><fmt:message key="rent_car"/></h3>
		                	<div class="btn_area mt0">
			                    <ul class="btns fr">
			                        <li><a href="javascript:addRentRow();"><fmt:message key="BUTTON.ADD.ROW"/><span></span></a></li>
			                        <li><a href="javascript:rentDelete();"><fmt:message key="BUTTON.DELETE"/><span></span></a></li>
			                        <li><a href="javascript:doFileAttachCmpx('RC');"><fmt:message key="BUTTON.FILE_ATTACH"/><span></span></a></li>
			                    </ul>
			                </div>
		                </div>
		                <div class="jq_tbl">
		                	<table id="htmlTable5" class="scroll"></table>
		                </div>
		            </div>
	                <div class="con_t_area">
	                	<h3 id="oversee_text" title="Memo all reservation information of your travel." onmouseover="tooltipDisplay('caption');" class="fl"><fmt:message key="rem_sbc"/></h3>
	                	<div class="btn_area mt0">
		                    <ul class="btns fr">
<!-- 		                        <li><a href="javascript:doConfirmation('CO');"><fmt:message key="BUTTON.FILE_ATTACH"/><span></span></a></li> -->
		                        <li><a href="javascript:doFileAttachCmpx('CO');"><fmt:message key="BUTTON.FILE_ATTACH"/><span></span></a></li>
		                    </ul>
		                </div>
	                </div>
	                <textarea id="prct_sbc" name="prct_sbc" class="sub_textarea" rows="8" cols="0"></textarea>
	                <%@ include file="../include/hncis_message.gas"%>
	            </div>
	            <div class="clear"></div>
	        </div>
        </form>
		<form id="reportForm" name="reportForm">
			<input type="hidden" id="hid_report_doc_no"	name="hid_report_doc_no">
			<input type="hidden" id="hid_report_eeno" 	name="hid_report_eeno">
			<input type="hidden" id="hid_report_pgs_st_cd" 	name="hid_report_pgs_st_cd">
			<input type="hidden" id="hid_csrfToken" name="hid_csrfToken">
		</form>
		<form id="fileForm" name="fileForm">
			<input type="hidden" id="file_doc_no" name="file_doc_no">
			<input type="hidden" id="file_eeno"  name="file_eeno">
			<input type="hidden" id="req_eeno"  name="req_eeno">
			<input type="hidden" id="hid_csrfToken" name="hid_csrfToken">
		</form>
		<form id="hideForm" name="hideForm" method="post">
			<input type="hidden" id="hid_csrfToken" name="hid_csrfToken">
		</form>
	    </div>
	    <img id="loading_progress_img" src="<%=ctxPath %>/images/common/progress_bar.gif" width="362" height="131" style="display:none" />
	</body>
</html>

	<script type="text/javascript">
		var params;
		var userKeyArr = ['ee_nm','ops_cd', 'ops_nm', 'poa_nm', 'cost_cd'];
		var userColArr = ['xusr_name','xusr_dept_code', 'xusr_dept_name', 'xusr_step_name', 'xusr_cost_cd'];
		var comboVal;
		var comboVal_nat;
		var congryGroupVal;
		var natFlag = true;
		var row_no1 = 0;
		var row_no2 = 0;
		var row_no3 = 0;
		var row_no4 = 0;

		function fnSetDocumentReady(){
			initMenus('1850');
			$('#BT').slideDown('fast');

			$("#eeno").val(sess_empno);
			$("#ee_nm").val(sess_name);

			$(".inputOnlyNumber").numeric();

			$("#strt_ymd").datepicker({ dateFormat: "yy-mm-dd" });
			$("#fnh_ymd").datepicker({ dateFormat: "yy-mm-dd" });

			if($("#hid_doc_no").val() != ""){
				$("#doc_no").val($("#hid_doc_no").val());
				$("#eeno").val($("#hid_eeno").val());
			}

			setInsaInfo();
			sess_auth = $("#work_auth").val();
			chk_auth();
		}

		var url = "", gridName1 = "htmlTable1", gridName3 = "htmlTable3", gridName4 = "htmlTable4", gridName5 = "htmlTable5";
		var datarow = {doc_no:"", seq:"", pgs_st_cd:"", eeno:"", ee_nm:"", ops_cd:"", ops_nm:"", poa_nm:"", visa_yn:"", cost_cd:"", flht_utz_amt:"", bztp_lodg_exp:"", rent_amt:"", vs_ptt_exp:"",etc_amt:"", pgs_st_nm:"", cost_info:"",pass_country:"",pass_number:"",birth_ymd:"",issue_ymd:"",expire_ymd:""};
		var flight_datarow = {flt_doc_no:"",flt_seq:"", flt_flt_ymd:"", flt_air_lines:"", flt_flight:"", flt_flt_from:"", flt_flt_to:"", flt_departure_time:"", flt_arrive_time:"", flt_seat:"", flt_etc_amt:""};
		var hotel_datarow  = {htl_doc_no:"",htl_seq:"", htl_check_in_ymd:"", htl_check_out_ymd:"", htl_hotel_name:"", htl_hotel_addr:"", htl_hotel_phone:"", htl_pay_form:"", htl_confirmation:"", htl_meal_yn:"", htl_etc_amt:""};
		var rent_datarow   = {rent_doc_no:"",rent_seq:"", rent_check_in_ymd:"", rent_check_out_ymd:"", rent_car_company:"", rent_car_type:"", rent_car_phone:"", rent_pay_form:"", rent_confirmation:"", rent_air_yn:"", rent_etc_amt:""};

		function setComboInfo(){
			setMultiComboInfo();
		}

		function setComboInfoCallBack(jsonData){
			comboVal = jsonData;
			comboVal_nat = jsonData;
			initAfterMenus();

			changeAbrd($("#dom_abrd_scn_cd").val(),"Y");

			getCommonCode("htl_pay_form:X3021;rent_air_yn:X3030;", "Y", "init();");
		}

		function setMultiComboInfo(){
			var params = {
				codknd		: 'nat_g_scn_cd_temp:X0017:;dest_nat_cd_temp:visit:S;'
			};

			doCommonAjax("/getCommonMultiComboByTask.do", params,"setComboInfoCallBack(jsonData.sendResult);");
		}

		function init(){
			var url = "/doSearchToEmpty.do";

			$("#"+gridName1).GridUnload();
// 			cn = ["문서번호", "SEQ", "진행상태코드", "사번", "이름", "부서코드", "부서", "직급", "비자", "Cost<BR>Center", "항공티켓", "숙박", "렌트카", "비자", "BTR<BR>FORECAST", "진행상태", "BTR", "여권", "여권번호", "출생일", "발행일", "만료일"];
			var cn = ['' // "문서번호"
			          ,'' // "SEQ"
			          ,'' // "진행상태코드"
			          ,'<fmt:message key="eeno"/>' // "사번"
			          ,'<fmt:message key="eenm"/>' // "이름"
			          ,'' // "부서코드"
			          ,'<fmt:message key="dept_nm"/>' // "부서"
			          ,'<fmt:message key="position"/>' // "직급"
			          ,'' // "비자"
			          ,'' // "Cost center"
			          ,'' // "항공티켓"
			          ,'' // "숙박"
			          ,'' // "렌트카"
			          ,'' // "비자"
			          ,'' // "cost center"
			          ,'<fmt:message key="pgs_st_nm"/>' // "진행상태"
			          ,'' // "btr"
			          ,'' // "여권"
			          ,'' // "여권번호"
			          ,'' // "출생일"
			          ,'' // "발행일"
			          ,'' // "만료일"
		          ];
			cm = [
					{name:"doc_no",		index:"doc_no"		, sortable:false,	formatter:"string",		width:0,	align:"left",	editable:true,	frozen : false, hidden : true},
					{name:"seq",		index:"seq"			, sortable:false,	formatter:"string",		width:0,	align:"left",	editable:true,	frozen : false, hidden : true},
					{name:"pgs_st_cd",	index:"pgs_st_cd"	, sortable:false,	formatter:"string",		width:0,	align:"left",	editable:true,	frozen : false, hidden : true},
					{name:"eeno",		index:"eeno"		, sortable:false,	formatter:"string",		width:131,	align:"center",	editable:true,	frozen : false,
						editoptions:{dataEvents:[{type:'keyup',
								fn:function(e){
// 									if(!isNumeric($(e.target).val())){
// 										$(e.target).val(selectNum($(e.target).val()));
// 									}

									var row = $(e.target).closest('tr.jqgrow');
									var rowId = row.attr('id');
									if(getColValue("doc_no", rowId, gridName1) != ""){
										return;
									}
									searchToUserInfo(rowId, 'eeno');
								}
							},
							{type:'keydown',
								fn:function(e){
									var row = $(e.target).closest('tr.jqgrow');
									var rowId = row.attr('id');
									if(getColValue("doc_no", rowId, gridName1) != ""){
										return;
									}
								}
							}]
				        },
				        cellattr:function(rowId, tv, rowObject, cm, rdata){
				        }
					},
					{name:"ee_nm",		index:"ee_nm"		, sortable:false,	formatter:"string",		width:180,	align:"left",	editable:false,	frozen : false},
					{name:"ops_cd",		index:"ops_cd"		, sortable:false,	formatter:"string",		width:0,	align:"left",	editable:false,	frozen : false, hidden : true},
					{name:"ops_nm",		index:"ops_nm"		, sortable:false,	formatter:"string",		width:180,	align:"left",	editable:false,	frozen : false},
					{name:"poa_nm",		index:"poa_nm"		, sortable:false,	formatter:"string",		width:180,	align:"left",	editable:false,	frozen : false},
					{name:'visa_yn',	index:'visa_yn'		, sortable:false,	formatter:"select",		width:100, 	align:"center",	editable:true, 	edittype:'select', hidden:true,
						editoptions:{
							value:"Y:Y;N:N",
							dataInit: function(elem) {
								$(elem).width(100);
							}
						}
					},
					{name:"cost_cd",	index:"cost_cd"		, sortable:false,	formatter:"string",		width:50,	align:"center",	editable:true,	frozen : false, hidden:true,
						editoptions: {maxlength:"5"}},
					{name:"flht_utz_amt",	index:"flht_utz_amt"	, sortable:false,formatter: "currency", hidden:true, formatoptions: {
						thousandsSeparator:",",
					    decimalPlaces:0,
					    defaultValue:""
					  },		width:100,	align:"right",	editable:true,	frozen : false,
						editoptions: {maxlength:"10",
				            dataInit: function(element) {
				     		    $(element).keyup(function(){
				     		    	if(!isNumeric(element.value)){
				     		    		element.value = selectNum(element.value, ",");
				     		    	}
				     		    });
				            }
				        }
					  },
					  {name:"bztp_lodg_exp",	index:"bztp_lodg_exp"	, sortable:false,formatter: "currency", hidden:true, formatoptions: {
						  	thousandsSeparator:",",
						    decimalPlaces:0,
						    defaultValue:""
						  },		width:100,	align:"right",	editable:true,	frozen : false,
							editoptions: {maxlength:"10",
					            dataInit: function(element) {
					     		    $(element).keyup(function(){
					     		    	if(!isNumeric(element.value)){
					     		    		element.value = selectNum(element.value, ",");
					     		    	}
					     		    });
					            }
					        }
						  },
					  {name:"rent_amt",	index:"rent_amt"	, sortable:false,formatter: "currency", hidden:true, formatoptions: {
						  	thousandsSeparator:",",
						    decimalPlaces:0,
						    defaultValue:""
						  },		width:100,	align:"right",	editable:true,	frozen : false,
							editoptions: {maxlength:"10",
					            dataInit: function(element) {
					     		    $(element).keyup(function(){
					     		    	if(!isNumeric(element.value)){
					     		    		element.value = selectNum(element.value, ",");
					     		    	}
					     		    });
					            }
					        }
						  },
					  {name:"vs_ptt_exp",	index:"vs_ptt_exp"	, sortable:false,formatter: "currency", formatoptions: {
						  thousandsSeparator:",",
						    decimalPlaces:0,
						    defaultValue:""
						  },		width:152,	align:"right",	editable:true,	frozen : false,
							editoptions: {maxlength:"10",
					            dataInit: function(element) {
					     		    $(element).keyup(function(){
					     		    	if(!isNumeric(element.value)){
					     		    		element.value = selectNum(element.value, ",");
					     		    	}
					     		    });
					            }
					        }
						  },
					  {name:"etc_amt",	index:"etc_amt"	, sortable:false,formatter: "currency", formatoptions: {
						  thousandsSeparator:",",
						    decimalPlaces:0,
						    defaultValue:""
						  },		width:152,	align:"right",	editable:true,	frozen : false,
							editoptions: {maxlength:"10",
					            dataInit: function(element) {
					     		    $(element).keyup(function(){
					     		    	if(!isNumeric(element.value)){
					     		    		element.value = selectNum(element.value, ",");
					     		    	}
					     		    });
					            }
					        }
						  },
					{name:"pgs_st_nm",		index:"pgs_st_nm"	, sortable:false,	formatter:"string",		width:150,	align:"center",	editable:false,	frozen : false, hidden:true},
					{name:"cost_info",		index:"cost_info"	, sortable:false,	formatter:"string",		width:0,	align:"center",	editable:false,	frozen : false, hidden:true},
					{name:"pass_country",	index:"pass_country", sortable:false,	formatter:"string",		width:60,	align:"center",	editable:true,	frozen : false, hidden:true},
					{name:"pass_number",	index:"pass_number"	, sortable:false,	formatter:"string",		width:60,	align:"center",	editable:true,	frozen : false, hidden:true},
					{name:"birth_ymd",		index:"birth_ymd"	, sortable:false,	formatter:"string",		width:60,	align:"center",	editable:true,	frozen : false, hidden:true,
						editoptions: {
							readonly : true,
				            dataInit: function(element) {
				     		    $(element).datepicker({
				     		    	dateFormat: 'yy-mm-dd',
				     		    	onSelect: function(dataText, inst){
				     		    	}
						    	});
				            }
						}
					},
					{name:"issue_ymd",		index:"issue_ymd"	, sortable:false,	formatter:"string",		width:60,	align:"center",	editable:true,	frozen : false, hidden:true, hidden:true,
						editoptions: {
							readonly : true,
				            dataInit: function(element) {
				     		    $(element).datepicker({
				     		    	dateFormat: 'yy-mm-dd',
				     		    	onSelect: function(dataText, inst){
				     		    	}
						    	});
				            }
						}
					},
					{name:"expire_ymd",		index:"expire_ymd"	, sortable:false,	formatter:"string",		width:60,	align:"center",	editable:true,	frozen : false, hidden:true,
						editoptions: {
							readonly : true,
				            dataInit: function(element) {
				     		    $(element).datepicker({
				     		    	dateFormat: 'yy-mm-dd',
				     		    	onSelect: function(dataText, inst){
				     		    	}
						    	});
				            }
						}
					}
				];

			gridParam = {
				viewEdit : [{
					gridName     : gridName1,
					url          : url,
					colNames     : cn,
					colModel     : cm,
					height       : "100%",
					sortname     : "eeno",
					sortorder    : "asc",
					rownumbers   : true,
					multiselect  : false,
					cellEdit     : true,
					fnMerge      : false,
					completeFc   : "addGridRow(3, '"+gridName1+"', 'datarow');setTravelerList();initAfterMenus();",
					paramJson    : ""
				}]
			};

			commonJqGridInit(gridParam);

			$("#"+gridName1).setColProp('eeno', {editoptions:{dataEvents:[{type:'keyup',
				fn:function(e){
// 					if(!isNumeric($(e.target).val())){
// 						$(e.target).val(selectNum($(e.target).val()));
// 					}

					var row = $(e.target).closest('tr.jqgrow');
					var rowId = row.attr('id');
					if(getColValue("doc_no", rowId, gridName1) != ""){
						return;
					}
					searchToUserInfo(rowId, 'eeno');
				}
				}]
			}});

			$("#"+gridName3).GridUnload();
// 			flight_cn = ["", "", "일시","항공노선","항공번호","출발지","도착지","출발시간","도착시간","Seat","금액"];
			var flight_cn = ['' // ""
					          ,'' // ""
					          ,'<fmt:message key="date_time"/>' // "일시"
					          ,'<fmt:message key="air_rt"/>' // "항공노선"
					          ,'<fmt:message key="air_no"/>' // "항공번호"
					          ,'<fmt:message key="dept"/>' // "출발지"
					          ,'<fmt:message key="dest"/>' // "도착지"
					          ,'<fmt:message key="dept_time"/>' // "출발시간"
					          ,'<fmt:message key="dest_time"/>' // "도착시간"
					          ,'' // "Seat"
					          ,'<fmt:message key="rt_amt"/>' // "금액"
		          ];
			flight_cm = [
					{name:"flt_doc_no"			, index:"flt_doc_no"		, sortable:false,	formatter:"string",		width:0,	align:"left",	editable:true,	frozen : false, hidden : true},
					{name:"flt_seq"				, index:"flt_seq"			, sortable:false,	formatter:"string",		width:0,	align:"left",	editable:true,	frozen : false, hidden : true},
					{name:"flt_flt_ymd"			, index:"flt_flt_ymd"		, sortable:false,	formatter:"string",		width:80,	align:"center",	editable:true,	frozen : false, key : false,
						editoptions: {
							readonly : true,
				            dataInit : function(element) {
				     		    $(element).datepicker({
				     		    	dateFormat: 'yy-mm-dd',
				     		    	onSelect: function(dataText, inst){
				     		    	}
						    	});
				            }
						}
					},
					{name:"flt_air_lines"		, index:"flt_air_lines"		, sortable:false,	formatter:"string",		width:225,	align:"left",	editable:true,	frozen : false},
					{name:"flt_flight"			, index:"flt_flight"		, sortable:false,	formatter:"string",		width:140,	align:"left",	editable:true,	frozen : false},
					{name:"flt_flt_from"		, index:"flt_flt_from"		, sortable:false,	formatter:"string",		width:140,	align:"left",	editable:true,	frozen : false},
					{name:"flt_flt_to"			, index:"flt_flt_to"		, sortable:false,	formatter:"string",		width:140,	align:"left",	editable:true,	frozen : false},
					{name:"flt_departure_time"	, index:"flt_departure_time", sortable:false,	formatter:"string",		width:80,	align:"left",	editable:true,	frozen : false,
						editoptions: {maxlength:"4",
				            dataInit: function(element) {
				     		    $(element).keyup(function(){

				     		    	if(!isNumeric(element.value)){
				     		    		element.value = selectNum(element.value);
				     		    	}

				     		    	if(trimChar(element.value, ":").length == 4){
				     		    		if(element.value.length > 4){
				     		    			element.value = "";
				     		    		}else{
				     		    			element.value = element.value.substring(0, 2)+":"+element.value.substring(2, 4);
				     		    		}
				     				}else{
				     					element.value = trimChar(element.value, ":");
				     				}
				     		    });
				            }
				        }
					},
					{name:"flt_arrive_time"		, index:"flt_arrive_time"	, sortable:false,	formatter:"string",		width:80,	align:"left",	editable:true,	frozen : false,
						editoptions: {maxlength:"4",
				            dataInit: function(element) {
				     		    $(element).keyup(function(){

				     		    	if(!isNumeric(element.value)){
				     		    		element.value = selectNum(element.value);
				     		    	}

				     		    	if(trimChar(element.value, ":").length == 4){
				     		    		if(element.value.length > 4){
				     		    			element.value = "";
				     		    		}else{
				     		    			element.value = element.value.substring(0, 2)+":"+element.value.substring(2, 4);
				     		    		}
				     				}else{
				     					element.value = trimChar(element.value, ":");
				     				}
				     		    });
				            }
				        }
					},
					{name:"flt_seat"			, index:"flt_seat"			, sortable:false,	formatter:"string",		width:90,	align:"left",	editable:true,	frozen : false, hidden:true},
					{name:"flt_etc_amt"			, index:"flt_etc_amt"		,formatter: "currency", formatoptions: {
						thousandsSeparator:",",
					    decimalPlaces:0,
					    defaultValue:""
					  },		width:80,	align:"right",	editable:true,	frozen : false,
						editoptions: {maxlength:"10",
				            dataInit: function(element) {
				     		    $(element).keyup(function(){
				     		    	if(!isNumeric(element.value)){
				     		    		element.value = selectNum(element.value, ",");
				     		    	}
				     		    });
				            }
				        }
					}
				];

			flight_gridParam = {
				viewEdit : [{
					gridName     : gridName3,
					url          : url,
					colNames     : flight_cn,
					colModel     : flight_cm,
					height       : "100%",
					sortname     : "seq",
					sortorder    : "asc",
					rownumbers   : true,
					multiselect  : false,
					cellEdit     : true,
					fnMerge      : false,
					completeFc   : "addGridRow(4, '"+gridName3+"', 'flight_datarow');initAfterMenus();",
					paramJson    : ""
				}]
			};

			commonJqGridInit(flight_gridParam);

			$("#"+gridName4).GridUnload();
// 			hotel_cn = ["", "", "체크인","체크아웃","숙박","주소","연락처","지불양식","확인","아침식사","금액"];
			var hotel_cn = [ '' // ""
					          ,'' // ""
					          ,'<fmt:message key="chk_in"/>' // "체크인"
					          ,'<fmt:message key="chk_out"/>' // "체크아웃"
					          ,'<fmt:message key="sty"/>' // "숙박"
					          ,'<fmt:message key="addr"/>' // "주소"
					          ,'<fmt:message key="tel_no"/>' // "연락처"
					          ,'<fmt:message key="pay_form"/>' // "지불양식"
					          ,'' // "확인"
					          ,'<fmt:message key="meal_yn"/>' // "아침식사"
					          ,'<fmt:message key="rt_amt"/>' // "금액"
		          ];
			hotel_cm = [
					{name:"htl_doc_no"			, index:"htl_doc_no"		, sortable:false,	formatter:"string",		width:0,	align:"left",	editable:true,	frozen : false, hidden : true},
					{name:"htl_seq"				, index:"htl_seq"			, sortable:false,	formatter:"string",		width:0,	align:"left",	editable:true,	frozen : false, hidden : true},
					{name:"htl_check_in_ymd"	, index:"htl_check_in_ymd"	, sortable:false,	formatter:"string",		width:80,	align:"center",	editable:true,	frozen : false,
						editoptions: {
							readonly : true,
				            dataInit: function(element) {
				     		    $(element).datepicker({
				     		    	dateFormat: 'yy-mm-dd',
				     		    	onSelect: function(dataText, inst){
				     		    	}
						    	});
				            }
						}
					},
					{name:"htl_check_out_ymd"	, index:"htl_check_out_ymd"	, sortable:false,	formatter:"string",		width:80,	align:"center",	editable:true,	frozen : false,
						editoptions: {
							readonly : true,
				            dataInit: function(element) {
				     		    $(element).datepicker({
				     		    	dateFormat: 'yy-mm-dd',
				     		    	onSelect: function(dataText, inst){
				     		    	}
						    	});
				            }
						}
					},
					{name:"htl_hotel_name"		, index:"htl_hotel_name"	, sortable:false,	formatter:"string",		width:140,	align:"left",	editable:true,	frozen : false},
					{name:"htl_hotel_addr"		, index:"htl_hotel_addr"	, sortable:false,	formatter:"string",		width:230,	align:"left",	editable:true,	frozen : false},
					{name:"htl_hotel_phone"		, index:"htl_hotel_phone"	, sortable:false,	formatter:"string",		width:125,	align:"left",	editable:true,	frozen : false},
					{name:"htl_pay_form",index:"htl_pay_form", formatter:"select", width:125, align:"center", editable:true, sortable:true, edittype:"select", fixed: true,
						editoptions:{value:getComboValue('htl_pay_form'),
							dataInit: function(elem) {
								$(elem).width(110);
							}
						}
					},
					{name:"htl_confirmation"	, index:"htl_confirmation"	, sortable:false,	formatter:"string",		width:110,	align:"left",	editable:true,	frozen : false, hidden:true},
					{name:"htl_meal_yn"			, index:"htl_meal_yn"		, sortable:false,	formatter:"select",		width:105, 	align:"center",	editable:true, 	edittype:'select',
						editoptions:{value:"Y:Y;N:N"
					    	,dataInit: function(elem) {
				        	$(elem).width(60);
				    		}
						}
					},
					{name:"htl_etc_amt"			, index:"htl_etc_amt"		, formatter: "currency", formatoptions: {
					    thousandsSeparator:",",
					    decimalPlaces:0,
					    defaultValue:""
					  },		width:80,	align:"right",	editable:true,	frozen : false,
						editoptions: {maxlength:"10",
				            dataInit: function(element) {
				     		    $(element).keyup(function(){
				     		    	if(!isNumeric(element.value)){
				     		    		element.value = selectNum(element.value, ",");
				     		    	}
				     		    });
				            }
				        }
					}
				];


			hotel_gridParam = {
				viewEdit : [{
					gridName     : gridName4,
					url          : url,
					colNames     : hotel_cn,
					colModel     : hotel_cm,
					height       : "100%",
					sortname     : "seq",
					sortorder    : "asc",
					rownumbers   : true,
					multiselect  : false,
					cellEdit     : true,
					fnMerge      : false,
					completeFc   : "addGridRow(1, '"+gridName4+"', 'hotel_datarow');initAfterMenus();",
					paramJson    : ""
				}]
			};

			commonJqGridInit(hotel_gridParam);

			$("#"+gridName5).GridUnload();
// 			rent_cn = ["", "", "체크인","체크아웃","회사","구분","연락처","지불양식","비고","엔진","금액"];
			var rent_cn = [ '' // ""
					          ,'' // ""
					          ,'<fmt:message key="rent_ymd"/>' // "체크인"
					          ,'<fmt:message key="return_ymd"/>' // "체크아웃"
					          ,'<fmt:message key="comp"/>' // "회사"
					          ,'<fmt:message key="car_type"/>' // "차종"
					          ,'<fmt:message key="car_nm"/>' // "차량명"
					          ,'<fmt:message key="tel_no"/>' // "연락처"
					          ,'<fmt:message key="pay_form"/>' // "지불양식"
					          ,'<fmt:message key="rem_sbc"/>' // "비고"
					          ,'<fmt:message key="rt_amt"/>' // "금액"
		          ];
			rent_cm = [
					{name:"rent_doc_no"			, index:"rent_doc_no"		, sortable:false,	formatter:"string",		width:0,	align:"left",	editable:true,	frozen : false, hidden : true},
					{name:"rent_seq"			, index:"rent_seq"			, sortable:false,	formatter:"string",		width:0,	align:"left",	editable:true,	frozen : false, hidden : true},
					{name:"rent_check_in_ymd"	, index:"rent_check_in_ymd"	, sortable:false,	formatter:"string",		width:80,	align:"center",	editable:true,	frozen : false,
						editoptions: {
							readonly : true,
				            dataInit: function(element) {
				     		    $(element).datepicker({
				     		    	dateFormat: 'yy-mm-dd',
				     		    	onSelect: function(dataText, inst){
				     		    	}
						    	});
				            }
						}
					},
					{name:"rent_check_out_ymd"	, index:"rent_check_out_ymd", sortable:false,	formatter:"string",		width:80,	align:"center",	editable:true,	frozen : false,
						editoptions: {
							readonly : true,
				            dataInit: function(element) {
				     		    $(element).datepicker({
				     		    	dateFormat: 'yy-mm-dd',
				     		    	onSelect: function(dataText, inst){
				     		    	}
						    	});
				            }
						}
					},
					{name:"rent_car_company"	, index:"rent_car_company"	, sortable:false,	formatter:"string",		width:155,	align:"left",	editable:true,	frozen : false},
					{name:"rent_air_yn"			, index:"rent_air_yn"		, sortable:false,	formatter:"select",		width:60, 	align:"center",	editable:true, 	edittype:'select',
						editoptions:{value:getComboValue('rent_air_yn'),
							dataInit: function(elem) {
								$(elem).width(60);
							}
						}
					},
					{name:"rent_car_type"		, index:"rent_car_type"		, sortable:false,	formatter:"string",		width:110,	align:"left",	editable:true,	frozen : false},
					{name:"rent_car_phone"		, index:"rent_car_phone"	, sortable:false,	formatter:"string",		width:120,	align:"left",	editable:true,	frozen : false},
					{name:"rent_pay_form"		, index:"rent_pay_form"		, sortable:false,	formatter:"string",		width:100,	align:"left",	editable:true,	frozen : false, hidden:true},
					{name:"rent_confirmation"	, index:"rent_confirmation"	, sortable:false,	formatter:"string",		width:280,	align:"left",	editable:true,	frozen : false},
					{name:"rent_etc_amt"		, index:"rent_etc_amt"		, formatter: 'currency', formatoptions: {
					    thousandsSeparator:",",
					    decimalPlaces:0,
					    defaultValue:""
					  },		width:80,	align:"right",	editable:true,	frozen : false,
						editoptions: {maxlength:"10",
				            dataInit: function(element) {
				     		    $(element).keyup(function(){
				     		    	if(!isNumeric(element.value)){
				     		    		element.value = selectNum(element.value, ",");
				     		    	}
				     		    });
				            }
				        }
					}
				];

			rent_gridParam = {
				viewEdit : [{
					gridName     : gridName5,
					url          : url,
					colNames     : rent_cn,
					colModel     : rent_cm,
					height       : "100%",
					sortname     : "eeno",
					sortorder    : "asc",
					rownumbers   : true,
					multiselect  : false,
					cellEdit     : true,
					fnMerge      : false,
					completeFc   : "addGridRow(1, '"+gridName5+"', 'rent_datarow');initAfterMenus();",
					paramJson    : ""
				}]
			};

			commonJqGridInit(rent_gridParam);

			setGridColumnOptions();

			jQuery("#"+gridName1).jqGrid('setLabel', 'vs_ptt_exp', '<td align="center" width="150" style="font-weight:bold"><fmt:message key="cost"/></td>');
			jQuery("#"+gridName1).jqGrid('setLabel', 'etc_amt', '<td align="center" width="150" style="font-weight:bold"><fmt:message key="comp_cd"/></td>');

			jQuery("#"+gridName1).jqGrid('setGroupHeaders', {
				useColSpanStyle: true,
				groupHeaders:[
					{startColumnName: 'flht_utz_amt', numberOfColumns: 5, titleText: '<fmt:message key="rt_amt"/>'}
				]
			});

			$("#strt_ymd").datepicker({ dateFormat: 'yy-mm-dd' });
			$("#fnh_ymd").datepicker({ dateFormat: 'yy-mm-dd' });

			fnChkApplyReqsObjects();

			if($("#hid_doc_no").val() != ""){
				$("#doc_no").val($("#hid_doc_no").val());
				$("#eeno").val($("#hid_eeno").val());
				doSearch1("Y");
			}else{
				row_no1 = 3;
				row_no2 = 4;
				row_no3 = 1;
				row_no4 = 1;
			}
		}

		function searchToUserInfo(rowId, colNm){
// 			if(getColValue(colNm, rowId).length != 8 ){
// 				jQuery("#"+gridName1).setCell(rowId, 'ee_nm',  ' ');
// 				jQuery("#"+gridName1).setCell(rowId, 'ops_nm', ' ');
// 				jQuery("#"+gridName1).setCell(rowId, 'ops_cd', ' ');
// 				jQuery("#"+gridName1).setCell(rowId, 'poa_nm', ' ');
// 				return;
// 			}

			var keyData = {
					xusr_empno : getColValue(colNm, rowId, gridName1),
					corp_cd	   : sess_corp_cd
					};
			paramData = {
				paramJson      	: util.jsonToString(keyData)
			};

			doCommonAjax("/hncis/system/doSearchToUserManagementByUserDetail.do", paramData, "userInfoCallBack(jsonData.sendResult, "+rowId+");");
		}

		function userInfoCallBack(result, rowId){
			if(typeof(result.xusr_name) == "undefined"){
				jQuery("#"+gridName1).setCell(rowId, 'ee_nm',  ' ');
				jQuery("#"+gridName1).setCell(rowId, 'ops_nm', ' ');
				jQuery("#"+gridName1).setCell(rowId, 'ops_cd', ' ');
				jQuery("#"+gridName1).setCell(rowId, 'poa_nm', ' ');
			}else{
				setUserInfo(result, 'Y', rowId, gridName1);
			}
			setRowEditMode(gridName1, rowId);
		}

		function retrieve(gubun){
			switch(gubun){
				case "search" :
					doSearch1("Y");
					break;
				case "save" :
				case "edit" :
				case "delete" :
					if(!processValidation(gubun))return;
					doCudAction(gubun);
					break;
				case "request" :
					if($("#process_yn").val() != "N"){return;}
				case "requestCancel" :
					if(!processValidation(gubun))return;
					doApprove(gubun);
					break;
				case "reject" :
					if(!processValidation(gubun))return;
					doReject();
					break;
				case "afterCal" :
					if(!processValidation(gubun))return;
					doAfterCal();
					break;
				case "confirm" :
					if(!processValidation(gubun))return;
					doConfirm();
					break;
				case "confirm3" :
					if(!processValidation(gubun))return;
					doConfirm3();
					break;
				case "confirmCancel" :
					if(!processValidation(gubun))return;
					doConfirmCancel();
					break;
				case "forceConfirm" :
					doForceConfirm();
					break;
				case "print" :
					doPrint();
					break;
				case "cancel" :
					if(!processValidation(gubun))return;
					doCancel(gubun);
					break;
				case "back" :
				    doBack();
				    break;
				case "new" :
				    doNew();
				    break;
			}
		}

		function setTravelerList(){
			if($("#hid_doc_no").val() == ""){
				var reqTravelInfo = {
					eeno : $("#eeno").val(),
					ee_nm     : $("#ee_nm").val(),
					ops_nm    : $("#ops_nm").val(),
					ops_cd    : $("#ops_cd").val(),
					poa_nm    : $("#poa_nm").val(),
					visa_yn   : "N",
					cost_cd   : $("#cost_cd").val(),
					corp_cd	  : sess_corp_cd
				};

				jQuery("#"+gridName1).jqGrid("setRowData", 1, reqTravelInfo);
			}
		}

		var win;
		function doPayReportOpen(eeno, pgs_st_cd){
			if(win != null){ win.close(); }
			var url = "xbt01_report.gas", width = "1000", height = "650";

			$("#hid_report_doc_no").val($("#hid_doc_no").val());
			$("#hid_report_eeno").val(eeno);
			$("#hid_report_pgs_st_cd").val($("#pgs_st_cd").val());

			win = newPopWin("about:blank", width, height, "win_report");
			document.reportForm.hid_csrfToken.value = $("#csrfToken").val();
			document.reportForm.action = url;
			document.reportForm.target = "win_report";
			document.reportForm.method = "post";
			document.reportForm.submit();
		}

		var win_standard;
		function doStandardExpenseOpen(){
			if(win_standard != null){ win_standard.close(); }
			var url = "xbt01_standard.gas", width = "1030", height = "623";

			win_standard = newPopWin("about:blank", width, height, "win_standard");
			document.reportForm.hid_csrfToken.value = $("#csrfToken").val();
			document.reportForm.action = url;
			document.reportForm.target = "win_standard";
			document.reportForm.method = "post";
			document.reportForm.submit();
		}


		var saveCode = "";
		function cearInsa(){
			if($("#eeno").val() == ""){
				saveCode = "";
				$("#nSource").val("");
				$("#eeno").val("");
				$("#ee_nm").val("");
				$("#ops_nm").val("");
				$("#ops_cd").val("");
				$("#poa_nm").val("");
				$("#tel_no").val("");
				$("#keyOpsCd").val("");
				$("#keyOpsNm").val("");
			}
		}

		function setInsaInfo(){
			if($("#eeno").val() != ""){
				$("#nSource").val($("#eeno").val());
				if(saveCode == $("#nSource").val()){ return; }
				saveCode = $("#nSource").val();

				var keyData = {
						xusr_empno : $("#eeno").val(),
						corp_cd    : sess_corp_cd
				};
				paramData = {
					paramJson : util.jsonToString(keyData)
				};
				doCommonAjax("/doSearchToUserInfo.do", paramData, "insaCallBack(jsonData.sendResult)");
			}
		}

		function doSearch1(msgFlag){
			var params = {
				doc_no : $("#doc_no").val(),
				corp_cd	: sess_corp_cd,
				locale  : sess_locale
			};

			var paramData = {
				paramJson : util.jsonToString(params)
			};

			msgFlag = typeof(msgFlag) == "undefined" ? "Y" : msgFlag;
			doCommonAjax("doSearchInfoBTToRequest.do", paramData,"loadCallBack1(jsonData.sendResult, '"+msgFlag+"');");
		}

		function doSearch2(){
			var params = {
				doc_no : $("#doc_no").val(),
				h_gubn : "H",
				corp_cd	: sess_corp_cd,
				locale  : sess_locale
			};

			doCommonSearch("doSearchListBTToRequestByTraveler.do", util.jsonToString(params), "loadCallBack2();", gridName1, "N");
		}

		function doSearch4(){
			var params = {
				doc_no : $("#doc_no").val(),
				corp_cd	: sess_corp_cd
			};

			doCommonSearch("doSearchListBTToRequestByFilghtConfirmation.do", util.jsonToString(params), "loadCallBack4();", gridName3, "N");
		}

		function doSearch5(){
			var params = {
				doc_no : $("#doc_no").val(),
				corp_cd	: sess_corp_cd
			};

			doCommonSearch("doSearchListBTToRequestByHotelConfirmation.do", util.jsonToString(params), "loadCallBack5();", gridName4, "N");
		}

		function doSearch6(){
			var params = {
				doc_no : $("#doc_no").val(),
				corp_cd	: sess_corp_cd
			};

			doCommonSearch("doSearchListBTToRequestByRentCar.do", util.jsonToString(params), "loadCallBack6();", gridName5, "N");
		}

		function doCudAction(gubun) {
			var url = "", callBack = "", doc_no = "", basic_mode = "";
			if(gubun == "save"){
				url = "doSaveBTToRequest.do";
				callBack = "saveCallBack(jsonData.sendResult);";
				if($("#doc_no").val() == ""){
					$("#hid_doc_no").val($("#temp_doc_no").val());
					basic_mode = "I";
				}else{
					basic_mode = "U";
				}
			}else if(gubun == "delete"){
				url = "doDeleteBTToRequest.do";
				callBack = "deleteCallBack(jsonData.sendResult);";
			}else{
			}

			doc_no = $("#hid_doc_no").val();
			if(!processFlag(gubun)) return;
			if(!validation()) return;

			var bsicInfo = {
				doc_no			: doc_no,
				basic_mode		: basic_mode,
				eeno			: $("#eeno").val(),
				pgs_st_cd		: $("#pgs_st_cd").val() == "" ? "0" : $("#pgs_st_cd").val(),
				ptt_ymd			: trimChar($("#ptt_ymd").val(), "-"),
				dom_abrd_scn_cd	: $("#dom_abrd_scn_cd").val(),
				nat_g_scn_cd	: $("#nat_g_scn_cd_temp").val(),
				dest_nat_cd		: $("#dest_nat_cd_temp").val(),
				dest_dtl_sbc	: changeToUni($("#dest_dtl_sbc").val()),
				snb_rson_sbc	: changeToUni($("#snb_rson_sbc").val()),
				vsit_purp_sbc	: changeToUni($("#vsit_purp_sbc").val()),
				strt_ymd		: trimChar($("#strt_ymd").val(), "-"),
				fnh_ymd			: trimChar($("#fnh_ymd").val(), "-"),
				prct_sbc		: overLineHtml(changeToUni($("#prct_sbc").val())),
				ipe_eeno         : sess_empno,
				updr_eeno        : sess_empno,
				corp_cd			: sess_corp_cd
			};

			var travelerInfoU = [];
			var travelerInfoI = [];
			var ids = jQuery("#"+gridName1).getDataIDs();

			for(var i = 0; i < ids.length; i++){
				rowId = ids[i];
				if(rowId){
					if(getColValue("eeno", rowId, gridName1) != "" && getColValue("ee_nm", rowId, gridName1) != ""){
						if(getColValue("seq", rowId, gridName1) != ""){
							data = {
								doc_no			: doc_no,
								eeno			: getColValue("eeno", rowId, gridName1),
								seq				: rowId,
								visa_yn			: getColValue("visa_yn", rowId, gridName1) == "" ? 'N' : getColValue("visa_yn", rowId, gridName1),
								cost_cd     	: getColValue("cost_cd", rowId, gridName1),
								flht_utz_amt    : getColValue("flht_utz_amt", rowId, gridName1) == "" ? '0' : getColValue("flht_utz_amt", rowId, gridName1).replace(",", "."),
								bztp_lodg_exp   : getColValue("bztp_lodg_exp", rowId, gridName1) == "" ? '0' : getColValue("bztp_lodg_exp", rowId, gridName1).replace(",", "."),
								rent_amt    	: getColValue("rent_amt", rowId, gridName1) == "" ? '0' : getColValue("rent_amt", rowId, gridName1).replace(",", "."),
								vs_ptt_exp    	: getColValue("vs_ptt_exp", rowId, gridName1) == "" ? '0' : getColValue("vs_ptt_exp", rowId, gridName1).replace(",", "."),
								etc_amt			: getColValue("etc_amt", rowId, gridName1) == "" ? '0' : getColValue("etc_amt", rowId, gridName1).replace(",", "."),
								pass_country	: getColValue("pass_country", rowId, gridName1),
								pass_number		: getColValue("pass_number", rowId, gridName1),
								birth_ymd		: trimChar(getColValue("birth_ymd", rowId, gridName1), "-"),
								issue_ymd		: trimChar(getColValue("issue_ymd", rowId, gridName1), "-"),
								expire_ymd		: trimChar(getColValue("expire_ymd", rowId, gridName1), "-"),
								ipe_eeno		: sess_empno,
								updr_eeno		: sess_empno,
								h_gubn			: "H",
								eenm			: getColValue("ee_nm", rowId, gridName1),
								dept_nm			: getColValue("ops_nm", rowId, gridName1),
								position		: getColValue("poa_nm", rowId, gridName1),
								corp_cd			: sess_corp_cd
							};
							travelerInfoU.push(data);
						}else{
							data = {
								doc_no			: doc_no,
								eeno			: getColValue("eeno", rowId, gridName1),
								seq				: rowId,
								visa_yn			: getColValue("visa_yn", rowId, gridName1) == "" ? 'N' : getColValue("visa_yn", rowId, gridName1),
								cost_cd     	: getColValue("cost_cd", rowId, gridName1),
								flht_utz_amt    : getColValue("flht_utz_amt", rowId, gridName1) == "" ? '0' : getColValue("flht_utz_amt", rowId, gridName1).replace(",", "."),
								bztp_lodg_exp   : getColValue("bztp_lodg_exp", rowId, gridName1) == "" ? '0' : getColValue("bztp_lodg_exp", rowId, gridName1).replace(",", "."),
								rent_amt    	: getColValue("rent_amt", rowId, gridName1) == "" ? '0' : getColValue("rent_amt", rowId, gridName1).replace(",", "."),
								vs_ptt_exp    	: getColValue("vs_ptt_exp", rowId, gridName1) == "" ? '0' : getColValue("vs_ptt_exp", rowId, gridName1).replace(",", "."),
								etc_amt			: getColValue("etc_amt", rowId, gridName1) == "" ? '0' : getColValue("etc_amt", rowId, gridName1).replace(",", "."),
								pass_country	: getColValue("pass_country", rowId, gridName1),
								pass_number		: getColValue("pass_number", rowId, gridName1),
								birth_ymd		: trimChar(getColValue("birth_ymd", rowId, gridName1), "-"),
								issue_ymd		: trimChar(getColValue("issue_ymd", rowId, gridName1), "-"),
								expire_ymd		: trimChar(getColValue("expire_ymd", rowId, gridName1), "-"),
								pgs_st_cd		: '0',
								ipe_eeno		: sess_empno,
								updr_eeno		: sess_empno,
								h_gubn			: "H",
								eenm			: getColValue("ee_nm", rowId, gridName1),
								dept_nm			: getColValue("ops_nm", rowId, gridName1),
								position		: getColValue("poa_nm", rowId, gridName1),
								corp_cd			: sess_corp_cd
							};

							travelerInfoI.push(data);
						}
					}
				}
			}

			var flightInfoU = [];
			var flightInfoI = [];
			var flight_ids = jQuery("#"+gridName3).getDataIDs();

			for(var i = 0; i < flight_ids.length; i++){
				rowId = flight_ids[i];
				if(rowId){
					if(getColValue("flt_flt_ymd", rowId, gridName3) != "" && getColValue("flt_air_lines", rowId, gridName3) != ""){
						if(selectNum(getColValue("flt_departure_time", rowId, gridName3)) >= selectNum(getColValue("flt_arrive_time", rowId, gridName3))){
							alertUI('<fmt:message key="MSG.ETC.0002"/>');
							return;
						}
						if(getColValue("flt_seq", rowId, gridName3) != ""){
							data = {
								doc_no			: doc_no,
								seq				: getColValue("flt_seq", rowId, gridName3),
								flt_ymd         : trimChar(getColValue("flt_flt_ymd", rowId, gridName3), "-"),
								air_lines       : getColValue("flt_air_lines", rowId, gridName3),
								flight          : getColValue("flt_flight", rowId, gridName3),
								flt_from        : getColValue("flt_flt_from", rowId, gridName3),
								flt_to          : getColValue("flt_flt_to", rowId, gridName3),
								departure_time  : getColValue("flt_departure_time", rowId, gridName3),
								arrive_time     : getColValue("flt_arrive_time", rowId, gridName3),
								seat            : getColValue("flt_seat", rowId, gridName3),
								etc_amt         : getColValue("flt_etc_amt", rowId, gridName3) == "" ? '0' : getColValue("flt_etc_amt", rowId, gridName3).replace(",", "."),
								ipe_eeno		: sess_empno,
								updr_eeno		: sess_empno,
								corp_cd			: sess_corp_cd
							};
							flightInfoU.push(data);
						}else{
							data = {
								doc_no			: doc_no,
								flt_ymd         : trimChar(getColValue("flt_flt_ymd", rowId, gridName3), "-"),
								air_lines       : getColValue("flt_air_lines", rowId, gridName3),
								flight          : getColValue("flt_flight", rowId, gridName3),
								flt_from        : getColValue("flt_flt_from", rowId, gridName3),
								flt_to          : getColValue("flt_flt_to", rowId, gridName3),
								departure_time  : getColValue("flt_departure_time", rowId, gridName3),
								arrive_time     : getColValue("flt_arrive_time", rowId, gridName3),
								seat            : getColValue("flt_seat", rowId, gridName3),
								etc_amt         : getColValue("flt_etc_amt", rowId, gridName3) == "" ? '0' : getColValue("flt_etc_amt", rowId, gridName3).replace(",", "."),
								ipe_eeno		: sess_empno,
								updr_eeno		: sess_empno,
								corp_cd			: sess_corp_cd
							};
							flightInfoI.push(data);
						}
					}
				}
			}

			var hotelInfoU = [];
			var hotelInfoI = [];
			var hotel_ids = jQuery("#"+gridName4).getDataIDs();

			for(var i = 0; i < hotel_ids.length; i++){
				rowId = hotel_ids[i];
				if(rowId){
					if(getColValue("htl_check_in_ymd", rowId, gridName4) != "" && getColValue("htl_check_out_ymd", rowId, gridName4) != ""){
						if(getColValue("htl_seq", rowId, gridName4) != ""){
							data = {
								doc_no			: doc_no,
								seq				: getColValue("htl_seq", rowId, gridName4),
								check_in_ymd    : trimChar(getColValue("htl_check_in_ymd", rowId, gridName4), "-"),
								check_out_ymd   : trimChar(getColValue("htl_check_out_ymd", rowId, gridName4), "-"),
								hotel_name      : getColValue("htl_hotel_name", rowId, gridName4),
								hotel_addr      : getColValue("htl_hotel_addr", rowId, gridName4),
								hotel_phone     : getColValue("htl_hotel_phone", rowId, gridName4),
								pay_form        : getColValue("htl_pay_form", rowId, gridName4),
								confirmation    : getColValue("htl_confirmation", rowId, gridName4),
								meal_yn         : getColValue("htl_meal_yn", rowId, gridName4),
								etc_amt         : getColValue("htl_etc_amt", rowId, gridName4) == "" ? '0' : getColValue("htl_etc_amt", rowId, gridName4).replace(",", "."),
								ipe_eeno		: sess_empno,
								updr_eeno		: sess_empno,
								corp_cd			: sess_corp_cd
							};
							hotelInfoU.push(data);
						}else{
							data = {
								doc_no			: doc_no,
								check_in_ymd    : trimChar(getColValue("htl_check_in_ymd", rowId, gridName4), "-"),
								check_out_ymd   : trimChar(getColValue("htl_check_out_ymd", rowId, gridName4), "-"),
								hotel_name      : getColValue("htl_hotel_name", rowId, gridName4),
								hotel_addr      : getColValue("htl_hotel_addr", rowId, gridName4),
								hotel_phone     : getColValue("htl_hotel_phone", rowId, gridName4),
								pay_form        : getColValue("htl_pay_form", rowId, gridName4),
								confirmation    : getColValue("htl_confirmation", rowId, gridName4),
								meal_yn         : getColValue("htl_meal_yn", rowId, gridName4),
								etc_amt         : getColValue("htl_etc_amt", rowId, gridName4) == "" ? '0' : getColValue("htl_etc_amt", rowId, gridName4).replace(",", "."),
								ipe_eeno		: sess_empno,
								updr_eeno		: sess_empno,
								corp_cd			: sess_corp_cd
							};
							hotelInfoI.push(data);
						}
					}
				}
			}

			var rentInfoU = [];
			var rentInfoI = [];
			var rent_ids = jQuery("#"+gridName5).getDataIDs();

			for(var i = 0; i < rent_ids.length; i++){
				rowId = rent_ids[i];
				if(rowId){
					if(getColValue("rent_check_in_ymd", rowId, gridName5) != "" && getColValue("rent_check_out_ymd", rowId, gridName5) != ""){
						if(getColValue("rent_seq", rowId, gridName5) != ""){
							data = {
								doc_no			: doc_no,
								seq				: getColValue("rent_seq", rowId, gridName5),
								check_in_ymd    : trimChar(getColValue("rent_check_in_ymd", rowId, gridName5), "-"),
								check_out_ymd   : trimChar(getColValue("rent_check_out_ymd", rowId, gridName5), "-"),
								car_company     : getColValue("rent_car_company", rowId, gridName5),
								car_type        : getColValue("rent_car_type", rowId, gridName5),
								car_phone       : getColValue("rent_car_phone", rowId, gridName5),
								pay_form        : getColValue("rent_pay_form", rowId, gridName5),
								confirmation    : getColValue("rent_confirmation", rowId, gridName5),
								air_yn          : getColValue("rent_air_yn", rowId, gridName5),
								etc_amt         : getColValue("rent_etc_amt", rowId, gridName5) == "" ? '0' : getColValue("rent_etc_amt", rowId, gridName5).replace(",", "."),
								ipe_eeno		: sess_empno,
								updr_eeno		: sess_empno,
								corp_cd			: sess_corp_cd
							};
							rentInfoU.push(data);
						}else{
							data = {
								doc_no			: doc_no,
								check_in_ymd    : trimChar(getColValue("rent_check_in_ymd", rowId, gridName5), "-"),
								check_out_ymd   : trimChar(getColValue("rent_check_out_ymd", rowId, gridName5), "-"),
								car_company     : getColValue("rent_car_company", rowId, gridName5),
								car_type        : getColValue("rent_car_type", rowId, gridName5),
								car_phone       : getColValue("rent_car_phone", rowId, gridName5),
								pay_form        : getColValue("rent_pay_form", rowId, gridName5),
								confirmation    : getColValue("rent_confirmation", rowId, gridName5),
								air_yn          : getColValue("rent_air_yn", rowId, gridName5),
								etc_amt         : getColValue("rent_etc_amt", rowId, gridName5) == "" ? '0' : getColValue("rent_etc_amt", rowId, gridName5).replace(",", "."),
								ipe_eeno		: sess_empno,
								updr_eeno		: sess_empno,
								corp_cd			: sess_corp_cd
							};
							rentInfoI.push(data);
						}
					}
				}
			}

			var travelerVtInfoU = [];
			var travelerVtInfoI = [];

			var confirmStr = '';
			if(gubun == "save"){
				confirmStr = '<fmt:message key="MSG.CNF.0004"/>';
			}else if(gubun == "delete"){
				confirmStr = '<fmt:message key="MSG.CNF.0002"/>';
			}

			$("#doc_no").val($("#hid_doc_no").val());

			confirmUI(confirmStr);
			$("#pop_yes").click(function(){
				$.unblockUI({
					onUnblock: function(){
						var paramData = {
								bsicInfo 		: util.jsonToString(bsicInfo),
								travelerInfoI	: util.jsonToList(travelerInfoI),
								travelerInfoU	: util.jsonToList(travelerInfoU),
								flightInfoI     : util.jsonToList(flightInfoI),
								flightInfoU	    : util.jsonToList(flightInfoU),
								hotelInfoI	    : util.jsonToList(hotelInfoI),
								hotelInfoU	    : util.jsonToList(hotelInfoU),
								rentInfoI	    : util.jsonToList(rentInfoI),
								rentInfoU	    : util.jsonToList(rentInfoU),
								travelerVtInfoI	: util.jsonToList(travelerVtInfoI),
								travelerVtInfoU	: util.jsonToList(travelerVtInfoU)
						};
						doCommonAjax(url, paramData, callBack);
					}
				});
			});
		}

		function doApprove(gubun){
			var url = "", callBack = "", pgs_st_cd = "";
			if(gubun == "request"){
				url = "doApproveBTToRequest.do";
				callBack = "approveCallBack('"+gubun+"', jsonData.sendResult);";
				pgs_st_cd = "A";
			}else if(gubun == "requestCancel"){
				url = "doApproveCancelBTToRequest.do";
				callBack = "approveCallBack('"+gubun+"', jsonData.sendResult);";
			}

			var bsicInfo;
			if(gubun == "request"){
				bsicInfo = {
					doc_no    		: $("#doc_no").val(),
					pgs_st_cd 		: pgs_st_cd,
					dom_abrd_scn_cd	: $("#dom_abrd_scn_cd").val(),
					app_type        : "BT",
					eeno 			: $("#eeno").val(),
					updr_eeno 		: sess_empno,
					corp_cd			: sess_corp_cd
				};
			}else{
				bsicInfo = {
					if_id     : $("#if_id").val(),
					doc_no	  : $("#doc_no").val(),
					updr_eeno : sess_empno,
					corp_cd	  : sess_corp_cd
				};
			}

			if(!processFlag(gubun)) return;

			if($("#ipe_eeno").val() != sess_empno && !(sess_mstu == "M" || sess_auth > 4)){
				alertUI('<fmt:message key="MSG.STAT.0039"/>');
				return;
			}

			var confirmStr = '';
			if(gubun == "request"){
				confirmStr = '<fmt:message key="MSG.CNF.0005"/>';
			}else if(gubun == "requestCancel"){
				confirmStr = '<fmt:message key="MSG.CNF.0006"/>';
			}

			$("#process_yn").val("Y");

			fnStartLoading();

			confirmUI(confirmStr);
			$("#pop_yes").click(function(){
				$.unblockUI({
					onUnblock: function(){
						var paramData = {
								bsicInfo : util.jsonToString(bsicInfo)
							};
						doCommonAjax(url, paramData, callBack);
					}
				});
			});
			$("#pop_no").click(function(){
				$.unblockUI({
					onUnblock: function(){
						$("#process_yn").val("N");
					}
				});
			});
		}

		function doReject(){

			if($("#snb_rson_sbc").val() == ""){
				alertUI('<fmt:message key="MSG.INP.0011"/>');
				$("#snb_rson_sbc").focus();
				return;
			}

			var keyData = {
				doc_no			 : $("#doc_no").val(),
				eeno			 : $("#eeno").val(),
				pgs_st_cd		 : '2',
				snb_rson_sbc  	 : changeToUni($("#snb_rson_sbc").val()),
				updr_eeno		 : sess_empno,
				locale 			 : sess_locale,
				corp_cd			 : sess_corp_cd
			};

			fnStartLoading();

			confirmUI('<fmt:message key="MSG.CNF.0010"/>');
			$("#pop_yes").click(function(){
				$.unblockUI({
					onUnblock: function(){
						var paramData = {
								bsicInfo : util.jsonToString(keyData)
							};
						doCommonAjax("doRejectBTToRequest.do", paramData, "confirmCallBack(jsonData.sendResult);");
					}
				});
			});
		}

		function doConfirm(){

			var temp_pgs_st_cd = "3";

			var bsicInfo = {
				mode      		: "confirm",
				doc_no    		: $("#doc_no").val(),
				eeno      		: $("#eeno").val(),
				pgs_st_cd 		: temp_pgs_st_cd,
				acpc_pgs_st_cd 	: temp_pgs_st_cd,
				updr_eeno 		: sess_empno,
				corp_cd			: sess_corp_cd
			};

			if(!processFlag("confirm")) return;

			fnStartLoading();

			confirmUI('<fmt:message key="MSG.CNF.0040"/>');
			$("#pop_yes").click(function(){
				$.unblockUI({
					onUnblock: function(){
						var paramData = {
								bsicInfo : util.jsonToString(bsicInfo)
							};
							doCommonAjax("doConfirmBTToRequest.do", paramData, "confirmCallBack(jsonData.sendResult);");
					}
				});
			});
		}

		function doConfirm3(){

			var temp_pgs_st_cd = "C";

			var bsicInfo = {
				mode      		: "confirm3",
				doc_no    		: $("#doc_no").val(),
				eeno      		: $("#eeno").val(),
				pgs_st_cd 		: temp_pgs_st_cd,
				acpc_pgs_st_cd 	: temp_pgs_st_cd,
				updr_eeno 		: sess_empno,
				corp_cd			: sess_corp_cd
			};

			if(!processFlag("confirm")) return;

			fnStartLoading();

			confirmUI('<fmt:message key="MSG.CNF.0039"/>');
			$("#pop_yes").click(function(){
				$.unblockUI({
					onUnblock: function(){
						var paramData = {
								bsicInfo : util.jsonToString(bsicInfo)
							};
							doCommonAjax("doConfirm3BTToRequest.do", paramData, "confirmCallBack(jsonData.sendResult);");
					}
				});
			});
		}

		function doAfterCal(){

			var temp_pgs_st_cd = "D";

			var bsicInfo = {
				mode      		: "afterCal",
				doc_no    		: $("#doc_no").val(),
				eeno      		: $("#eeno").val(),
				pgs_st_cd 		: temp_pgs_st_cd,
				acpc_pgs_st_cd 	: temp_pgs_st_cd,
				updr_eeno 		: sess_empno,
				corp_cd			: sess_corp_cd
			};

			if(!processFlag("confirm")) return;

			fnStartLoading();

			confirmUI('<fmt:message key="MSG.CNF.0041"/>');
			$("#pop_yes").click(function(){
				$.unblockUI({
					onUnblock: function(){
						var paramData = {
								bsicInfo : util.jsonToString(bsicInfo)
							};
							doCommonAjax("doAfterCalBTToRequest.do", paramData, "confirmCallBack(jsonData.sendResult);");
					}
				});
			});
		}

		function doForceConfirm(){
			var bsicInfo = {
				mode      : "forceConfirm",
				doc_no    : $("#doc_no").val(),
				eeno      : $("#eeno").val(),
				if_id     : $("#if_id").val(),
				pgs_st_cd : "3",
				updr_eeno : sess_empno,
				corp_cd	  : sess_corp_cd
			};

			if($("#pgs_st_cd").val() == "C"){
				alertUI('<fmt:message key="MSG.STAT.0010"/>');
				return;
			}

			if(!processFlag("forceConfirm")) return;

			confirmUI('<fmt:message key="MSG.CNF.0009"/>');
			$("#pop_yes").click(function(){
				$.unblockUI({
					onUnblock: function(){
						var paramData = {
								bsicInfo : util.jsonToString(bsicInfo)
						};
						doCommonAjax("doForceConfirmBTToRequest.do", paramData, "confirmCallBack(jsonData.sendResult);");
					}
				});
			});
		}

		function doConfirmCancel(){

			if($("#rem").val() == ""){
				alertUI('<fmt:message key="MSG.INP.0012"/>');
				return;
			}

			var bsicInfo = {
				mode      		: "confirmCancel",
				doc_no    		: $("#doc_no").val(),
				eeno      		: $("#eeno").val(),
				snb_rson_sbc  	: $("#snb_rson_sbc").val(),
				pgs_st_cd 		: "0",
				updr_eeno 		: sess_empno,
				corp_cd			: sess_corp_cd
			};

			if(!processFlag("confirmCancel")) return;

			fnStartLoading();

			confirmUI('<fmt:message key="MSG.CNF.0008"/>');
			$("#pop_yes").click(function(){
				$.unblockUI({
					onUnblock: function(){
						var paramData = {
								bsicInfo : util.jsonToString(bsicInfo)
							};
							doCommonAjax("doConfirmBTToRequest.do", paramData, "confirmCallBack(jsonData.sendResult);");
					}
				});
			});
		}

		function insaCallBack(result){
// 			$("#eeno").val(result.xusr_empno);
			$("#ee_nm").val(result.xusr_name);
			$("#poa_nm").val(result.xusr_step_name);
			$("#ops_nm").val(result.xusr_dept_name);
			$("#ops_cd").val(result.xusr_dept_code);
			$("#keyOpsCd").val(result.xusr_dept_nm_cd);
			$("#keyOpsNm").val(result.xusr_dept_nm_dept);
			$("#cost_cd").val(result.xusr_cost_cd);
			$("#tel_no").val(result.xusr_tel_no);

			setTravelerList();
			setComboInfo();
		}

		function loadCallBack1(result, msgFlag){
			loadJsonSet(result);
			if(msgFlag == "Y") setBottomMsg(result.message, false);

			if($("#pgs_st_cd").val() == "Z" || $("#pgs_st_cd").val() == "3" || $("#pgs_st_cd").val() == "A" || $("#pgs_st_cd").val() == "C"){
				if(Number(sess_auth) > 4 || sess_mstu == "M"){
					readOnlyStyle("snb_rson_sbc", 2);
				}else{
					readOnlyStyle("snb_rson_sbc", 1);
				}
			}else{
				readOnlyStyle("snb_rson_sbc", 1);
			}

			changeAbrd($("#dom_abrd_scn_cd").val());
			$("#nat_g_scn_cd_temp").val(trimChar($("#nat_g_scn_cd").val()));

			changeCountryGroup($("#nat_g_scn_cd_temp").val());
			$("#dest_nat_cd_temp").val(trimChar($("#dest_nat_cd").val()));

			fnSubmitInfoSettings($("#pgs_st_cd").val(), $("#if_id").val(), result.code, "snb_rson_sbc", $("#approveStepLevel").val());

			$("#cost_cd").val(result.cost_cd);

			fnChkApplyReqsObjects();

			doSearch2();
		}

		function loadCallBack2(){
			addGridRow(3, gridName1, 'datarow');
			initAfterMenus();
			row_no1 = jQuery("#"+gridName1).getDataIDs().length;
			doSearch4();
		}

		function loadCallBack4(){
			addGridRow(4, gridName3, 'flight_datarow');
			initAfterMenus();
			row_no2 = jQuery("#"+gridName3).getDataIDs().length;
			doSearch5();
		}

		function loadCallBack5(){
			addGridRow(1, gridName4, 'hotel_datarow');
			initAfterMenus();
			row_no3 = jQuery("#"+gridName4).getDataIDs().length;
			doSearch6();
		}

		function loadCallBack6(){
			addGridRow(1, gridName5, 'rent_datarow');
			initAfterMenus();
			row_no4 = jQuery("#"+gridName5).getDataIDs().length;
		}

		function saveCallBack(result){
			setBottomMsg(result.message, true);
			$("#doc_no").val($("#hid_doc_no").val());
			doSearch1("N");
		}

		function deleteCallBack(result){
			mainForm.reset();
			setBottomMsg(result.message, true);
			$("#eeno").val(sess_empno);
			saveCode="";
			$("#hid_doc_no").val("");
			$("#hid_eeno").val("");
			$("#temp_doc_no").val(result.code);

			$("#"+gridName1).trigger("reloadGrid");

			setInsaInfo();
			setTimeout("addRow()" , 100);
		}

		function approveCallBack(gubun, result){
			fnEndLoading();
			$("#process_yn").val("N");
			setBottomMsg(result.message, true);
			$("#pgs_st_cd").val(result.code);
			doSearch1("N");
		}

		function rejectCallBack(result){
			fnEndLoading();
			setBottomMsg(result.message, true);
			$("#pgs_st_cd").val(result.code);
			doSearch1("N");
		}

		function confirmCallBack(result){
			fnEndLoading();
			setBottomMsg(result.message, true);
			$("#pgs_st_cd").val(result.code);
			doSearch1("N");
		}

		function cancelCallBack(gubun, result){
			fnEndLoading();
			$("#process_yn").val("N");
			setBottomMsg(result.message, true);
			$("#pgs_st_cd").val(result.code);
			doSearch1("N");
		}

		function addRow(){
			row_no1 = row_no1 + 1;
			jQuery("#"+gridName1).jqGrid("addRowData", row_no1, datarow);
		}

		function addFlightRow(){
			row_no2 = row_no2 + 1;
			jQuery("#"+gridName3).jqGrid("addRowData", row_no2, flight_datarow);
		}

		function addHotelRow(){
			row_no3 = row_no3 + 1;
			jQuery("#"+gridName4).jqGrid("addRowData", row_no3, hotel_datarow);
		}

		function addRentRow(){
			row_no4 = row_no4 + 1;
			jQuery("#"+gridName5).jqGrid("addRowData", row_no4, rent_datarow);
		}

		function setDateGap(){
			var fdate = trimChar($("#strt_ymd").val(), "-");
			var tdate = trimChar($("#fnh_ymd").val(), "-");

			iGap = getDateGap(fdate, tdate);
		}

		function getDateGap(str1, str2){
			var iGap = 0;
			if(str1.length == 8 && str2.length == 8){
				sYear     = str1.substr(0, 4);
				sMonth    = eval(str1.substr(4, 2));
				sDay      = eval(str1.substr(6, 2));

				eYear     = str2.substr(0, 4);
				eMonth    = eval(str2.substr(4, 2));
				eDay      = eval(str2.substr(6, 2));

				dteStart  = new Date(sYear, sMonth-1, sDay);
				dteEnd    = new Date(eYear, eMonth-1, eDay);

				iDteStart = dteStart.getTime();
				iDteEnd   = dteEnd.getTime();
				iGap      = iDteEnd - iDteStart;
			}

			return (iGap/86400000);
		}

		function chk_auth(){
			var frm = document.mainForm;

			with(frm){
				if(Number(sess_auth) > 4 || sess_mstu == "M"){
					if($("#hid_doc_no").val() != ""){
						readOnlyStyle("eeno", 1);
					}else{
						readOnlyStyle("eeno", 2);
					}

				}else{
					readOnlyStyle("eeno", 1);
				}
				readOnlyStyle("ee_nm", 1);
				readOnlyStyle("poa_nm", 1);
				readOnlyStyle("ops_nm", 1);
				readOnlyStyle("ptt_ymd", 1);
				readOnlyStyle("doc_no", 1);
				readOnlyStyle("pgs_st_nm", 1);
				readOnlyStyle("snb_rson_sbc", 1);
				readOnlyStyle("tel_no", 1);
			}
		}

		function processFlag(gubun){
			if(gubun != "save"){
				if($("#doc_no").val() == ""){
					alertUI('<fmt:message key="MSG.STAT.0047"/>');
					return;
				}
			}
			return true;
		}

		function validation(){

			if($("#eeno").val() == ""){
				alertUI('<fmt:message key="MSG.INP.0010"/>');
				$("#eeno").focus();
				return false;
			}
			if($("#nat_g_scn_cd_temp").val() == ""){
				alertUI('<fmt:message key="MSG.SEL.0015"/>');
				$("#nat_g_scn_cd_temp").focus();
				return false;
			}
			if($("#dest_nat_cd_temp").val() == ""){
				alertUI('<fmt:message key="MSG.SEL.0016"/>');
				$("#dest_nat_cd_temp").focus();
				return false;
			}
			if($("#dest_dtl_sbc").val() == ""){
				alertUI('<fmt:message key="MSG.INP.0013"/>');
				$("#dest_dtl_sbc").focus();
				return false;
			}
			if(trimChar($("#vsit_purp_sbc").val()) == ""){
				alertUI('<fmt:message key="MSG.INP.0014"/>');
				$("#vsit_purp_sbc").focus();
				return false;
			}

			if(trimChar($("#strt_ymd").val()) == ""){
				alertUI('<fmt:message key="MSG.INP.0020"/>', '', '$("#strt_ymd").focus();');
				return false;
			}

			if(trimChar($("#fnh_ymd").val()) == ""){
				alertUI('<fmt:message key="MSG.INP.0021"/>', '' , '$("#fnh_ymd").focus();');
				return false;
			}

			return true;
		}


		function processValidation(gubun){
			var pgs_st_cd = $("#pgs_st_cd").val();
			var cancel_yn = $("#cancel_yn").val();
			var acpc_pgs_st_cd = $("#acpc_pgs_st_cd").val();
			var flag      = false;

			var isAdmin = sess_mstu == "M" || sess_auth >= 5;
			var isWriter = $("#ipe_eeno").val() == sess_empno;

			if(pgs_st_cd == '' && gubun != 'save'){
				alertUI('<fmt:message key="MSG.STAT.0047"/>');
				return false;
			}

			if(gubun == "save"){						//저장
				if(isAdmin){
					flag = true;
				} else {
					if(pgs_st_cd == ''){
						flag = true;
					} else if(pgs_st_cd == '0' || pgs_st_cd == 'C'){
						if(isWriter){
							flag = true;
						} else {
							alertUI('<fmt:message key="MSG.STAT.0039"/>');	//신청자만이 요청할 수 있습니다.
						}
					} else {
						alertUI('<fmt:message key="MSG.STAT.0002"/>');	//저장할 수 없는 상태입니다.
					}
				}
			} else if(gubun == "delete"){				//삭제
				if(isAdmin){
					flag = true;
				} else {
					if(pgs_st_cd == '0'){
						if(isWriter){
							flag = true;
						} else {
							alertUI('<fmt:message key="MSG.STAT.0039"/>');	//신청자만이 요청할 수 있습니다.
						}
					} else {
						alertUI('<fmt:message key="MSG.STAT.0003"/>');		//삭제할 수 없는 상태입니다.
					}

				}
			} else if(gubun == "travelerDelete"){				//삭제
				if(isAdmin){
					flag = true;
				} else {
					if(pgs_st_cd == '0'){
						if(isWriter){
							flag = true;
						} else {
							alertUI('<fmt:message key="MSG.STAT.0039"/>');	//신청자만이 요청할 수 있습니다.
						}
					} else {
						alertUI('<fmt:message key="MSG.STAT.0003"/>');		//삭제할 수 없는 상태입니다.
					}

				}
			} else if(gubun == "request"){				//신청
				if(pgs_st_cd == '0'){
					if(isAdmin){
						flag = true;
					} else {
						if(isWriter){
							flag = true;
						} else {
							alertUI('<fmt:message key="MSG.STAT.0039"/>');	//신청자만이 요청할 수 있습니다.
						}
					}
				} else {
					alertUI('<fmt:message key="MSG.STAT.0005"/>');		//신청할 수 없는 상태입니다.
				}
			} else if(gubun == "requestCancel"){		//신청취소
				if(pgs_st_cd == 'A'){
					if(isAdmin){
						flag = true;
					} else {
						if(isWriter){
							flag = true;
						} else {
							alertUI('<fmt:message key="MSG.STAT.0039"/>');	//신청자만이 요청할 수 있습니다.
						}
					}
				} else {
					if( $("#apprLev1").val() == "" ){
						if($("#pgs_st_cd").val() == 'Z'){
							flag = true;
						}else{
							alertUI('<fmt:message key="MSG.STAT.0006"/>');
						}
					}else{
						alertUI('<fmt:message key="MSG.STAT.0006"/>');		//신청취소할 수 없는 상태입니다.
					}
				}
			} else if(gubun == "confirm3"){				//1차확정
				if(pgs_st_cd == 'Z'){
					if(isAdmin){
						flag = true;
					} else {
						alertUI('<fmt:message key="MSG.STAT.0038"/>');	//권한이 없습니다.
					}
				} else {
					alertUI('<fmt:message key="MSG.STAT.0043"/>');		//1차정산 할 수 없는 상태입니다.
				}
			} else if(gubun == "afterCal"){				//후정산
				if(pgs_st_cd == 'C'){
					if(isAdmin){
						flag = true;
					} else {
						if(isWriter){
							flag = true;
						} else {
							alertUI('<fmt:message key="MSG.STAT.0039"/>');	//신청자만이 요청할 수 있습니다.
						}
					}
				} else {
					alertUI('<fmt:message key="MSG.STAT.0045"/>');		//후정산 할 수 없는 상태입니다.
				}
			} else if(gubun == "confirm"){				//2차확정
				if(pgs_st_cd == 'D'){
					if(isAdmin){
						flag = true;
					} else {
						alertUI('<fmt:message key="MSG.STAT.0038"/>');	//권한이 없습니다.
					}
				} else {
					alertUI('<fmt:message key="MSG.STAT.0044"/>');		//2차정산 할 수 없는 상태입니다.
				}
			} else if(gubun == "reject"){				//반려
				if(pgs_st_cd == 'Z'){
					if(isAdmin){
						flag = true;
					} else {
						alertUI('<fmt:message key="MSG.STAT.0038"/>');	//권한이 없습니다.
					}
				} else {
					alertUI('<fmt:message key="MSG.STAT.0011"/>');		//반려할 수 없는 상태입니다.
				}
			} else if(gubun == "print"){				//인쇄
				if(isAdmin){
					flag = true;
				} else {
					if(isWriter){
						flag = true;
					} else {
						alertUI('<fmt:message key="MSG.STAT.0038"/>');		//권한이 없습니다.
					}
				}
			}

			return flag;
		}

		function travelerDelete(){
			var rowId = jQuery("#"+gridName1).jqGrid("getGridParam", "selrow");

			if($("#pgs_st_cd").val() != '0' && $("#pgs_st_cd").val() != ''){
				alertUI('<fmt:message key="MSG.STAT.0003"/>');
				return;
			}
			
			if(rowId == "" || rowId == null){
				alertUI('<fmt:message key="MSG.CNF.0025"/>');
				return;
			}
			
			var travelerInfo = {
				doc_no    	: getColValue("doc_no",     rowId, gridName1),
				eeno    	: getColValue("eeno",     rowId, gridName1),
				corp_cd		: sess_corp_cd
			};

			confirmUI('<fmt:message key="MSG.CNF.0025"/>');
			$("#pop_yes").click(function(){
				$.unblockUI({
					onUnblock: function(){
						if(travelerInfo.length > 0){
							var paramData = {
									travelerInfo : util.jsonToString(travelerInfo)
							};
							doCommonAjax("doDeleteTravelerToRequest.do", paramData, "setBottomMsg(jsonData.sendResult.message, true);travelerDeleteCallBack();");
						}else{
							travelerDeleteCallBack();
						}
					}
				});
			});
		}
		
		function travelerDeleteCallBack(){
			var rowId = jQuery("#"+gridName1).jqGrid("getGridParam", "selrow");
			$("#"+gridName1).delRowData(rowId);
			if(jQuery("#"+gridName1).getDataIDs().length < 3){
				addRow();
			}
		}

		function flightDelete(){
			var rowId = jQuery("#"+gridName3).jqGrid("getGridParam", "selrow");

			if($("#pgs_st_cd").val() != '0' && $("#pgs_st_cd").val() != ''){
				alertUI('<fmt:message key="MSG.STAT.0003"/>');
				return;
			}
			
			if(rowId == "" || rowId == null){
				alertUI('<fmt:message key="MSG.CNF.0025"/>');
				return;
			}

			var flightInfo = {
				doc_no : getColValue("flt_doc_no", rowId, gridName3),
				seq    : getColValue("flt_seq"   , rowId, gridName3),
				corp_cd	: sess_corp_cd
			};

			confirmUI('<fmt:message key="MSG.CNF.0021"/>');
			$("#pop_yes").click(function(){
				$.unblockUI({
					onUnblock: function(){
						if(flightInfo.length > 0){
							var paramData = {
									dParams : util.jsonToString(flightInfo)
							};
							doCommonAjax("doDeleteFlightConfirmationToRequest.do", paramData, "setBottomMsg(jsonData.sendResult.message, true);flightDeleteCallBack();");
						}else{
							flightDeleteCallBack();
						}
					}
				});
			});
		}

		function flightDeleteCallBack(){
			var rowId = jQuery("#"+gridName3).jqGrid("getGridParam", "selrow");
			$("#"+gridName3).delRowData(rowId);
			if(jQuery("#"+gridName3).getDataIDs().length < 4){
				addFlightRow();
			}
		}

		function hotelDelete(){
			var rowId = jQuery("#"+gridName4).jqGrid("getGridParam", "selrow");

			if($("#pgs_st_cd").val() != '0' && $("#pgs_st_cd").val() != ''){
				alertUI('<fmt:message key="MSG.STAT.0003"/>');
				return;
			}
			
			if(rowId == "" || rowId == null){
				alertUI('<fmt:message key="MSG.CNF.0025"/>');
				return;
			}

			var hotelInfo = {
				doc_no : getColValue("htl_doc_no", rowId, gridName4),
				seq    : getColValue("htl_seq"   , rowId, gridName4),
				corp_cd	: sess_corp_cd
			};

			confirmUI('<fmt:message key="MSG.CNF.0022"/>');
			$("#pop_yes").click(function(){
				$.unblockUI({
					onUnblock: function(){
						if(hotelInfo.length > 0){
							var paramData = {
								dParams : util.jsonToString(hotelInfo)
							};
							doCommonAjax("doDeleteHotelConfirmationToRequest.do", paramData, "setBottomMsg(jsonData.sendResult.message, true);hotelDeleteCallBack();");
						}else{
							hotelDeleteCallBack();
						}
					}
				});
			});
		}
		
		function hotelDeleteCallBack(){
			var rowId = jQuery("#"+gridName4).jqGrid("getGridParam", "selrow");
			$("#"+gridName4).delRowData(rowId);
			if(jQuery("#"+gridName4).getDataIDs().length < 1){
				addHotelRow();
			}
		}

		function rentDelete(){
			var rowId = jQuery("#"+gridName5).jqGrid("getGridParam", "selrow");

			if($("#pgs_st_cd").val() != '0' && $("#pgs_st_cd").val() != ''){
				alertUI('<fmt:message key="MSG.STAT.0003"/>');
				return;
			}
			
			if(rowId == "" || rowId == null){
				alertUI('<fmt:message key="MSG.CNF.0025"/>');
				return;
			}

			var rentInfo = {
				doc_no : getColValue("rent_doc_no", rowId, gridName5),
				seq    : getColValue("rent_seq"   , rowId, gridName5),
				corp_cd	: sess_corp_cd
			};

			confirmUI('<fmt:message key="MSG.CNF.0023"/>');
			$("#pop_yes").click(function(){
				$.unblockUI({
					onUnblock: function(){
						if(rentInfo.length > 0){
							var paramData = {
									rentInfo : util.jsonToString(rentInfo)
							};
							doCommonAjax("doDeleteRentCarToRequest.do", paramData, "setBottomMsg(jsonData.sendResult.message, true);rentDeleteCallBack();");
						}else{
							rentDeleteCallBack();
						}
					}
				});
			});
		}
		
		function rentDeleteCallBack(){
			var rowId = jQuery("#"+gridName5).jqGrid("getGridParam", "selrow");
			$("#"+gridName5).delRowData(rowId);
			if(jQuery("#"+gridName5).getDataIDs().length < 1){
				addRentRow();
			}
		}

		function doCancel(gubun){
			var url = "", callBack = "", pgs_st_cd = "";

			url = "doCancelBTToRequest.do";
			callBack = "cancelCallBack('"+gubun+"', jsonData.sendResult);";

			var bsicInfo = {
				if_id     : $("#if_id").val(),
				updr_eeno : sess_empno,
				pgs_st_cd : "C",
				ops_cd	  : $("#ops_cd").val(),
				eeno	  : $("#eeno").val(),
				poa_nm	  : $("#poa_nm").val(),
				ops_nm	  : $("#ops_nm").val(),
				corp_cd	  : sess_corp_cd
			};

			if(!processFlag(gubun)) return;

			$("#process_yn").val("Y");

			confirmUI('<fmt:message key="MSG.CNF.0011"/>');
			$("#pop_yes").click(function(){
				$.unblockUI({
					onUnblock: function(){
						var paramData = {
								bsicInfo : util.jsonToString(bsicInfo)
						};
						doCommonAjax(url, paramData, callBack);
					}
				});
			});
		}

		function setVehicleCkDisplay(value){
		}

		function changeAbrd(value, type){
			var comboVal2 = '';

			$.each(eval(comboVal),function(targetNm,optionData){
				if(targetNm == "nat_g_scn_cd_temp"){
					$.each(eval(optionData),function(index,optionData){
//						if(optionData.key == value){
							comboVal2 += '<option role="option" value="' +
							optionData.value + '" selected>' +
							optionData.name + '</option>';
//						}
					});
					$("select#nat_g_scn_cd_temp").html(comboVal2);
					if(value == 'PT002'){
						$("select#nat_g_scn_cd_temp").attr('disabled',true).val("ASA").trigger("change");
					}
				}
			});
		}

		function changeCountryGroup(value){
			getNatMultiComboValue('dest_nat_cd_temp', value);
		}

		function getNatMultiComboValue(comboName, keyName){
			var comboVal2='<option role="option" value=""><fmt:message key="select"/></option>';

			$.each(eval(comboVal_nat),function(targetNm,optionData){
				if(targetNm == comboName){
					$.each(eval(optionData),function(index,optionData){
						if(optionData.key == keyName){
							comboVal2 += '<option role="option" value="' +
				            optionData.value + '">' +
							optionData.name + '</option>';
						}
					});

					$("select#" + targetNm).html(comboVal2);
				}
		    });

			if($("#dom_abrd_scn_cd").val() == 'PT002'){
				$("select#" + comboName).attr('disabled',true).val('AS017');
			}
		}

		function doBudget(value){
			var url = "doBudgetInfoToRequest.do";

			var	budgetInfo = {
					if_id     : $("#if_id").val(),
					updr_eeno : sess_empno,
					pgs_st_cd : "C",
					ops_cd	  : $("#ops_cd").val(),
					eeno	  : $("#eeno").val(),
					poa_nm	  : $("#poa_nm").val(),
					ops_nm	  : $("#ops_nm").val(),
					corp_cd	  : sess_corp_cd
				};


			var paramData = {
				bsicInfo : util.jsonToString(bsicInfo)
			};
			doCommonAjax(url, paramData, "budgetCallBack(jsonData.sendResult);");
		}

		function budgetCallBack(result){
			alertUI(result.message);
		}

		var win;
		function doFileAttach(){
			if(win != null){ win.close(); }
			var url = "xbt01_file.gas", width = "460", height = "453";

			if($("#hid_doc_no").val() == ""){
				$("#file_doc_no").val($("#temp_doc_no").val());
			}else{
				$("#file_doc_no").val($("#hid_doc_no").val());
			}
			$("#file_eeno").val("00000000");

			win = newPopWin("about:blank", width, height, "win_file");
			document.fileForm.hid_csrfToken.value = $("#csrfToken").val();
			document.fileForm.action = url;
			document.fileForm.target = "win_file";
			document.fileForm.method = "post";
			document.fileForm.submit();
		}

		function doBack(){
		    var form = $("<form/>");
		    form.attr("method" , "post");
		    form.attr("id"     , "submitForm").attr("name", "submitForm");
		    form.attr("action" , $("#hid_view_nm").val() + ".gas");
		    var inp1 = $("<input type='hidden' id='hid_cond' name='hid_cond'/>").val($("#hid_cond").val());
		    var token = $("<input type='hidden' id='hid_csrfToken' name='hid_csrfToken'/>").val($("#csrfToken").val());
		    form.append(inp1, token);
		    $("body").append(form);
		    form.submit();
		    form.remove();
		}

		function changebudget(value){
			$("#budg_no").val("");
			$("#budg_ipt").val("");
			if(value == "D"){
				$("#budg_no").attr("style", "width:120px;");
				$("#budg_wbs").attr("style", "display:none;");
				$("#budg_ipt").attr("style", "display:none;");
			}else if(value == "I"){
				$("#budg_no").attr("style", "width:120px;");
				$("#budg_wbs").attr("style", "display:none;");
				$("#b_ipt").html("<input type='text' id='budg_ipt' style='width:120px;' maxLength='7' class='iptOnlyNumber'>");
				$(".iptOnlyNumber").numeric();
			}else if(value == "W"){
				$("#budg_no").attr("style", "display:none;");
				$("#budg_wbs").attr("style", "width:120px;");
				$("#b_ipt").html("<input type='text' id='budg_ipt' style='width:120px;' maxLength='10' onkeyup='CheckValue(this.value);'>");
			}else{
				$("#budg_no").attr("style", "display:none;");
				$("#budg_ipt").attr("style", "display:none;");
			}
		}

		function CheckValue(strValue) {
			var strReg = /^[A-Za-z0-9]+$/;
		}

		var win;
		function doFileAttachCmpx(type){
			if(win != null){ win.close(); }
			var url = "xbt01_file_cmpx.gas", width = "460", height = "453";

			if($("#hid_doc_no").val() == ""){
				$("#file_doc_no").val($("#temp_doc_no").val());
			}else{
				$("#file_doc_no").val($("#hid_doc_no").val());
			}
			$("#file_eeno").val("00000000");

			$("#file_doc_no").val(type+$("#file_doc_no").val());

			win = newPopWin("about:blank", width, height, "win_file");
			document.fileForm.hid_csrfToken.value = $("#csrfToken").val();
			document.fileForm.action = url;
			document.fileForm.target = "win_file";
			document.fileForm.method = "post";
			document.fileForm.submit();
		}

		function setFormClear(){

			$("#doc_no").val("");
			$("#hid_doc_no").val("");
			$("#temp_doc_no").val(getTmpDocNo());
			$("#req_date").val("");
			$("#pgs_st_cd").val("");
			$("#pgs_st_nm").val("");
			$("#if_id").val("");

			$("#nat_g_scn_cd_temp").val("");
			$("#dest_nat_cd_temp").val("");
			$("#dest_dtl_sbc").val("");
			$("#vsit_purp_sbc").val("");
			$("#strt_ymd").val("");
			$("#fnh_ymd").val("");
			$("#prct_sbc").val("");
			saveCode="";
		}

		function doNew(){
			setFormClear();
			displaySubmitClear(document);
			setInsaInfo();
		}

		var win1;
		function doConfirmation(type){
			if(win != null){ win.close(); }
			var url = "xbt_confirm_file.gas", width = "460", height = "453";

			if($("#hid_doc_no").val() == ""){
				$("#file_doc_no").val($("#temp_doc_no").val());
			}else{
				$("#file_doc_no").val($("#hid_doc_no").val());
			}

			$("#file_eeno").val("00000000");
			$("#req_eeno").val($("#eeno").val());
			$("#file_doc_no").val(type+$("#file_doc_no").val());

			win1 = newPopWin("about:blank", width, height, "win_file1");
			document.fileForm.hid_csrfToken.value = $("#csrfToken").val();
			document.fileForm.action = url;
			document.fileForm.target = "win_file1";
			document.fileForm.method = "post";
			document.fileForm.submit();
		}

		function doPrint(){
			$.printPreview.loadPrintPreview();
		}

		function pageStepHelpPopup(){
			if(popup != null ){
				popup.close();
			}

			popup = popUpWindow3($("#help_url").val());
		}
	</script>