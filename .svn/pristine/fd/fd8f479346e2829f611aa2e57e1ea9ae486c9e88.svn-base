<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE sqlMap      
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"      
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="Security">
		
	<insert id="insertSecurityRequestMaster" parameterClass="bgabGascse01">
		/* insertSecurityRequestMaster */
		insert into BGAB_GASCSE01$corp_cd$(
			 doc_no
			,eeno
			,apply_date
			,purpose
			,reason
			,remark
			,type
			,pgs_st_cd
			,if_id
			,inp_ymd
			,ipe_eeno
			,mdfy_ymd
			,updr_eeno
		)values(
			 #doc_no#
			,#eeno#
			,#apply_date#
			,#purpose#
			,#reason#
			,#remark#
			,#type#
			,#pgs_st_cd#
			,#if_id#
			,SYSDATE()
			,#ipe_eeno#
			,SYSDATE()
			,#updr_eeno#
		)
	</insert>

	<insert id="updateSecurityRequestMaster" parameterClass="bgabGascse01">
		/* updateSecurityRequestMaster */
		update BGAB_GASCSE01$corp_cd$
		   set purpose = #purpose#
		   	 , reason = #reason#
		   	 , remark = #remark#
			 , mdfy_ymd = DATE_FORMAT(SYSDATE(), '%Y%m%d')
			 , updr_eeno = #updr_eeno#
		 where eeno = #eeno#
		   and apply_date = #apply_date#
		   and type = #type#
		   and doc_no = #doc_no#
	</insert>
	
	<delete id="deleteSecurityRequestMaster" parameterClass="bgabGascse01">
		/* deleteSecurityRequestMaster */
		delete from BGAB_GASCSE01$corp_cd$
		 where eeno = #eeno#
		   and apply_date = #apply_date#
		   and type = #type#
		   and doc_no = #doc_no#
	</delete>
	
	<insert id="insertSecurityRequestVehicle" parameterClass="bgabGascse01">
		/* insertSecurityRequestVehicle */
		insert into BGAB_GASCSE02$corp_cd$(
			 seq
			,eeno
			,apply_date
			,doc_no
			,parking_area
			,corp_company
			,biz_number
			,activity
			,charge
			,phone
			,address
			,start_ymd
			,end_ymd
			,model
			,renavam
			,color
			,plate
			,driver_name
			,driver_lic
			,category
			,cnh_exp
			,inp_ymd
			,ipe_eeno
			,mdfy_ymd
			,updr_eeno
		)values(
			(select a.seq from (select IFNULL(max(seq),0 )+1 as seq from bgab_gascse02$corp_cd$ where eeno = #eeno# and apply_date = #apply_date#)a)
			,#eeno#
			,#apply_date#
			,#doc_no#
			,#parking_area#
			,#corp_company#
			,#biz_number#
			,#activity#
			,#charge#
			,#phone#
			,#address#
			,#start_ymd#
			,#end_ymd#
			,#model#
			,#renavam#
			,#color#
			,#plate#
			,#driver_name#
			,#driver_lic#
			,#category#
			,#cnh_exp#
			,SYSDATE()
			,#ipe_eeno#
			,SYSDATE()
			,#updr_eeno#
		)
	</insert>

	<update id="updateSecurityRequestVehicle" parameterClass="bgabGascse01">
		/* updateSecurityRequestVehicle */
		update BGAB_GASCSE02$corp_cd$
		   set parking_area = #parking_area#
			 , corp_company = #corp_company#
			 , biz_number = #biz_number#
			 , activity = #activity#
			 , charge = #charge#
			 , phone = #phone#
			 , address = #address#
			 , start_ymd = #start_ymd#
			 , end_ymd = #end_ymd#
			 , model = #model#
			 , renavam = #renavam#
			 , color = #color#
			 , plate = #plate#
			 , driver_name = #driver_name#
			 , driver_lic = #driver_lic#
			 , category = #category#
			 , cnh_exp = #cnh_exp#
			 , mdfy_ymd = DATE_FORMAT(SYSDATE(), '%Y%m%d')
			 , updr_eeno = #updr_eeno#
		 where seq = #seq#
		   and eeno = #eeno#
		   and apply_date = #apply_date#
		   and doc_no = #doc_no#
	</update>
	
	<delete id="deleteSecurityRequestVehicle" parameterClass="bgabGascse01">
		/* deleteSecurityRequestVehicle */
		delete from BGAB_GASCSE02$corp_cd$
		 where eeno = #eeno#
		   and apply_date = #apply_date#
		   and doc_no = #doc_no#
		   <isNotEmpty property="seq">
		   and seq = #seq#
		   </isNotEmpty>
	</delete>

	<select id="selectSecurityRequestVehicle" parameterClass="bgabGascse01" resultClass="bgabGascse01">
		/* selectSecurityRequestVehicle */
		SELECT b.seq
		     , b.eeno
		     , REPLACE(b.apply_date,'/','') AS apply_date
		     , a.purpose
		     , b.parking_area
		     , b.corp_company
		     , b.biz_number
		     , b.activity
		     , b.charge
		     , b.phone
		     , b.address
		     , b.start_ymd
		     , b.end_ymd
		     , b.renavam
		     , b.model
		     , b.color
		     , b.plate
		     , b.driver_name
		     , b.driver_lic
		     , b.category
		     , b.cnh_exp
		     , a.pgs_st_cd
		     , a.if_id
		     , pgcNm.xcod_hname AS pgs_st_nm
		     , a.snb_rson_sbc
		     , a.reason
		     , a.remark
		     , a.doc_no
		  FROM BGAB_GASCSE01$corp_cd$ a
		  JOIN BGAB_GASCSE02$corp_cd$ b
		    on a.eeno = b.eeno
		   and a.apply_date = b.apply_date
		   and a.doc_no = b.doc_no
		   LEFT OUTER JOIN
		       (SELECT xcod_code, 
		              xcod_hname 
		         FROM bgab_gascz005$corp_cd$
		        WHERE xcod_knd = 'X0030' 
		        AND   locale = #locale#
		       )pgcNm 
		       ON pgcNm.xcod_code = a.pgs_st_cd 
		 WHERE type = #type#
		   <isNotEmpty property="if_id">
		   	   and a.if_id = #if_id#
		   </isNotEmpty>
		   <isEmpty property="if_id">
			   and a.eeno = #eeno#
			   and a.apply_date = #apply_date#
			   and a.doc_no = #doc_no#
		   </isEmpty>
		 ORDER BY seq
	</select>
	
	<insert id="insertSecurityRequestMaterial" parameterClass="bgabGascse02">
		/* insertSecurityRequestMaterial */
		insert into BGAB_GASCSE03$corp_cd$(
			 seq
			,eeno
			,apply_date
			,doc_no
			,company
			,carrier
			,brand
			,description
			,asset_num
			,quantity
			,return_sel
			,day1
			,hour1
			,day2
			,hour2
			,inp_ymd
			,ipe_eeno
			,mdfy_ymd
			,updr_eeno
		)values(
			(select a.seq from (select IFNULL(max(seq),0 )+1 as seq from bgab_gascse03$corp_cd$ where eeno = #eeno# and apply_date = #apply_date#) a)
			,#eeno#
			,#apply_date#
			,#doc_no#
			,#company#
			,#carrier#
			,#brand#
			,#description#
			,#asset_num#
			,#quantity#
			,#return_sel#
			,#day1#
			,#hour1#
			,#day2#
			,#hour2#
			,DATE_FORMAT(SYSDATE(), '%Y%m%d') 
			,#ipe_eeno#
			,DATE_FORMAT(SYSDATE(), '%Y%m%d')
			,#updr_eeno#
		)
	</insert>

	<update id="updateSecurityRequestMaterial" parameterClass="bgabGascse02">
		/* updateSecurityRequestMaterial */
		update BGAB_GASCSE03$corp_cd$
		   set company = #company#
			 , carrier = #carrier#
			 , brand = #brand#
			 , description = #description#
			 , asset_num = #asset_num#
			 , quantity = #quantity#
			 , return_sel = #return_sel#
			 , day1 = #day1#
			 , hour1 = #hour1#
			 , day2 = #day2#
			 , hour2 = #hour2#
			 , mdfy_ymd = DATE_FORMAT(SYSDATE(), '%Y%m%d')
			 , updr_eeno = #updr_eeno#
		 where seq = #seq#
		   and eeno = #eeno#
		   and apply_date = #apply_date#
		   and doc_no = #doc_no#
	</update>
	
	<delete id="deleteSecurityRequestMaterial" parameterClass="bgabGascse02">
		/* deleteSecurityRequestMaterial */
		delete from BGAB_GASCSE03$corp_cd$
		 where eeno = #eeno#
		   and apply_date = #apply_date#
		   and doc_no = #doc_no#
		   <isNotEmpty property="seq">
		   and seq = #seq#
		   </isNotEmpty>
	</delete>

	<select id="selectSecurityRequestMaterial" parameterClass="bgabGascse02" resultClass="bgabGascse02">
		/* selectSecurityRequestMaterial */
		select b.seq
			 , a.eeno
			 , replace(a.apply_date,'/','') AS apply_date
			 , a.purpose
			 , b.company
			 , b.carrier
			 , b.brand
			 , b.description
			 , b.asset_num
			 , b.quantity
			 , b.return_sel
			 , b.day1
			 , b.hour1
			 , b.day2
			 , b.hour2
			 , a.pgs_st_cd
			 , a.if_id
			 , pgcNm.xcod_hname AS pgs_st_nm
			 , a.snb_rson_sbc
			 , a.reason
		     , a.remark
		     , a.doc_no
		  from BGAB_GASCSE01$corp_cd$ a
		  join BGAB_GASCSE03$corp_cd$ b
		    on a.eeno = b.eeno
		   and a.apply_date = b.apply_date
		   and a.doc_no = b.doc_no
		  left outer join(
                select xcod_code, xcod_hname
                  from bgab_gascz005$corp_cd$
                 where xcod_knd = 'X0030'
                   and locale = #locale#
                 )pgcNm
             on pgcNm.xcod_code = a.pgs_st_cd
		 where type = #type#
		   <isNotEmpty property="if_id">
		   	   and a.if_id = #if_id#
		   </isNotEmpty>
		   <isEmpty property="if_id">
		       and a.eeno = #eeno#
			   and a.apply_date = #apply_date#
			   and a.doc_no = #doc_no#
		   </isEmpty>
		  order by seq
	</select>
	
	<insert id="insertSecurityRequestDevices" parameterClass="bgabGascse03">
		/* insertSecurityRequestDevices */
		insert into BGAB_GASCSE04$corp_cd$(
			 seq
			,eeno
			,apply_date
			,doc_no
			,company
			,carrier
			,brand
			,model
			,serial
			,quantity
			,network
			,day1
			,hour1
			,day2
			,hour2
			,inp_ymd
			,ipe_eeno
			,mdfy_ymd
			,updr_eeno
		)values(
			(select a.seq from (select IFNULL(max(seq),0 )+1 as seq from bgab_gascse04$corp_cd$ where eeno = #eeno# and apply_date = #apply_date#) a)
			,#eeno#
			,#apply_date#
			,#doc_no#
			,#company#
			,#carrier#
			,#brand#
			,#model#
			,#serial#
			,#quantity#
			,#network#
			,#day1#
			,#hour1#
			,#day2#
			,#hour2#
			,DATE_FORMAT(SYSDATE(), '%Y%m%d') 
			,#ipe_eeno#
			,DATE_FORMAT(SYSDATE(), '%Y%m%d')
			,#updr_eeno#
		)
	</insert>

	<update id="updateSecurityRequestDevices" parameterClass="bgabGascse03">
		/* updateSecurityRequestDevices */
		update BGAB_GASCSE04$corp_cd$
		   set company = #company#
			 , carrier = #carrier#
			 , brand = #brand#
			 , model = #model#
			 , serial = #serial#
			 , quantity = #quantity#
			 , network = #network#
			 , day1 = #day1#
			 , hour1 = #hour1#
			 , day2 = #day2#
			 , hour2 = #hour2#
			 , mdfy_ymd = DATE_FORMAT(SYSDATE(), '%Y%m%d')
			 , updr_eeno = #updr_eeno#
		 where seq = #seq#
		   and eeno = #eeno#
		   and apply_date = #apply_date#
		   and doc_no = #doc_no#
	</update>
	
	<delete id="deleteSecurityRequestDevices" parameterClass="bgabGascse03">
		/* deleteSecurityRequestDevices */
		delete from BGAB_GASCSE04$corp_cd$
		 where eeno = #eeno#
		   and apply_date = #apply_date#
		   and doc_no = #doc_no#
		   <isNotEmpty property="seq">
		   and seq = #seq#
		   </isNotEmpty>
	</delete>

	<select id="selectSecurityRequestDevices" parameterClass="bgabGascse03" resultClass="bgabGascse03">
		/* selectSecurityRequestDevices */
		select b.seq
			 , a.eeno
			 , REPLACE(a.apply_date,'/','') AS apply_date
			 , a.purpose
			 , b.company
			 , b.carrier
			 , b.brand
			 , b.model
			 , b.serial
			 , b.quantity
			 , b.network
			 , b.day1
			 , b.hour1
			 , b.day2
			 , b.hour2
			 , a.pgs_st_cd
			 , a.if_id
			 , pgcNm.xcod_hname AS pgs_st_nm
			 , a.snb_rson_sbc
			 , a.reason
		     , a.remark
		     , a.doc_no
		  from BGAB_GASCSE01$corp_cd$ a
		  join BGAB_GASCSE04$corp_cd$ b
		    on a.eeno = b.eeno
		   and a.apply_date = b.apply_date
		   and a.doc_no = b.doc_no
		  left outer join(
                select xcod_code, xcod_hname
                  from bgab_gascz005$corp_cd$
                 where xcod_knd = 'X0030'
                   and locale = #locale# 
                 )pgcNm
             on pgcNm.xcod_code = a.pgs_st_cd
		 where 1=1 
		   and type = #type#
		   <isNotEmpty property="if_id">
		   	   and a.if_id = #if_id#
		   </isNotEmpty>
		   <isEmpty property="if_id">
		       and a.eeno = #eeno#
			   and a.apply_date = #apply_date#
			   and a.doc_no = #doc_no#
		   </isEmpty>
		  order by seq
	</select>
	
	<insert id="insertSecurityRequestFilm" parameterClass="bgabGascse04">
		/* insertSecurityRequestFilm */
		insert into BGAB_GASCSE05$corp_cd$(
			 seq
			,eeno
			,apply_date
			,doc_no
			,area
			,exposure
			,company
			,photographer
			,brand
			,model
			,serial
			,day1
			,hour1
			,day2
			,hour2
			,inp_ymd
			,ipe_eeno
			,mdfy_ymd
			,updr_eeno
		)values(
			(select a.seq from (select IFNULL(max(seq),0 )+1 as seq from bgab_gascse05$corp_cd$ where eeno = #eeno# and apply_date = #apply_date#) a)
			,#eeno#
			,#apply_date#
			,#doc_no#
			,#area#
			,#exposure#
			,#company#
			,#photographer#
			,#brand#
			,#model#
			,#serial#
			,#day1#
			,#hour1#
			,#day2#
			,#hour2#
			,DATE_FORMAT(SYSDATE(), '%Y%m%d') 
			,#ipe_eeno#
			,DATE_FORMAT(SYSDATE(), '%Y%m%d')
			,#updr_eeno#
		)
	</insert>

	<update id="updateSecurityRequestFilm" parameterClass="bgabGascse04">
		/* updateSecurityRequestFilm */
		update BGAB_GASCSE05$corp_cd$
		   set area = #area#
			 , exposure = #exposure#
		   	 , company = #company#
		   	 , photographer = #photographer#
			 , brand = #brand#
			 , model = #model#
			 , serial = #serial#
			 , day1 = #day1#
			 , hour1 = #hour1#
			 , day2 = #day2#
			 , hour2 = #hour2#
			 , mdfy_ymd = DATE_FORMAT(SYSDATE(), '%Y%m%d')
			 , updr_eeno = #updr_eeno#
		 where seq = #seq#
		   and eeno = #eeno#
		   and apply_date = #apply_date#
		   and doc_no = #doc_no#
	</update>
	
	<delete id="deleteSecurityRequestFilm" parameterClass="bgabGascse04">
		/* deleteSecurityRequestFilm */
		delete from BGAB_GASCSE05$corp_cd$
		 where eeno = #eeno#
		   and apply_date = #apply_date#
		   and doc_no = #doc_no#
		   <isNotEmpty property="seq">
		   and seq = #seq#
		   </isNotEmpty>
	</delete>

	<select id="selectSecurityRequestFilm" parameterClass="bgabGascse04" resultClass="bgabGascse04">
		/* selectSecurityRequestFilm */
		select b.seq
			 , a.eeno
			 , replace(a.apply_date,'/','') AS apply_date
			 , a.purpose
			 , b.area
			 , b.exposure
			 , b.company
			 , b.photographer
			 , b.brand
			 , b.model
			 , b.serial
			 , b.day1
			 , b.hour1
			 , b.day2
			 , b.hour2
			 , a.pgs_st_cd
			 , a.if_id
			 , pgcNm.xcod_hname AS pgs_st_nm
			 , a.snb_rson_sbc
			 , a.reason
		     , a.remark
		     , a.doc_no
		  from BGAB_GASCSE01$corp_cd$ a
		  join BGAB_GASCSE05$corp_cd$ b
		    on a.eeno = b.eeno
		   and a.apply_date = b.apply_date
		   and a.doc_no = b.doc_no
		  left outer join(
                select xcod_code, xcod_hname
                  from bgab_gascz005$corp_cd$
                 where xcod_knd = 'X0030'
                   and locale   = #locale#
                 )pgcNm
             on pgcNm.xcod_code = a.pgs_st_cd
		 where 1=1 
		   and type = #type#
		   <isNotEmpty property="if_id">
		   	   and a.if_id = #if_id#
		   </isNotEmpty>
		   <isEmpty property="if_id">
		       and a.eeno = #eeno#
			   and a.apply_date = #apply_date#
			   and a.doc_no = #doc_no#
		   </isEmpty>
		  order by seq asc
	</select>
	
	<update id="updateRequestSecurityRequestVehicle" parameterClass="bgabGascse01">
		/* updateRequestSecurityRequestVehicle */
		update BGAB_GASCSE01$corp_cd$
		   set pgs_st_cd  = #key_pgs_st_cd#
		       <isEqual property="key_mode" compareValue="request">
		       	,if_id     = #if_id#
		       	,rpts_eeno = #rpts_eeno#
		       	,rpts_ymd  = DATE_FORMAT(SYSDATE(), '%Y%m%d')
		       </isEqual>
		       <isEqual property="key_mode" compareValue="requestCancel">
		       	,if_id     = ''
		       	,rpts_eeno = ''
		       	,rpts_ymd  = null
		       </isEqual>
		       <isEqual property="key_mode" compareValue="confirm">
		       	,acpc_eeno = #updr_eeno#
		       	,acpc_ymd  = DATE_FORMAT(SYSDATE(), '%Y%m%d')
		       </isEqual>
		       <isEqual property="key_mode" compareValue="confirmCancel">
		        ,if_id = ''
		       	,acpc_eeno = ''
		       	,acpc_ymd  = null
		       	,rpts_eeno = ''
		       	,rpts_ymd  = null
		       	,rdcs_eeno = ''
		       	,rdcs_ymd  = null
		       	,snb_rson_sbc = #snb_rson_sbc#
		       </isEqual>
		       <isEqual property="key_mode" compareValue="confirm2">
		        ,rdcs_eeno = #updr_eeno#
		        ,rdcs_ymd	= DATE_FORMAT(SYSDATE(), '%Y%m%d')
		        </isEqual>
		       ,updr_eeno = #updr_eeno#
		       ,mdfy_ymd  = DATE_FORMAT(SYSDATE(), '%Y%m%d')
		 where eeno       = #key_eeno#
		   and apply_date   = #key_req_date#
		   and type = #type#
		   and doc_no = #doc_no#
	</update>
	
	<update id="updateRequestSecurityRequestMaterial" parameterClass="bgabGascse02">
		/* updateRequestSecurityRequestMaterial */
		update BGAB_GASCSE01$corp_cd$
		   set pgs_st_cd  = #key_pgs_st_cd#
		       <isEqual property="key_mode" compareValue="request">
		       	,if_id     = #if_id#
		       	,rpts_eeno = #rpts_eeno#
		       	,rpts_ymd  = DATE_FORMAT(SYSDATE(), '%Y%m%d')
		       </isEqual>
		       <isEqual property="key_mode" compareValue="requestCancel">
		       	,if_id     = ''
		       	,rpts_eeno = ''
		       	,rpts_ymd  = null
		       </isEqual>
		       <isEqual property="key_mode" compareValue="confirm">
		       	,acpc_eeno = #updr_eeno#
		       	,acpc_ymd  = DATE_FORMAT(SYSDATE(), '%Y%m%d')
		       </isEqual>
		       <isEqual property="key_mode" compareValue="confirmCancel">
		        ,if_id = ''
		       	,acpc_eeno = ''
		       	,acpc_ymd  = null
		       	,rpts_eeno = ''
		       	,rpts_ymd  = null
		       	,rdcs_eeno = ''
		       	,rdcs_ymd  = null
		       	,snb_rson_sbc = #snb_rson_sbc#
		       </isEqual>
		       <isEqual property="key_mode" compareValue="confirm2">
		        ,rdcs_eeno = #updr_eeno#
		        ,rdcs_ymd	= DATE_FORMAT(SYSDATE(), '%Y%m%d')
		        </isEqual>
		       ,updr_eeno = #updr_eeno#
		       ,mdfy_ymd  = DATE_FORMAT(SYSDATE(), '%Y%m%d')
		 where eeno       = #key_eeno#
		   and apply_date   = #key_req_date#
		   and type = #type#
		   and doc_no = #doc_no#
	</update>
	
	<select id="selectSecurtyRequestType" parameterClass="bgabGascse01" resultClass="bgabGascse01">
		/* selectSecurtyRequestType */
		SELECT type
		  FROM BGAB_GASCSE01$corp_cd$ 
		WHERE IF_ID= #if_id#
	</select>
	
	<select id="selectCountSecurityRequestConfirmList" parameterClass="bgabGascse01" resultClass="String">
		/* selectCountSecurityRequestConfirmList */
		select count(*)
		  from BGAB_GASCSE01$corp_cd$ a
		  left outer join BGAB_GASCZ002$corp_cd$ usr
		    on a.eeno = usr.xusr_empno
		 where 1=1
		   and a.apply_date between #key_from_date# and #key_to_date# 
	       <isNotEmpty property="key_eenm">
		   and usr.xusr_name LIKE CONCAT('%', #key_eenm#, '%')
		   </isNotEmpty>
		   <isNotEmpty property="eeno">
		   and a.eeno = #eeno#
		   </isNotEmpty>
		   <isNotEmpty property="ops_cd">
		   and usr.xusr_dept_code = #ops_cd#
		   </isNotEmpty>
		   <isNotEmpty property="pgs_st_cd">
		   and a.pgs_st_cd = #pgs_st_cd#
		   </isNotEmpty>
		   <isNotEmpty property="work_area">
		   and usr.xusr_plac_work = #work_area#
		   </isNotEmpty>
		   <isNotEmpty property="type">
		   and a.type = #type#
		   </isNotEmpty>
	</select>
	
	<select id="selectSecurityRequestConfirmList" parameterClass="bgabGascse01" resultClass="bgabGascse01">
		/* selectSecurityRequestConfirmList */
		select * 
		  from (
				select k.*
				  from (
				  	select @ROWNUM := @ROWNUM + 1 AS rnum
				  		 , m.*
				  	from
				  	(
						select DISTINCT REPLACE(a.apply_date,'/','') AS apply_date
							 , REPLACE(a.apply_date,'/','') AS od_dt
							 , a.eeno
							 , usr.xusr_name as ee_nm
							 , usr.xusr_step_code as step_code
							 , usr.xusr_step_name as step_name
							 , usr.xusr_dept_code as ops_cd
							 , usr.xusr_dept_name as ops_nm
							 , a.type
							 , c.xcod_hname as type_nm
							 , a.pgs_st_cd
						     , b.xcod_hname as pgs_st_nm
						     , a.doc_no
						     , case when type = 1
						            then (select count(seq) from BGAB_GASCSE02$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
						            when type = 2
						            then (select count(seq) from BGAB_GASCSE03$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
						            when type = 3
						            then (select count(seq) from BGAB_GASCSE04$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
						            when type = 4
						            then (select count(seq) from BGAB_GASCSE05$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
						            when type = 5
						            then (select count(seq) from BGAB_GASCSE07$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
						        end as num_req
						  from BGAB_GASCSE01$corp_cd$ a
						  left outer join(
								select xcod_code, xcod_hname
								  from bgab_gascz005$corp_cd$
								 where xcod_knd = 'X0030'
								 and   locale   = #locale#
								 ) b
							on b.xcod_code = a.pgs_st_cd
						  left outer join(
								select xcod_code, xcod_hname
								  from bgab_gascz005$corp_cd$
								 where xcod_knd = 'X3001'
								 and locale = #locale#
								 ) c
							on c.xcod_code = a.type
						  left outer join BGAB_GASCZ002$corp_cd$ usr
						    on a.eeno = usr.xusr_empno
						 where 1=1
						   and a.apply_date between #key_from_date# and #key_to_date# 
					       <isNotEmpty property="key_eenm">
						   and usr.xusr_name LIKE CONCAT('%', #key_eenm#, '%')
						   </isNotEmpty>
						   <isNotEmpty property="eeno">
						   and a.eeno = #eeno#
						   </isNotEmpty>
						   <isNotEmpty property="ops_cd">
						   and usr.xusr_dept_code = #ops_cd#
						   </isNotEmpty>
						   <isNotEmpty property="pgs_st_cd">
						   and a.pgs_st_cd = #pgs_st_cd#
						   </isNotEmpty>
						   <isNotEmpty property="work_area">
						   and usr.xusr_plac_work = #work_area#
						   </isNotEmpty>
						   <isNotEmpty property="type">
						   and a.type = #type#
						   </isNotEmpty>
						   order by od_dt desc, doc_no desc
						) m,
						(SELECT @ROWNUM := 0) r
					) k
			) z
		WHERE rnum between #startRow# AND #endRow#	
	</select>
	
<!-- 	<select id="selectSecurityApprovalInfo" parameterClass="CommonApproval" resultClass="String"> -->
<!-- 		/*selectSecurityApprovalInfo*/ -->
<!-- 		SELECT F_APPROVALINFO_SECURITY(#if_id#, #system_code#, #code1#)  -->
<!-- 	</select> --> 
	
	<parameterMap id="SecurityApprovalInfoParamMap" class="java.util.HashMap" >
		<parameter property="if_id"       jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="system_code" jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="code1" 	   jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="corp_cd"     jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" />
		<parameter property="ResultVal"   jdbcType="VARCHAR" javaType="java.lang.String" mode="OUT" />
	</parameterMap>
	<procedure id="selectSecurityApprovalInfo" parameterMap="SecurityApprovalInfoParamMap" resultClass="java.util.HashMap">
	 	{ call P_APPROVALINFO_SECURITY(?,?,?,?,?) }
	</procedure>
	
	<select id="selectSecurityManagerMgmtListCount" parameterClass="bgabGascse05" resultClass="String">
		/* selectSecurityManagerMgmtListCount */
		select count(*)
		  from BGAB_GASCSE06$corp_cd$
		 where 1=1
		   <isNotEmpty property="type">
		   and type = #type#
		   </isNotEmpty>
	</select>
	
	<select id="selectSecurityManagerMgmtList" parameterClass="bgabGascse05" resultClass="bgabGascse05">
		/* selectSecurityManagerMgmtList */
		select * 
		  from (
				select @ROWNUM := @ROWNUM + 1 AS rnum
					 , k.*
				  from (
						select type as type_cd
							 , a.eeno
							 , usr.xusr_name as eenm
							 , usr.xusr_step_code as step_code
							 , usr.xusr_step_name as step_name
							 , usr.xusr_dept_code as dept_cd
							 , usr.xusr_dept_name as dept_nm
							 , 'U' as gb
							 , type as old_type
							 , eeno as old_eeno
							 , dept_cd as old_dept_cd
						  from BGAB_GASCSE06$corp_cd$ a
						  left outer join BGAB_GASCZ002$corp_cd$ usr
						    on a.eeno = usr.xusr_empno
						 where 1=1
						   <isNotEmpty property="type">
						   and a.type = #type#
						   </isNotEmpty>
						   order by type_cd
						) k,
						(SELECT @ROWNUM := 0) r
				) z
		 WHERE rnum between #startRow# AND #endRow#	
	</select>
	
	<insert id="insertSecurityManagerMgmt" parameterClass="bgabGascse05">
		/* insertSecurityManagerMgmt */
		insert into BGAB_GASCSE06$corp_cd$(
			 type
			,eeno
			,dept_cd
			,inp_ymd
			,ipe_eeno
			,mdfy_ymd
			,updr_eeno
		)values(
			 #type#
			,#eeno#
			,#dept_cd#
			,DATE_FORMAT(SYSDATE(), '%Y%m%d') 
			,#ipe_eeno#
			,DATE_FORMAT(SYSDATE(), '%Y%m%d')
			,#updr_eeno#
		)
	</insert>

	<update id="updateSecurityManagerMgmt" parameterClass="bgabGascse05">
		/* updateSecurityManagerMgmt */
		update BGAB_GASCSE06$corp_cd$
		   set type = #type#
		 	 , eeno = #eeno#
			 , dept_cd = #dept_cd#
			 , mdfy_ymd = DATE_FORMAT(SYSDATE(), '%Y%m%d')
			 , updr_eeno = #updr_eeno#
		 where type = #old_type#
		   and eeno = #old_eeno#
		   and dept_cd = #old_dept_cd#
	</update>

	<delete id="deleteSecurityManagerMgmt" parameterClass="bgabGascse05">
		/* deleteSecurityManagerMgmt */
		delete from BGAB_GASCSE06$corp_cd$
		 where type = #type#
		   and dept_cd = #dept_cd#
		   and eeno = #eeno#
	</delete>
	
	<select id="selectFilmComboArea" resultClass="bgabGascse05">
		/* selectFilmComboArea */
		select distinct usr.xusr_dept_code as dept_cd
			 , usr.xusr_dept_name as dept_nm
		  from BGAB_GASCSE06$corp_cd$ a
		  left outer join BGAB_GASCZ002$corp_cd$ usr
		    on a.eeno = usr.xusr_empno
		 where type = 'A'
	</select>
	
	<select id="selectSecurityManagerMgmtCheck" parameterClass="bgabGascse05" resultClass="String">
		/* selectSecurityManagerMgmtCheck */
		select count(*)
		  from BGAB_GASCSE06$corp_cd$
		 where 1=1
		 <isEqual property="type" compareValue="A"> 
		   and type = #type#
		   and dept_cd = #dept_cd#
		 </isEqual>
		 <isNotEqual property="type" compareValue="A">
		 	<isNotEqual property="gb" compareValue="U">
		   and type = #type# 
		   	</isNotEqual>
		 </isNotEqual>
	</select>
	
	<insert id="insertSecurityRequestEntrance" parameterClass="bgabGascse06">
		/* insertSecurityRequestEntrance */
		insert into BGAB_GASCSE07$corp_cd$(
			 seq
			,eeno
			,apply_date
			,doc_no
			,full_name
			,et_rg
			,company
			,visit_purp
			,et_type
			,et_access
			,et_date
			,et_status
			,et_remark
			,inp_ymd
			,ipe_eeno
			,mdfy_ymd
			,updr_eeno
		)values(
			(select a.seq from (select IFNULL(max(seq),0 )+1 as seq from bgab_gascse07$corp_cd$ where eeno = #eeno# and apply_date = #apply_date#)a )
			,#eeno#
			,#apply_date#
			,#doc_no#
			,#full_name#
			,#et_rg#
			,#company#
			,#visit_purp#
			,#et_type#
			,#access#
			,#et_date#
			,#et_status#
			,#et_remark#
			,SYSDATE() 
			,#ipe_eeno#
			,SYSDATE()
			,#updr_eeno#
		)
	</insert>

	<update id="updateSecurityRequestEntrance" parameterClass="bgabGascse06">
		/* updateSecurityRequestEntrance */
		update BGAB_GASCSE07$corp_cd$
		   set full_name = #full_name#
			 , et_rg = #et_rg#
			 , company = #company#
			 , visit_purp = #visit_purp#
			 , et_type = #et_type#
			 , et_access = #access#
			 , et_date = #et_date#
			 , et_status = #et_status#
			 , et_remark = #et_remark#
			 , mdfy_ymd = SYSDATE()
			 , updr_eeno = #updr_eeno#
		 where seq = #seq#
		   and eeno = #eeno#
		   and apply_date = #apply_date#
		   and doc_no = #doc_no#
	</update>
	
	<delete id="deleteSecurityRequestEntrance" parameterClass="bgabGascse06">
		/* deleteSecurityRequestEntrance */
		delete from BGAB_GASCSE07$corp_cd$
		 where eeno = #eeno#
		   and apply_date = #apply_date#
		   and doc_no = #doc_no#
		   <isNotEmpty property="seq">
		   and seq = #seq#
		   </isNotEmpty>
	</delete>

	<select id="selectSecurityRequestEntrance" parameterClass="bgabGascse06" resultClass="bgabGascse06">
		/* selectSecurityRequestEntrance */
		select b.seq
			 , a.eeno
			 , a.apply_date
			 , full_name
			 , et_rg
			 , company
			 , visit_purp
			 , et_type
			 , et_access
			 , DATE_FORMAT( CAST(et_date AS DATE ), '%Y-%m-%d') as et_date
			 , et_status
			 , et_remark
			 , a.pgs_st_cd
			 , a.if_id
			 , pgcNm.xcod_hname pgs_st_nm
			 , a.snb_rson_sbc
		     , a.remark
		     , a.doc_no
		     , a.purpose
		     , a.reason
		  from BGAB_GASCSE01$corp_cd$ a
		  join BGAB_GASCSE07$corp_cd$ b
		    on a.eeno = b.eeno
		   and a.apply_date = b.apply_date
		   and a.doc_no = b.doc_no
		  left outer join(
                select xcod_code, xcod_hname
                  from bgab_gascz005$corp_cd$
                 where xcod_knd = 'X0030'
                   and locale = #locale# 
                 )pgcNm
             on pgcNm.xcod_code = a.pgs_st_cd
		 where 1=1 
		   and type = #type#
		   <isNotEmpty property="if_id">
		   	   and a.if_id = #if_id#
		   </isNotEmpty>
		   <isEmpty property="if_id">
		       and a.eeno = #eeno#
			   and a.apply_date = #apply_date#
			   and a.doc_no = #doc_no#
		   </isEmpty>
		  order by seq asc
	</select>
	
	<select id="selectSecurityRemark" parameterClass="bgabGascse01" resultClass="bgabGascse01">
		/* selectSecurityRemark */
		select doc_no
			 , remark
		  from BGAB_GASCSE01$corp_cd$
		 where doc_no = #doc_no#
	</select>
	
	<insert id="insertXVToFile" parameterClass="bgabGascZ011Dto">
		/* Query Id : insertXVToFile */
		INSERT INTO BGAB_GASCZ011$corp_cd$ (
			   DOC_NO
			 , EENO
			 , SEQ
			 , AFFR_SCN_CD
			 , OGC_FIL_NM
			 , FIL_NM
			 , FIL_MGN_QTY
			 , INP_YMD
			 , IPE_EENO
		)VALUES(
			   #doc_no#
			 , #eeno#
			 , #seq#
			 , #affr_scn_cd#
			 , #ogc_fil_nm#
			 , #fil_nm#
			 , #fil_mgn_qty#
			 , DATE_FORMAT(SYSDATE(), '%Y%m%d')
			 , #ipe_eeno#
		)
	</insert>

	<select id="selectXVToFile" resultClass="bgabGascZ011Dto" parameterClass="bgabGascZ011Dto">
		/* Query Id : selectXVToFile */
		SELECT DOC_NO
			 , EENO
			 , SEQ
			 , AFFR_SCN_CD
			 , FIL_NM
			 , OGC_FIL_NM
			 , FIL_MGN_QTY
			 , INP_YMD
			 , IPE_EENO
		  FROM BGAB_GASCZ011$corp_cd$
		 WHERE DOC_NO = #doc_no#
		   AND EENO = #eeno#
		   AND SEQ = #seq#
		   AND AFFR_SCN_CD = #affr_scn_cd#
		<isNotEmpty property="ogc_fil_nm" prepend="and">
			OGC_FIL_NM = #ogc_fil_nm#
		</isNotEmpty>
		ORDER BY FIL_NM
	</select>

	<delete id="deleteXVToFile" parameterClass="bgabGascZ011Dto">
		/* Query Id : deleteXVToFile */
		DELETE FROM BGAB_GASCZ011$corp_cd$
		 WHERE DOC_NO = #doc_no#
		   AND EENO = #eeno#
		   AND SEQ = #seq#
		   AND AFFR_SCN_CD = #affr_scn_cd#
		   AND OGC_FIL_NM = #ogc_fil_nm#
	</delete>
	
	<update id="updateInfoSecurityToReject" parameterClass="bgabGascse01">
   		UPDATE	BGAB_GASCSE01$corp_cd$
		SET 	PGS_ST_CD  = #pgs_st_cd#
				,IF_ID     = ''
				,RPTS_EENO = ''
				,RPTS_YMD  = ''
				,RDCS_EENO = ''
				,RDCS_YMD  = ''
				,ACPC_EENO = ''
				,ACPC_YMD  = ''
				,SNB_RSON_SBC = #snb_rson_sbc#
				,UPDR_EENO = #updr_eeno#
				,MDFY_YMD  = DATE_FORMAT(SYSDATE(), '%Y%m%d')
		WHERE	1 = 1
		AND		DOC_NO = #doc_no#
	</update>
	
	<update id="updateApproveSecurityEntrance" parameterClass="bgabGascse01">
		/* updateApproveSecurityEntrance */
		UPDATE	BGAB_GASCSE01$corp_cd$
		SET 	PGS_ST_CD  = #pgs_st_cd#
				,UPDR_EENO = #updr_eeno#
				,MDFY_YMD  = DATE_FORMAT(SYSDATE(), '%Y%m%d')
		WHERE	DOC_NO = #doc_no#
	</update>
	
	<update id="updateApproveCancelSecurityEntrance" parameterClass="bgabGascse01">
		/* updateApproveCancelSecurityEntrance */
		UPDATE	BGAB_GASCSE01$corp_cd$
		SET 	PGS_ST_CD  = #pgs_st_cd#
				,IF_ID     = ''
		       	,RPTS_EENO = ''
		       	,RPTS_YMD  = ''
				,UPDR_EENO = #updr_eeno#
				,MDFY_YMD  = DATE_FORMAT(SYSDATE(), '%Y%m%d')
		WHERE	DOC_NO = #doc_no#
	</update>
	
	<select id="selectCountSecurityVistiorCustomer" parameterClass="bgabGascse01" resultClass="String">
		/* selectCountSecurityVistiorCustomer */
		SELECT COUNT(*)
		FROM
		(
			SELECT 	A.EENO AS EENO
					,C.XUSR_NAME AS EE_NM
					,C.XUSR_DEPT_CODE AS OPS_CD
					,C.XUSR_DEPT_NAME AS OPS_NM
					,B.FULL_NAME
					,B.ET_RG
					,B.COMPANY
					,B.ET_DATE
					,A.PGS_ST_CD
					,D.XCOD_HNAME AS PGS_ST_NM
					,CONCAT(SUBSTR(B.ET_DATE,7,4), SUBSTR(B.ET_DATE,4,2), SUBSTR(B.ET_DATE,1,2)) AS ET_DATE1
			FROM BGAB_GASCSE01$corp_cd$ A
			INNER JOIN BGAB_GASCSE07$corp_cd$ B
			ON A.DOC_NO=B.DOC_NO
			LEFT OUTER JOIN BGAB_GASCZ002$corp_cd$ C           
			ON A.EENO = C.XUSR_EMPNO  
			LEFT OUTER JOIN 
			(
				SELECT * FROM BGAB_GASCZ005$corp_cd$ WHERE XCOD_KND = 'X0030' AND LOCALE = #locale#
			) D
			ON A.PGS_ST_CD = D.XCOD_CODE
			 where 1=1
			   <isNotEmpty property="eeno">
			   and B.ET_RG = #eeno#
			   </isNotEmpty>
			   <isNotEmpty property="key_eenm">
			   and B.FULL_NAME LIKE CONCAT('%', #key_eenm#, '%')
			   </isNotEmpty>
			   <isNotEmpty property="ops_cd">
			   and usr.xusr_dept_code = #ops_cd#
			   </isNotEmpty>
			   <isNotEmpty property="pgs_st_cd">
			   and a.pgs_st_cd = #pgs_st_cd#
			   </isNotEmpty>
			   <isNotEmpty property="work_area">
			   and c.xusr_plac_work = #work_area#
			   </isNotEmpty>
		)K
		WHERE 1 = 1
		<isNotEmpty property="key_from_date">
	     AND K.ET_DATE1 BETWEEN #key_from_date# AND #key_to_date#
	    </isNotEmpty>
	</select>
	
	<select id="selectSecurityVistiorCustomer" parameterClass="bgabGascse01" resultClass="bgabGascse06">
		/* selectSecurityVistiorCustomer */
		select * 
		  from (
				select @ROWNUM := @ROWNUM + 1 AS rnum
					 , k.*
				  from (
							SELECT 	A.EENO AS EENO
									,C.XUSR_NAME AS EE_NM
									,C.XUSR_DEPT_CODE AS OPS_CD
									,C.XUSR_DEPT_NAME AS OPS_NM
									,B.FULL_NAME
									,B.ET_RG
									,B.COMPANY
									,B.ET_DATE
									,A.PGS_ST_CD
									,D.XCOD_HNAME AS PGS_ST_NM
									,B.ET_DATE AS ET_DATE1
									,A.DOC_NO
									,REPLACE(A.APPLY_DATE,'/','') AS APPLY_DATE
							FROM BGAB_GASCSE01$corp_cd$ A
							INNER JOIN BGAB_GASCSE07$corp_cd$ B
							ON A.DOC_NO = B.DOC_NO
							LEFT OUTER JOIN BGAB_GASCZ002$corp_cd$ C           
							ON A.EENO = C.XUSR_EMPNO  
							LEFT OUTER JOIN 
							(
								SELECT * FROM BGAB_GASCZ005$corp_cd$ WHERE XCOD_KND = 'X0030' AND LOCALE = #locale#
							) D
							ON A.PGS_ST_CD = D.XCOD_CODE
							 where 1=1
							   <isNotEmpty property="eeno">
							   and B.ET_RG = #eeno#
							   </isNotEmpty>
							   <isNotEmpty property="key_eenm">
							   and B.FULL_NAME LIKE CONCAT('%', #key_eenm#, '%')
							   </isNotEmpty>
							   <isNotEmpty property="ops_cd">
							   and usr.xusr_dept_code = #ops_cd#
							   </isNotEmpty>
							   <isNotEmpty property="pgs_st_cd">
							   and a.pgs_st_cd = #pgs_st_cd#
							   </isNotEmpty>
							   <isNotEmpty property="work_area">
							   and c.xusr_plac_work = #work_area#
							   </isNotEmpty>
						) k,
						(SELECT @ROWNUM := 0) r
						WHERE 1 = 1
						<isNotEmpty property="key_from_date">
					     AND K.ET_DATE1 BETWEEN #key_from_date# AND #key_to_date#
					    </isNotEmpty>
					    ORDER BY k.OPS_CD
					    	   , k.EENO
					    	   , k.DOC_NO
				) z
		 WHERE RNUM BETWEEN #startRow# AND #endRow#	
	</select>
	
	<select id="selectCountSecurityRequestListType1" parameterClass="bgabGascse01" resultClass="String">
		/* selectCountSecurityRequestListType1 */
		select count(*)
		  from (
				select DISTINCT REPLACE(a.apply_date,'/','') AS apply_date
					 , REPLACE(a.apply_date,'/','') AS od_dt
					 , a.eeno
					 , driver_name as ee_nm
					 , usr.xusr_step_code as step_code
					 , usr.xusr_step_name as step_name
					 , usr.xusr_dept_code as ops_cd
					 , usr.xusr_dept_name as ops_nm
					 , a.type
					 , c.xcod_hname as type_nm
					 , a.pgs_st_cd
				     , b.xcod_hname as pgs_st_nm
				     , a.doc_no
				     , case when type = 1
				            then (select count(seq) from BGAB_GASCSE02$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
				            when type = 2
				            then (select count(seq) from BGAB_GASCSE03$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
				            when type = 3
				            then (select count(seq) from BGAB_GASCSE04$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
				            when type = 4
				            then (select count(seq) from BGAB_GASCSE05$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
				            when type = 5
				            then (select count(seq) from BGAB_GASCSE07$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
				        end as num_req
				  from BGAB_GASCSE01$corp_cd$ a
				  left outer join(
						select xcod_code, xcod_hname
						  from bgab_gascz005$corp_cd$
						 where xcod_knd = 'X0030'
						   and locale = #locale#
						 ) b
					on b.xcod_code = a.pgs_st_cd
				  left outer join(
						select xcod_code, xcod_hname
						  from bgab_gascz005$corp_cd$
						 where xcod_knd = 'X3001'
						   and locale = #locale#
						 ) c
					on c.xcod_code = a.type
				  left outer join BGAB_GASCZ002$corp_cd$ usr
				    on a.eeno = usr.xusr_empno
				  join BGAB_GASCSE02$corp_cd$ T1
				    on a.doc_no = T1.doc_no
				 where 1=1
				   and (#key_from_date# between start_ymd and end_ymd 
				       or #key_to_date# between start_ymd and end_ymd 
				       or start_ymd between #key_from_date# and #key_to_date# 
				       or end_ymd  between #key_from_date# and #key_to_date#)
				   <isNotEmpty property="key_eenm">
				   and DRIVER_NAME LIKE CONCAT('%', #key_eenm#, '%')
				   </isNotEmpty>
				   <isNotEmpty property="ops_cd">
				   and usr.xusr_dept_code = #ops_cd#
				   </isNotEmpty>
				   <isNotEmpty property="pgs_st_cd">
				   and a.pgs_st_cd = #pgs_st_cd#
				   </isNotEmpty>
				   <isNotEmpty property="work_area">
				   and usr.xusr_plac_work = #work_area#
				   </isNotEmpty>
				   <isNotEmpty property="type">
				   and a.type = #type#
				   </isNotEmpty>
				   <isNotEmpty property="plate">
				   and T1.PLATE = #plate#
				   </isNotEmpty>
			) k
	</select>
	
	<select id="getSelectSecurityRequestListType1" parameterClass="bgabGascse01" resultClass="bgabGascse01">
		/* getSelectSecurityRequestListType1 */
		select * 
		  from (
				select k.*, m.rnum
				  from (
				  	select @ROWNUM := @ROWNUM + 1 AS rnum
				  		 , m.*
				  	from
				  	(
						select DISTINCT a.apply_date
							 , a.apply_date as od_dt
							 , a.eeno
							 , T1.START_YMD
							 , T1.END_YMD
							 , T1.driver_name as ee_nm
							 , T1.DRIVER_LIC
							 , T1.plate
							 , usr.xusr_step_code as step_code
							 , usr.xusr_step_name as step_name
							 , usr.xusr_dept_code as ops_cd
							 , usr.xusr_dept_name as ops_nm
							 , a.type
							 , c.xcod_hname as type_nm
							 , a.pgs_st_cd
						     , b.xcod_hname as pgs_st_nm
						     , a.doc_no
						     , case when type = 1
						            then (select count(seq) from BGAB_GASCSE02$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
						            when type = 2
						            then (select count(seq) from BGAB_GASCSE03$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
						            when type = 3
						            then (select count(seq) from BGAB_GASCSE04$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
						            when type = 4
						            then (select count(seq) from BGAB_GASCSE05$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
						            when type = 5
						            then (select count(seq) from BGAB_GASCSE07$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
						        end as num_req
						  from BGAB_GASCSE01$corp_cd$ a
						  left outer join(
								select xcod_code, xcod_hname
								  from bgab_gascz005$corp_cd$
								 where xcod_knd = 'X0030'
								   and locale = #locale#
								 ) b
							on b.xcod_code = a.pgs_st_cd
						  left outer join(
								select xcod_code, xcod_hname
								  from bgab_gascz005$corp_cd$
								 where xcod_knd = 'X3001'
								   and locale = #locale#
								 ) c
							on c.xcod_code = a.type
						  left outer join BGAB_GASCZ002$corp_cd$ usr
						    on a.eeno = usr.xusr_empno
						  join BGAB_GASCSE02$corp_cd$ T1
						    on a.doc_no = T1.doc_no
						 where 1=1
						   and (#key_from_date# between start_ymd and end_ymd 
						       or #key_to_date# between start_ymd and end_ymd 
						       or start_ymd between #key_from_date# and #key_to_date# 
						       or end_ymd  between #key_from_date# and #key_to_date#)
						   <isNotEmpty property="key_eenm">
						   and DRIVER_NAME LIKE CONCAT('%', #key_eenm#, '%')
						   </isNotEmpty>
						   <isNotEmpty property="ops_cd">
						   and usr.xusr_dept_code = #ops_cd#
						   </isNotEmpty>
						   <isNotEmpty property="pgs_st_cd">
						   and a.pgs_st_cd = #pgs_st_cd#
						   </isNotEmpty>
						   <isNotEmpty property="work_area">
						   and usr.xusr_plac_work = #work_area#
						   </isNotEmpty>
						   <isNotEmpty property="type">
						   and a.type = #type#
						   </isNotEmpty>
						   <isNotEmpty property="plate">
						   and T1.PLATE = #plate#
						   </isNotEmpty>
						   order by od_dt desc, doc_no desc
						) m,
						(SELECT @ROWNUM := 0) r
					) k
			) z
		WHERE RNUM BETWEEN #startRow# AND #endRow#	
	</select>
	
	<select id="selectCountSecurityRequestListType2" parameterClass="bgabGascse01" resultClass="String">
		/* selectCountSecurityRequestListType2 */
		select count(*)
		  from (
				select DISTINCT REPLACE(a.apply_date,'/','') AS apply_date
					 , REPLACE(a.apply_date,'/','') AS od_dt
					 , a.eeno
					 , CARRIER as ee_nm
					 , usr.xusr_step_code as step_code
					 , usr.xusr_step_name as step_name
					 , usr.xusr_dept_code as ops_cd
					 , usr.xusr_dept_name as ops_nm
					 , a.type
					 , c.xcod_hname as type_nm
					 , a.pgs_st_cd
				     , b.xcod_hname as pgs_st_nm
				     , a.doc_no
				     , case when type = 1
				            then (select count(seq) from BGAB_GASCSE02$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
				            when type = 2
				            then (select count(seq) from BGAB_GASCSE03$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
				            when type = 3
				            then (select count(seq) from BGAB_GASCSE04$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
				            when type = 4
				            then (select count(seq) from BGAB_GASCSE05$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
				            when type = 5
				            then (select count(seq) from BGAB_GASCSE07$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
				        end as num_req
				  from BGAB_GASCSE01$corp_cd$ a
				  left outer join(
						select xcod_code, xcod_hname
						  from bgab_gascz005$corp_cd$
						 where xcod_knd = 'X0030'
						   and locale = #locale#
						 ) b
					on b.xcod_code = a.pgs_st_cd
				  left outer join(
						select xcod_code, xcod_hname
						  from bgab_gascz005$corp_cd$
						 where xcod_knd = 'X3001'
						   and locale = #locale#
						 ) c
					on c.xcod_code = a.type
				  left outer join BGAB_GASCZ002$corp_cd$ usr
				    on a.eeno = usr.xusr_empno
				  join BGAB_GASCSE03$corp_cd$ T1
				    on a.doc_no = T1.doc_no
				 where 1=1
				   and (#key_from_date# between day1 and day2 
				       or #key_to_date# between day1 and day2 
				       or day1 between #key_from_date# and #key_to_date# 
				       or day2  between #key_from_date# and #key_to_date# )
				   <isNotEmpty property="key_eenm">
				   and CARRIER LIKE CONCAT('%', #key_eenm#, '%')
				   </isNotEmpty>
				   <isNotEmpty property="ops_cd">
				   and usr.xusr_dept_code = #ops_cd#
				   </isNotEmpty>
				   <isNotEmpty property="pgs_st_cd">
				   and a.pgs_st_cd = #pgs_st_cd#
				   </isNotEmpty>
				   <isNotEmpty property="work_area">
				   and usr.xusr_plac_work = #work_area#
				   </isNotEmpty>
				   <isNotEmpty property="type">
				   and a.type = #type#
				   </isNotEmpty>
			) k
	</select>
	
	<select id="getSelectSecurityRequestListType2" parameterClass="bgabGascse01" resultClass="bgabGascse01">
		/* getSelectSecurityRequestListType2 */
		select * 
		  from (
				select k.*, m.rnum
				  from (
				  	select @ROWNUM := @ROWNUM + 1 AS rnum
				  		 , m.*
				  	from
				  	(
						select DISTINCT REPLACE(a.apply_date,'/','') AS apply_date
							 , REPLACE(a.apply_date,'/','') AS od_dt
							 , a.eeno
							 , T1.day1 as start_ymd
							 , T1.day2 as end_ymd
							 , T1.CARRIER as ee_nm
							 , T1.COMPANY
							 , T1.BRAND
							 , usr.xusr_step_code as step_code
							 , usr.xusr_step_name as step_name
							 , usr.xusr_dept_code as ops_cd
							 , usr.xusr_dept_name as ops_nm
							 , a.type
							 , c.xcod_hname as type_nm
							 , a.pgs_st_cd
						     , b.xcod_hname as pgs_st_nm
						     , a.doc_no
						     , case when type = 1
						            then (select count(seq) from BGAB_GASCSE02$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
						            when type = 2
						            then (select count(seq) from BGAB_GASCSE03$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
						            when type = 3
						            then (select count(seq) from BGAB_GASCSE04$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
						            when type = 4
						            then (select count(seq) from BGAB_GASCSE05$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
						            when type = 5
						            then (select count(seq) from BGAB_GASCSE07$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
						        end as num_req
						  from BGAB_GASCSE01$corp_cd$ a
						  left outer join(
								select xcod_code, xcod_hname
								  from bgab_gascz005$corp_cd$
								 where xcod_knd = 'X0030'
								   and locale = #locale#
								 ) b
							on b.xcod_code = a.pgs_st_cd
						  left outer join(
								select xcod_code, xcod_hname
								  from bgab_gascz005$corp_cd$
								 where xcod_knd = 'X3001'
								   and locale = #locale#
								 ) c
							on c.xcod_code = a.type
						  left outer join BGAB_GASCZ002$corp_cd$ usr
						    on a.eeno = usr.xusr_empno
						  join BGAB_GASCSE03$corp_cd$ T1
						    on a.doc_no = T1.doc_no
						 where 1=1
						   and (#key_from_date# between day1 and day2 
						       or #key_to_date# between day1 and day2 
						       or day1 between #key_from_date# and #key_to_date# 
						       or day2  between #key_from_date# and #key_to_date# )
						   <isNotEmpty property="key_eenm">
						   and CARRIER LIKE CONCAT('%', #key_eenm#, '%')
						   </isNotEmpty>
						   <isNotEmpty property="ops_cd">
						   and usr.xusr_dept_code = #ops_cd#
						   </isNotEmpty>
						   <isNotEmpty property="pgs_st_cd">
						   and a.pgs_st_cd = #pgs_st_cd#
						   </isNotEmpty>
						   <isNotEmpty property="work_area">
						   and usr.xusr_plac_work = #work_area#
						   </isNotEmpty>
						   <isNotEmpty property="type">
						   and a.type = #type#
						   </isNotEmpty>
						   order by od_dt desc, doc_no desc
						) m,
						(SELECT @ROWNUM := 0) r
					) k
			) z
		WHERE rnum between #startRow# AND #endRow#	
	</select>
	
	<select id="selectCountSecurityRequestListType3" parameterClass="bgabGascse01" resultClass="String">
		/* selectCountSecurityRequestListType3 */
		select count(*)
		  from (
				select DISTINCT REPLACE(a.apply_date,'/','') AS apply_date
					 , REPLACE(a.apply_date,'/','') AS od_dt
					 , a.eeno
					 , CARRIER as ee_nm
					 , usr.xusr_step_code as step_code
					 , usr.xusr_step_name as step_name
					 , usr.xusr_dept_code as ops_cd
					 , usr.xusr_dept_name as ops_nm
					 , a.type
					 , c.xcod_hname as type_nm
					 , a.pgs_st_cd
				     , b.xcod_hname as pgs_st_nm
				     , a.doc_no
				     , case when type = 1
				            then (select count(seq) from BGAB_GASCSE02$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
				            when type = 2
				            then (select count(seq) from BGAB_GASCSE03$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
				            when type = 3
				            then (select count(seq) from BGAB_GASCSE04$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
				            when type = 4
				            then (select count(seq) from BGAB_GASCSE05$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
				            when type = 5
				            then (select count(seq) from BGAB_GASCSE07$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
				        end as num_req
				  from BGAB_GASCSE01$corp_cd$ a
				  left outer join(
						select xcod_code, xcod_hname
						  from bgab_gascz005$corp_cd$
						 where xcod_knd = 'X0030'
						   and locale = #locale#
						 ) b
					on b.xcod_code = a.pgs_st_cd
				  left outer join(
						select xcod_code, xcod_hname
						  from bgab_gascz005$corp_cd$
						 where xcod_knd = 'X3001'
						   and locale = #locale#
						 ) c
					on c.xcod_code = a.type
				  left outer join BGAB_GASCZ002$corp_cd$ usr
				    on a.eeno = usr.xusr_empno
				  join BGAB_GASCSE04$corp_cd$ T1
				    on a.doc_no = T1.doc_no
				 where 1=1
				   and (#key_from_date# between day1 and day2 
				       or #key_to_date# between day1 and day2 
				       or day1 between #key_from_date# and #key_to_date# 
				       or day2  between #key_from_date# and #key_to_date# )
				   <isNotEmpty property="key_eenm">
				   and CARRIER LIKE CONCAT('%', #key_eenm#, '%')
				   </isNotEmpty>
				   <isNotEmpty property="ops_cd">
				   and usr.xusr_dept_code = #ops_cd#
				   </isNotEmpty>
				   <isNotEmpty property="pgs_st_cd">
				   and a.pgs_st_cd = #pgs_st_cd#
				   </isNotEmpty>
				   <isNotEmpty property="work_area">
				   and usr.xusr_plac_work = #work_area#
				   </isNotEmpty>
				   <isNotEmpty property="type">
				   and a.type = #type#
				   </isNotEmpty>
			) k
	</select>
	
	<select id="getSelectSecurityRequestListType3" parameterClass="bgabGascse01" resultClass="bgabGascse01">
		/* getSelectSecurityRequestListType3 */
		select * 
		  from (
				select k.*, m.rnum
				  from (
				  	select @ROWNUM := @ROWNUM + 1 AS rnum
				  		 , m.*
				  	from
				  	(
						select DISTINCT REPLACE(a.apply_date,'/','') AS apply_date
							 , REPLACE(a.apply_date,'/','') AS od_dt
							 , a.eeno
							 , T1.day1 as start_ymd
							 , T1.day2 as end_ymd
							 , T1.CARRIER as ee_nm
							 , T1.COMPANY
							 , T1.BRAND
							 , usr.xusr_step_code as step_code
							 , usr.xusr_step_name as step_name
							 , usr.xusr_dept_code as ops_cd
							 , usr.xusr_dept_name as ops_nm
							 , a.type
							 , c.xcod_hname as type_nm
							 , a.pgs_st_cd
						     , b.xcod_hname as pgs_st_nm
						     , a.doc_no
						     , case when type = 1
						            then (select count(seq) from BGAB_GASCSE02$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
						            when type = 2
						            then (select count(seq) from BGAB_GASCSE03$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
						            when type = 3
						            then (select count(seq) from BGAB_GASCSE04$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
						            when type = 4
						            then (select count(seq) from BGAB_GASCSE05$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
						            when type = 5
						            then (select count(seq) from BGAB_GASCSE07$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
						        end as num_req
						  from BGAB_GASCSE01$corp_cd$ a
						  left outer join(
								select xcod_code, xcod_hname
								  from bgab_gascz005$corp_cd$
								 where xcod_knd = 'X0030'
								   and locale = #locale#
								 ) b
							on b.xcod_code = a.pgs_st_cd
						  left outer join(
								select xcod_code, xcod_hname
								  from bgab_gascz005$corp_cd$
								 where xcod_knd = 'X3001'
								   and locale = #locale#
								 ) c
							on c.xcod_code = a.type
						  left outer join BGAB_GASCZ002$corp_cd$ usr
						    on a.eeno = usr.xusr_empno
						  join BGAB_GASCSE04$corp_cd$ T1
						    on a.doc_no = T1.doc_no
						 where 1=1
						   and (#key_from_date# between day1 and day2 
						       or #key_to_date# between day1 and day2 
						       or day1 between #key_from_date# and #key_to_date# 
						       or day2  between #key_from_date# and #key_to_date# )
						   <isNotEmpty property="key_eenm">
						   and CARRIER LIKE CONCAT('%', #key_eenm#, '%')
						   </isNotEmpty>
						   <isNotEmpty property="ops_cd">
						   and usr.xusr_dept_code = #ops_cd#
						   </isNotEmpty>
						   <isNotEmpty property="pgs_st_cd">
						   and a.pgs_st_cd = #pgs_st_cd#
						   </isNotEmpty>
						   <isNotEmpty property="work_area">
						   and usr.xusr_plac_work = #work_area#
						   </isNotEmpty>
						   <isNotEmpty property="type">
						   and a.type = #type#
						   </isNotEmpty>
						   order by od_dt desc, doc_no desc
						) m,
						(SELECT @ROWNUM := 0) r
					) k
			) z
		WHERE rnum between #startRow# AND #endRow#	
	</select>
	
	<select id="selectCountSecurityRequestListType4" parameterClass="bgabGascse01" resultClass="String">
		/* selectCountSecurityRequestListType4 */
		select count(*)
		  from (
				select DISTINCT REPLACE(a.apply_date,'/','') AS apply_date
					 , REPLACE(a.apply_date,'/','') AS od_dt
					 , a.eeno
					 , PHOTOGRAPHER as ee_nm
					 , usr.xusr_step_code as step_code
					 , usr.xusr_step_name as step_name
					 , usr.xusr_dept_code as ops_cd
					 , usr.xusr_dept_name as ops_nm
					 , a.type
					 , c.xcod_hname as type_nm
					 , a.pgs_st_cd
				     , b.xcod_hname as pgs_st_nm
				     , a.doc_no
				     , case when type = 1
				            then (select count(seq) from BGAB_GASCSE02$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
				            when type = 2
				            then (select count(seq) from BGAB_GASCSE03$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
				            when type = 3
				            then (select count(seq) from BGAB_GASCSE04$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
				            when type = 4
				            then (select count(seq) from BGAB_GASCSE05$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
				            when type = 5
				            then (select count(seq) from BGAB_GASCSE07$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
				        end as num_req
				  from BGAB_GASCSE01$corp_cd$ a
				  left outer join(
						select xcod_code, xcod_hname
						  from bgab_gascz005$corp_cd$
						 where xcod_knd = 'X0030'
						   and locale = #locale#
						 ) b
					on b.xcod_code = a.pgs_st_cd
				  left outer join(
						select xcod_code, xcod_hname
						  from bgab_gascz005$corp_cd$
						 where xcod_knd = 'X3001'
						   and locale = #locale#
						 ) c
					on c.xcod_code = a.type
				  left outer join BGAB_GASCZ002$corp_cd$ usr
				    on a.eeno = usr.xusr_empno
				  join BGAB_GASCSE05$corp_cd$ T1
				    on a.doc_no = T1.doc_no
				 where 1=1
				   and (#key_from_date# between day1 and day2 
					       or #key_to_date# between day1 and day2 
					       or day1 between #key_from_date# and #key_to_date# 
					       or day2  between #key_from_date# and #key_to_date# )
				   <isNotEmpty property="key_eenm">
				   and CARRIER LIKE CONCAT('%', #key_eenm#, '%')
				   </isNotEmpty>
				   <isNotEmpty property="ops_cd">
				   and usr.xusr_dept_code = #ops_cd#
				   </isNotEmpty>
				   <isNotEmpty property="pgs_st_cd">
				   and a.pgs_st_cd = #pgs_st_cd#
				   </isNotEmpty>
				   <isNotEmpty property="work_area">
				   and usr.xusr_plac_work = #work_area#
				   </isNotEmpty>
				   <isNotEmpty property="type">
				   and a.type = #type#
				   </isNotEmpty>
			) k
	</select>
	
	<select id="getSelectSecurityRequestListType4" parameterClass="bgabGascse01" resultClass="bgabGascse01">
		/* getSelectSecurityRequestListType4 */
		select * 
		  from (
				select k.*, m.rnum
				  from (
				  	select @ROWNUM := @ROWNUM + 1 AS rnum
				  		 , m.*
				  	from
				  	(
						select DISTINCT REPLACE(a.apply_date,'/','') AS apply_date
							 , REPLACE(a.apply_date,'/','') AS od_dt
							 , a.eeno
							 , T1.day1 as start_ymd
							 , T1.day2 as end_ymd
							 , T1.PHOTOGRAPHER as ee_nm
							 , T1.COMPANY
							 , T1.BRAND
							 , usr.xusr_step_code as step_code
							 , usr.xusr_step_name as step_name
							 , usr.xusr_dept_code as ops_cd
							 , usr.xusr_dept_name as ops_nm
							 , a.type
							 , c.xcod_hname as type_nm
							 , a.pgs_st_cd
						     , b.xcod_hname as pgs_st_nm
						     , a.doc_no
						     , case when type = 1
						            then (select count(seq) from BGAB_GASCSE02$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
						            when type = 2
						            then (select count(seq) from BGAB_GASCSE03$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
						            when type = 3
						            then (select count(seq) from BGAB_GASCSE04$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
						            when type = 4
						            then (select count(seq) from BGAB_GASCSE05$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
						            when type = 5
						            then (select count(seq) from BGAB_GASCSE07$corp_cd$ where eeno = a.eeno and apply_date = a.apply_date and doc_no = a.doc_no)
						        end as num_req
						  from BGAB_GASCSE01$corp_cd$ a
						  left outer join(
								select xcod_code, xcod_hname
								  from bgab_gascz005$corp_cd$
								 where xcod_knd = 'X0030'
								   and locale = #locale#
								 ) b
							on b.xcod_code = a.pgs_st_cd
						  left outer join(
								select xcod_code, xcod_hname
								  from bgab_gascz005$corp_cd$
								 where xcod_knd = 'X3001'
								   and locale = #locale#
								 ) c
							on c.xcod_code = a.type
						  left outer join BGAB_GASCZ002$corp_cd$ usr
						    on a.eeno = usr.xusr_empno
						  join BGAB_GASCSE05$corp_cd$ T1
						    on a.doc_no = T1.doc_no
						 where 1=1
						   and (#key_from_date# between day1 and day2 
						       or #key_to_date# between day1 and day2 
						       or day1 between #key_from_date# and #key_to_date# 
						       or day2  between #key_from_date# and #key_to_date# )
						   <isNotEmpty property="key_eenm">
						   and PHOTOGRAPHER LIKE CONCAT('%', #key_eenm#, '%')
						   </isNotEmpty>
						   <isNotEmpty property="ops_cd">
						   and usr.xusr_dept_code = #ops_cd#
						   </isNotEmpty>
						   <isNotEmpty property="pgs_st_cd">
						   and a.pgs_st_cd = #pgs_st_cd#
						   </isNotEmpty>
						   <isNotEmpty property="work_area">
						   and usr.xusr_plac_work = #work_area#
						   </isNotEmpty>
						   <isNotEmpty property="type">
						   and a.type = #type#
						   </isNotEmpty>
						   order by od_dt desc, doc_no desc
						) m,
						(SELECT @ROWNUM := 0) r
					) k
			) z
		WHERE rnum between #startRow# AND #endRow#	
	</select>
</sqlMap>