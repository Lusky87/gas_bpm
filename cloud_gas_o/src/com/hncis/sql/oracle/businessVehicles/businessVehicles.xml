<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE sqlMap
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="BusinessVehicles">
	<select id="selectCountBvToVehicleListForDept" parameterClass="bgabGascbv01Dto" resultClass="String">
		/*selectCountBvToVehicleList*/
		SELECT COUNT(*) AS tot_cnt
		FROM BGAB_GASCBV01$corp_cd$
		WHERE  1 = 1
		<isNotEmpty property="dcd" prepend="and">
			DCD = #dcd#
		</isNotEmpty>
		<isNotEmpty property="car_no" prepend="and">
			CAR_NO = #car_no#
		</isNotEmpty>
		<isNotEmpty property="regn_cd" prepend="and">
			REGN_CD = #regn_cd#
		</isNotEmpty>
	</select>
	<select id="selectListBvToVehicleListForDept" parameterClass="bgabGascbv01Dto" resultClass="bgabGascbv01Dto">
		/*selectListBvToVehicleListForDept*/
		SELECT *
		FROM
		(
			SELECT rownum rnum, X.*
			FROM
			(
				SELECT 	A.CHSS_NO
						,B.XCOD_HNAME AS VEHL_CD
						,C.XCOD_HNAME AS CAR_TYPE_CD
						,D.XCOD_HNAME AS CAR_TYPE_EN
						,A.DCD
						,A.CAR_NO
						,A.RGST_NO
						,A.INSU_NO
						,NVL((SELECT MAX(VL01.FNH_TRVG_DIST) FROM BGAB_GASCVL01$corp_cd$ VL01 WHERE VL01.CHSS_NO = A.CHSS_NO),0) AS TRVG_DIST
				FROM 	BGAB_GASCBV01$corp_cd$ A
				LEFT OUTER JOIN
				(
					SELECT * FROM BGAB_GASCZ005$corp_cd$ WHERE XCOD_KND = 'XBV01' AND LOCALE = #locale#
				) B
				ON A.VEHL_CD = B.XCOD_CODE
				LEFT OUTER JOIN
				(
					SELECT * FROM BGAB_GASCZ005$corp_cd$ WHERE XCOD_KND = 'XBV07' AND LOCALE = #locale#
				) C
				ON A.CAR_TYPE_CD = C.XCOD_CODE
				LEFT OUTER JOIN
				(
					SELECT * FROM BGAB_GASCZ005$corp_cd$ WHERE XCOD_KND = 'XBV08' AND LOCALE = #locale#
				) D
				ON A.CAR_TYPE_EN = D.XCOD_CODE
				WHERE	1 = 1
				<isNotEmpty property="dcd" prepend="and">
					DCD = #dcd#
				</isNotEmpty>
				<isNotEmpty property="car_no" prepend="and">
					CAR_NO LIKE '%' || #car_no# || '%'
				</isNotEmpty>
				<isNotEmpty property="regn_cd" prepend="and">
					REGN_CD = #regn_cd#
				</isNotEmpty>
				ORDER BY CHSS_NO ASC
			)X
		)K
		WHERE K.rnum BETWEEN #startRow# AND #endRow#
	</select>


	<update id="insertBvToRequest" parameterClass="bgabGascbv02Dto">
     /*insertBvToRequest*/
     MERGE INTO BGAB_GASCBV02$corp_cd$
		USING DUAL
		ON( DOC_NO = #doc_no#)
		WHEN MATCHED THEN
			UPDATE SET
				CHSS_NO             = #chss_no#,
				DRVR_EENO           = #drvr_eeno#,
				STRT_YMD            = TO_DATE(#strt_ymd#, 'YYYYMMDD'),
				STRT_TIM            = #strt_tim#,
				FNH_YMD             = TO_DATE(#fnh_ymd#, 'YYYYMMDD'),
				FNH_TIM             = #fnh_tim#,
				CRO_PURP_CD         = #cro_purp_cd#,
				ARVP_NM             = #arvp_nm#,
				KOIL_CRD_USE_YN     = #koil_crd_use_yn#,
				USE_AMT             = #use_amt#,
				STRT_TRVG_DIST      = #strt_trvg_dist#,
				FNH_TRVG_DIST       = #fnh_trvg_dist#,
				REM_SBC             = #rem_sbc#,
				UPDR_EENO        	= #updr_eeno#,
				MDFY_YMD 			= SYSDATE
		WHEN NOT MATCHED THEN
			INSERT(
				DOC_NO
				,EENO
				,PTT_YMD
				,CHSS_NO
				,DRVR_EENO
				,STRT_YMD
				,STRT_TIM
				,FNH_YMD
				,FNH_TIM
				,CRO_PURP_CD
				,ARVP_NM
				,KOIL_CRD_USE_YN
				,USE_AMT
				,STRT_TRVG_DIST
				,FNH_TRVG_DIST
				,REM_SBC
				,PGS_ST_CD
				,INP_YMD
				,IPE_EENO
				,MDFY_YMD
				,UPDR_EENO
      		)values(
      			#doc_no#
	            ,#eeno#
	            ,TO_DATE(#ptt_ymd#, 'YYYYMMDD')
	            ,#chss_no#
	            ,#drvr_eeno#
	            ,TO_DATE(#strt_ymd#, 'YYYYMMDD')
	            ,#strt_tim#
	            ,TO_DATE(#fnh_ymd#, 'YYYYMMDD')
	            ,#fnh_tim#
	            ,#cro_purp_cd#
	            ,#arvp_nm#
	            ,#koil_crd_use_yn#
	            ,#use_amt#
	            ,#strt_trvg_dist#
	            ,#fnh_trvg_dist#
	            ,#rem_sbc#
				,#pgs_st_cd#
				,SYSDATE
				,#ipe_eeno#
				,SYSDATE
				,#updr_eeno#
			)
   </update>

   <select id="selectInfoBvToRequest" parameterClass="bgabGascbv02Dto" resultClass="bgabGascbv02Dto">
		/*selectInfoBvToRequest*/
		SELECT 	A.DOC_NO
				,A.EENO
				,B.XUSR_NAME AS EENO_NM
				,B.XUSR_DEPT_NAME AS DEPT_NM
				,B.XUSR_STEP_NAME AS POS_NM
				,B.XUSR_TEL_NO    AS TEL_NO
				,TO_CHAR( A.PTT_YMD,'YYYY-MM-DD' ) AS PTT_YMD
				,A.CHSS_NO
				,E.CAR_NO
				,A.DRVR_EENO
				,D.XUSR_NAME AS DRVR_EENO_NM
				,TO_CHAR( A.STRT_YMD,'YYYY-MM-DD' ) AS STRT_YMD
				,SUBSTR(A.STRT_TIM,1,2) || ':' || SUBSTR(A.STRT_TIM,3,2) AS STRT_TIM
				,TO_CHAR( A.FNH_YMD,'YYYY-MM-DD' ) AS FNH_YMD
				,SUBSTR(A.FNH_TIM,1,2) || ':' || SUBSTR(A.FNH_TIM,3,2) AS FNH_TIM
				,A.CRO_PURP_CD
				,A.ARVP_NM
				,A.KOIL_CRD_USE_YN
				,A.USE_AMT
				,A.STRT_TRVG_DIST
				,A.FNH_TRVG_DIST
				,A.REM_SBC
				,A.SNB_RSON_SBC
				,A.IF_ID
				,A.PGS_ST_CD
				,C.XCOD_HNAME AS PGS_ST_CD_D
				,A.RDCS_EENO
				,A.RDCS_YMD
				,A.ACPC_EENO
				,A.ACPC_YMD
				,A.RPTS_EENO
				,A.RPTS_YMD
				,A.INP_YMD
				,A.IPE_EENO
				,A.MDFY_YMD
				,A.UPDR_EENO
				,F.XCOD_HNAME AS VEHL_CD
				,H.XCOD_HNAME || ' ' || G.XCOD_HNAME AS CAR_TYPE_CD
			FROM BGAB_GASCBV02$corp_cd$ A
			LEFT OUTER JOIN BGAB_GASCZ002$corp_cd$ B
			ON A.EENO = B.XUSR_EMPNO
			LEFT OUTER JOIN
			(
				SELECT * FROM BGAB_GASCZ005$corp_cd$ WHERE XCOD_KND='X0001' AND LOCALE = #locale#
			) C
			ON A.PGS_ST_CD = C.XCOD_CODE
			LEFT OUTER JOIN BGAB_GASCZ002$corp_cd$ D
			ON A.DRVR_EENO = D.XUSR_EMPNO
			LEFT OUTER JOIN BGAB_GASCBV01$corp_cd$ E
			ON A.CHSS_NO = E.CHSS_NO
			LEFT OUTER JOIN
			(
				SELECT * FROM BGAB_GASCZ005$corp_cd$ WHERE XCOD_KND='XBV01' AND LOCALE = #locale#
			) F
			ON E.VEHL_CD = F.XCOD_CODE
			LEFT OUTER JOIN
			(
				SELECT * FROM BGAB_GASCZ005$corp_cd$ WHERE XCOD_KND='XBV07' AND LOCALE = #locale#
			) G
			ON E.CAR_TYPE_CD = G.XCOD_CODE
			LEFT OUTER JOIN
			(
				SELECT * FROM BGAB_GASCZ005$corp_cd$ WHERE XCOD_KND='XBV08' AND LOCALE = #locale#
			) H
			ON E.CAR_TYPE_EN = H.XCOD_CODE
			WHERE A.DOC_NO = #doc_no#
	</select>


   <delete id="deleteBvToRequest" parameterClass="bgabGascbv02Dto">
   		DELETE	FROM BGAB_GASCBV02$corp_cd$
   		WHERE	1 = 1
   		AND		DOC_NO = #doc_no#
   </delete>
	<update id="updateInfoBvToConfirm" parameterClass="bgabGascbv02Dto">
   		UPDATE	BGAB_GASCBV02$corp_cd$
		set		PGS_ST_CD = #pgs_st_cd#,
				ACPC_EENO = #acpc_eeno#,
				ACPC_YMD = SYSDATE,
				CHSS_NO             = #chss_no#,
				DRVR_EENO           = #drvr_eeno#,
				STRT_YMD            = TO_DATE(#strt_ymd#, 'YYYYMMDD'),
				STRT_TIM            = #strt_tim#,
				FNH_YMD             = TO_DATE(#fnh_ymd#, 'YYYYMMDD'),
				FNH_TIM             = #fnh_tim#,
				CRO_PURP_CD         = #cro_purp_cd#,
				ARVP_NM             = #arvp_nm#,
				KOIL_CRD_USE_YN     = #koil_crd_use_yn#,
				USE_AMT             = #use_amt#,
				STRT_TRVG_DIST      = #strt_trvg_dist#,
				FNH_TRVG_DIST       = #fnh_trvg_dist#,
				REM_SBC             = #rem_sbc#
		WHERE	1 = 1
		AND		DOC_NO = #doc_no#

   </update>

   <update id="updateInfoBvToConfirmcancel" parameterClass="bgabGascbv02Dto">
   		UPDATE	BGAB_GASCBV02$corp_cd$
		SET 	PGS_ST_CD  = #pgs_st_cd#
				,IF_ID     = ''
				,RPTS_EENO = ''
				,RPTS_YMD  = ''
				,RDCS_EENO = ''
				,RDCS_YMD  = ''
				,ACPC_EENO = ''
				,ACPC_YMD  = ''
				,SNB_RSON_SBC = #snb_rson_sbc#
				,UPDR_EENO = #updr_eeno#
				,MDFY_YMD  = SYSDATE
		WHERE	1 = 1
		AND		DOC_NO = #doc_no#
   </update>
   <update id="updateInfoBvToApproval" parameterClass="bgabGascbv02Dto">
   		UPDATE	BGAB_GASCBV02$corp_cd$
		SET		PGS_ST_CD = #pgs_st_cd#,
				IF_ID = #if_id#,
				RPTS_EENO = #rpts_eeno#,
				RPTS_YMD = SYSDATE,
				SNB_RSON_SBC = ''
		WHERE	1 = 1
		AND		DOC_NO = #doc_no#

   </update>
   <select id="selectApprovalInfoByBv" parameterClass="bgabGascbv02Dto" resultClass="String">
		/*selectApprovalInfoByEm*/
		SELECT
		CASE
		  WHEN (f.xusr_name = '' OR f.xusr_name IS null)
		    THEN ' '
		  ELSE
		    'P.I.C'
		END
         + '@' + NVL(f.xusr_name,'')
		 + '@' + NVL(f.xusr_step_name,'')
		 + '@' + CASE WHEN (a.acpc_ymd IS NULL OR a.acpc_ymd = '') THEN ' '
		         ELSE  TO_CHAR( a.acpc_ymd,'YYYY-MM-DD' ) END
		 + '|'
		 + CASE
		     WHEN b.xusr_cnfm_auth = '2'
			   THEN
			     CASE
				   WHEN (b.xusr_name = '' OR b.xusr_name IS null)
				     THEN ' '
				   ELSE
				     CASE
					   WHEN g.xorg_rsps_crank = '24' THEN 'H.O.T'
					   ELSE 'Planner'
					 END
				 END
			 ELSE
			    CASE
				  WHEN (b.xusr_name = '' OR b.xusr_name IS null) THEN ' '
				  ELSE 'Planner'
			    END
		   END
		 + '@' + NVL(b.xusr_name,'')
		 + '@' + NVL(b.xusr_step_name,'')
		 + '@' + CASE WHEN (a.rpts_ymd IS NULL OR a.rpts_ymd = '') THEN ' '
		 		 ELSE TO_CHAR( a.rpts_ymd,'YYYY-MM-DD' ) END
		 + '|'
		 + CASE
		     WHEN d.xusr_cnfm_auth = '2'
			   THEN
			     CASE
				   WHEN (d.xusr_name = '' OR d.xusr_name IS NULL)
				     THEN ' '
				   ELSE
				     CASE
					   WHEN h.xorg_rsps_crank = '24' THEN 'H.O.T'
					   ELSE 'Planner'
					 END
				 END
		     ELSE
			   CASE WHEN (d.xusr_name = '' OR d.xusr_name IS NULL) THEN ' '
			   ELSE 'Staff'
			   END
		   END
		 + '@' + NVL(d.xusr_name, '')
		 + '@' + NVL(d.xusr_step_name, '')
		 + '@' + CASE WHEN (a.rdcs_ymd IS NULL OR a.rdcs_ymd = '') THEN ' '
		         ELSE TO_CHAR( a.rdcs_ymd,'YYYY-MM-DD' ) END
		FROM	BGAB_GASCBV02$corp_cd$ a
		LEFT OUTER JOIN BGAB_GASCZ002$corp_cd$ b
		ON a.ipe_eeno       = b.xusr_empno
		LEFT OUTER JOIN BGAB_GASCZ009$corp_cd$ bb

		ON a.if_id = bb.if_id
		LEFT OUTER JOIN BGAB_GASCZ002$corp_cd$ d
		ON bb.rdcs_eeno      = d.xusr_empno
		LEFT OUTER JOIN BGAB_GASCZ002$corp_cd$ f
		ON a.acpc_eeno      = f.xusr_empno
		LEFT OUTER JOIN BGAB_GASCZ003$corp_cd$ g
		ON b.xusr_dept_code = g.xorg_orga_c
		LEFT OUTER JOIN BGAB_GASCZ003$corp_cd$ h
		ON d.xusr_dept_code = h.xorg_orga_c
		LEFT OUTER JOIN BGAB_GASCZ003$corp_cd$ i
		ON f.xusr_dept_code = i.xorg_orga_c
		WHERE a.if_id          = #if_id#
	</select>

	 <select id="selectInfoBvToRequestForApprove" parameterClass="bgabGascbv02Dto" resultClass="bgabGascbv02Dto">
		/*selectInfoBvToRequestForApprove*/
		SELECT 	A.DOC_NO
				,A.EENO
				,B.XUSR_NAME AS EENO_NM
				,B.XUSR_DEPT_NAME AS DEPT_NM
				,B.XUSR_STEP_NAME AS POS_NM
				,B.XUSR_TEL_NO    AS TEL_NO
				,TO_CHAR( A.PTT_YMD,'YYYY-MM-DD' ) AS PTT_YMD
				,A.CHSS_NO
				,E.CAR_NO
				,A.DRVR_EENO
				,D.XUSR_NAME AS DRVR_EENO_NM
				,TO_CHAR( A.STRT_YMD,'YYYY-MM-DD' ) AS STRT_YMD
				,SUBSTR(A.STRT_TIM,1,2) || ':' || SUBSTR(A.STRT_TIM,3,2) AS STRT_TIM
				,TO_CHAR( A.FNH_YMD,'YYYY-MM-DD' ) AS FNH_YMD
				,SUBSTR(A.FNH_TIM,1,2) || ':' || SUBSTR(A.FNH_TIM,3,2) AS FNH_TIM
				,A.CRO_PURP_CD
				,A.ARVP_NM
				,A.KOIL_CRD_USE_YN
				,A.USE_AMT
				,A.STRT_TRVG_DIST
				,A.FNH_TRVG_DIST
				,A.REM_SBC
				,A.SNB_RSON_SBC
				,A.IF_ID
				,A.PGS_ST_CD
				,C.XCOD_HNAME AS PGS_ST_CD_D
				,A.RDCS_EENO
				,A.RDCS_YMD
				,A.ACPC_EENO
				,A.ACPC_YMD
				,A.RPTS_EENO
				,A.RPTS_YMD
				,A.INP_YMD
				,A.IPE_EENO
				,A.MDFY_YMD
				,A.UPDR_EENO
				,F.XCOD_HNAME AS VEHL_CD
				,G.XCOD_HNAME AS CAR_TYPE_CD
			FROM BGAB_GASCBV02$corp_cd$ A
			LEFT OUTER JOIN BGAB_GASCZ002$corp_cd$ B
			ON A.EENO = B.XUSR_EMPNO
			LEFT OUTER JOIN
			(
				SELECT * FROM BGAB_GASCZ005$corp_cd$ WHERE XCOD_KND='X0001' AND LOCALE = #locale#
			) C
			ON A.PGS_ST_CD = C.XCOD_CODE
			LEFT OUTER JOIN BGAB_GASCZ002$corp_cd$ D
			ON A.DRVR_EENO = D.XUSR_EMPNO
			LEFT OUTER JOIN BGAB_GASCBV01$corp_cd$ E
			ON A.CHSS_NO = E.CHSS_NO
			LEFT OUTER JOIN
			(
				SELECT * FROM BGAB_GASCZ005$corp_cd$ WHERE XCOD_KND='XBV01' AND LOCALE = #locale#
			) F
			ON E.VEHL_CD = F.XCOD_CODE
			LEFT OUTER JOIN
			(
				SELECT * FROM BGAB_GASCZ005$corp_cd$ WHERE XCOD_KND='XBV02' AND LOCALE = #locale#
			) G
			ON E.CAR_TYPE_CD = G.XCOD_CODE
			WHERE A.IF_ID = #if_id#
	</select>

   <select id="selectCountBvToList" parameterClass="bgabGascbv02Dto" resultClass="String">
		/*selectCountBvToList*/
		SELECT COUNT(*) AS tot_cnt
		FROM BGAB_GASCBV02$corp_cd$ A
		LEFT OUTER JOIN BGAB_GASCBV01$corp_cd$ B
		ON A.CHSS_NO = B.CHSS_NO
		LEFT OUTER JOIN BGAB_GASCZ002$corp_cd$ C
		ON A.EENO = C.XUSR_EMPNO
		LEFT OUTER JOIN BGAB_GASCZ002$corp_cd$ E
		ON A.DRVR_EENO = E.XUSR_EMPNO
		WHERE   TO_CHAR(A.PTT_YMD, 'YYYYMMDD') BETWEEN #from_ymd# and #to_ymd#
		<isNotEmpty property="eeno" prepend="and">
			A.EENO = #eeno#
		</isNotEmpty>
		<isNotEmpty property="eeno_nm" prepend="and">
			C.XUSR_NAME LIKE '%' || #eeno_nm# || '%'
		</isNotEmpty>
		<isNotEmpty property="dept_cd" prepend="and">
			C.XUSR_DEPT_CODE = #dept_cd#
		</isNotEmpty>
		<isNotEmpty property="car_no" prepend="and">
			B.CAR_NO LIKE '%' || #car_no# || '%'
		</isNotEmpty>
		<isNotEmpty property="drvr_eeno" prepend="and">
			A.DRVR_EENO = #drvr_eeno#
		</isNotEmpty>
		<isNotEmpty property="drvr_eeno_nm" prepend="and">
			E.XUSR_NAME LIKE '%' || #drvr_eeno_nm# || '%'
		</isNotEmpty>
		<isNotEmpty property="pgs_st_cd" prepend="and">
			A.PGS_ST_CD = #pgs_st_cd#
		</isNotEmpty>
		<isNotEmpty property="regn_cd" prepend="and">
			C.XUSR_PLAC_WORK = #regn_cd#
		</isNotEmpty>
	</select>

	<select id="selectListBvToList" parameterClass="bgabGascbv02Dto" resultClass="bgabGascbv02Dto">
		/*selectListBvToList*/
		SELECT *
		FROM
		(
			SELECT rownum rnum, X.*
			FROM
			(
				SELECT 	A.DOC_NO
						,A.EENO
						,C.XUSR_NAME AS EENO_NM
						,C.XUSR_DEPT_NAME AS DEPT_NM
						,TO_CHAR( A.PTT_YMD,'YYYY-MM-DD' ) AS PTT_YMD
						,A.CHSS_NO
						,B.CAR_NO
						,A.DRVR_EENO
						,E.XUSR_NAME AS DRVR_EENO_NM
						,TO_CHAR( A.STRT_YMD,'YYYY-MM-DD' ) AS STRT_YMD
						,SUBSTR(A.STRT_TIM,1,2) || ':' || SUBSTR(A.STRT_TIM,3,2) AS STRT_TIM
						,TO_CHAR( A.FNH_YMD,'YYYY-MM-DD' ) AS FNH_YMD
						,SUBSTR(A.FNH_TIM,1,2) || ':' || SUBSTR(A.FNH_TIM,3,2) AS FNH_TIM
						,A.CRO_PURP_CD
						,A.ARVP_NM
						,A.KOIL_CRD_USE_YN
						,A.USE_AMT
						,A.STRT_TRVG_DIST
						,A.FNH_TRVG_DIST
						,A.REM_SBC
						,A.SNB_RSON_SBC
						,A.IF_ID
						,A.PGS_ST_CD
						,D.XCOD_HNAME AS PGS_ST_CD_D
						,A.RDCS_EENO
						,A.RDCS_YMD
						,A.ACPC_EENO
						,A.ACPC_YMD
						,A.RPTS_EENO
						,A.RPTS_YMD
						,A.INP_YMD
						,A.IPE_EENO
						,A.MDFY_YMD
						,A.UPDR_EENO
				FROM BGAB_GASCBV02$corp_cd$ A
				LEFT OUTER JOIN BGAB_GASCBV01$corp_cd$ B
				ON A.CHSS_NO = B.CHSS_NO
				LEFT OUTER JOIN BGAB_GASCZ002$corp_cd$ C
				ON A.EENO = C.XUSR_EMPNO
				LEFT OUTER JOIN
				(
					SELECT * FROM BGAB_GASCZ005$corp_cd$ WHERE XCOD_KND = 'X0001' AND LOCALE = #locale#
				) D
				ON A.PGS_ST_CD = D.XCOD_CODE
				LEFT OUTER JOIN BGAB_GASCZ002$corp_cd$ E
				ON A.DRVR_EENO = E.XUSR_EMPNO
				WHERE   TO_CHAR(A.PTT_YMD, 'YYYYMMDD') BETWEEN #from_ymd# and #to_ymd#
				<isNotEmpty property="eeno" prepend="and">
					A.EENO = #eeno#
				</isNotEmpty>
				<isNotEmpty property="eeno_nm" prepend="and">
					C.XUSR_NAME LIKE '%' || #eeno_nm# || '%'
				</isNotEmpty>
				<isNotEmpty property="dept_cd" prepend="and">
					C.XUSR_DEPT_CODE = #dept_cd#
				</isNotEmpty>
				<isNotEmpty property="car_no" prepend="and">
					B.CAR_NO LIKE '%' || #car_no# || '%'
				</isNotEmpty>
				<isNotEmpty property="drvr_eeno" prepend="and">
					A.DRVR_EENO = #drvr_eeno#
				</isNotEmpty>
				<isNotEmpty property="drvr_eeno_nm" prepend="and">
					E.XUSR_NAME LIKE '%' || #drvr_eeno_nm# || '%'
				</isNotEmpty>
				<isNotEmpty property="pgs_st_cd" prepend="and">
					A.PGS_ST_CD = #pgs_st_cd#
				</isNotEmpty>
				<isNotEmpty property="regn_cd" prepend="and">
					C.XUSR_PLAC_WORK = #regn_cd#
				</isNotEmpty>
				ORDER BY A.PTT_YMD DESC
				       , A.STRT_YMD DESC
				       , A.STRT_TIM DESC
				       , A.FNH_YMD DESC
				       , A.FNH_TIM DESC
			)X
		)K
		WHERE rnum BETWEEN #startRow# AND #endRow#
	</select>

 	<select id="selectCountBvToVehicleManagement" parameterClass="bgabGascbv01Dto" resultClass="String">
		/*selectCountBvToVehicleManagement*/
		SELECT COUNT(*) AS tot_cnt
		FROM BGAB_GASCBV01$corp_cd$
		WHERE   CHSS_NO = #chss_no#
	</select>

	<update id="insertBvToVehicleManagement" parameterClass="bgabGascbv01Dto">
     /*insertBvToVehicleManagement*/
     MERGE INTO BGAB_GASCBV01$corp_cd$
		USING DUAL
		ON( CHSS_NO=#chss_no#)
		WHEN MATCHED THEN
			UPDATE SET
				VEHL_CD                  = #vehl_cd#
				,VEHL_COLR                = #vehl_colr#
				,CAR_TYPE_CD              = #car_type_cd#
				,CAR_TYPE_EN			  = #car_type_en#
				,KOIL_CRD                 = #koil_crd#
				,BULLT_PRF_YN             = #bullt_prf_yn#
				,DCD                      = #dcd#
				,CRGR_EENO				  = #crgr_eeno#
				,COST_CD                  = #cost_cd#
				,REGN_CD                  = #regn_cd#
				,USF_SCN_CD               = #usf_scn_cd#
				,ASST_RGS_YMD             = TO_DATE(#asst_rgs_ymd#, 'YYYYMMDD')
				,CAR_NO                   = #car_no#
				,CAR_NO_VLD_TRM_STRT_YMD  = TO_DATE(#car_no_vld_trm_strt_ymd#, 'YYYYMMDD')
				,CAR_NO_VLD_TRM_FNH_YMD   = TO_DATE(#car_no_vld_trm_fnh_ymd#, 'YYYYMMDD')
				,RGST_NO                  = #rgst_no#
				,RGST_NO_VLD_TRM_STRT_YMD = TO_DATE(#rgst_no_vld_trm_strt_ymd#, 'YYYYMMDD')
				,RGST_NO_VLD_TRM_FNH_YMD  = TO_DATE(#rgst_no_vld_trm_fnh_ymd#, 'YYYYMMDD')
				,INSU_NO                  = #insu_no#
				,INSU_NO_VLD_TRM_STRT_YMD = TO_DATE(#insu_no_vld_trm_strt_ymd#, 'YYYY')
				,INSU_NO_VLD_TRM_FNH_YMD  = TO_DATE(#insu_no_vld_trm_fnh_ymd#, 'YYYY')
				,APL_STRT_TRVG_DIST       = #apl_strt_trvg_dist_dbl#
				,TRBL_STTS_SBC            = #trbl_stts_sbc#
				,CEQ_BKGD_SBC             = #ceq_bkgd_sbc#
				,PNLT_SBC				  = #pnlt_sbc#
				,BULLT_PRF_SBC			  = #bullt_prf_sbc#
				,REM_SBC                  = #rem_sbc#
				,UPDR_EENO        		  = #updr_eeno#
				,MDFY_YMD 				  = SYSDATE
				,DELI_YMD				  = TO_DATE(#deli_ymd#, 'YYYYMMDD')
				,FUEL_TYPE_CD			  = #fuel_type_cd#
		WHEN NOT MATCHED THEN
			INSERT(
				CHSS_NO
				,VEHL_CD
				,VEHL_COLR
				,CAR_TYPE_CD
				,CAR_TYPE_EN
				,KOIL_CRD
				,BULLT_PRF_YN
				,DCD
				,COST_CD
				,CRGR_EENO
				,REGN_CD
				,USF_SCN_CD
				,ASST_RGS_YMD
				,CAR_NO
				,CAR_NO_VLD_TRM_STRT_YMD
				,CAR_NO_VLD_TRM_FNH_YMD
				,RGST_NO
				,RGST_NO_VLD_TRM_STRT_YMD
				,RGST_NO_VLD_TRM_FNH_YMD
				,INSU_NO
				,INSU_NO_VLD_TRM_STRT_YMD
				,INSU_NO_VLD_TRM_FNH_YMD
				,APL_STRT_TRVG_DIST
				,FXT_INS_INFM_NOS
				,TRBL_STTS_SBC
				,CEQ_BKGD_SBC
				,PNLT_SBC
				,BULLT_PRF_SBC
				,REM_SBC
				,INP_YMD
				,IPE_EENO
				,MDFY_YMD
				,UPDR_EENO
				,DELI_YMD
				,FUEL_TYPE_CD
      		)values(
      			#chss_no#
				,#vehl_cd#
				,#vehl_colr#
				,#car_type_cd#
				,#car_type_en#
				,#koil_crd#
				,#bullt_prf_yn#
				,#dcd#
				,#cost_cd#
				,#crgr_eeno#
				,#regn_cd#
				,#usf_scn_cd#
				,TO_DATE(#asst_rgs_ymd#, 'YYYYMMDD')
				,#car_no#
				,TO_DATE(#car_no_vld_trm_strt_ymd#, 'YYYYMMDD')
				,TO_DATE(#car_no_vld_trm_fnh_ymd#, 'YYYYMMDD')
				,#rgst_no#
				,TO_DATE(#rgst_no_vld_trm_strt_ymd#, 'YYYYMMDD')
				,TO_DATE(#rgst_no_vld_trm_fnh_ymd#, 'YYYYMMDD')
				,#insu_no#
				,TO_DATE(#insu_no_vld_trm_strt_ymd#, 'YYYY')
				,TO_DATE(#insu_no_vld_trm_fnh_ymd#, 'YYYY')
				,#apl_strt_trvg_dist_dbl#
				,0
				,#trbl_stts_sbc#
				,#ceq_bkgd_sbc#
				,#pnlt_sbc#
				,#bullt_prf_sbc#
				,#rem_sbc#
				,SYSDATE
				,#ipe_eeno#
				,SYSDATE
				,#updr_eeno#
				,TO_DATE(#deli_ymd#, 'YYYYMMDD')
				,#fuel_type_cd#
			)
   </update>
	<select id="selectInfoBvToVehicleManagement" parameterClass="bgabGascbv01Dto" resultClass="bgabGascbv01Dto">
		/*selectInfoBvToVehicleManagement*/
		SELECT	X.CHSS_NO
				,X.CHSS_NO_H
				,X.VEHL_CD
				,X.VEHL_COLR
				,X.CAR_TYPE_CD
				,X.CAR_TYPE_EN
				,X.KOIL_CRD
				,X.BULLT_PRF_YN
				,X.DCD
				,X.DCD_NM
				,X.COST_CD
				,X.CRGR_EENO
				,X.CRGR_EENO_NM
				,X.REGN_CD
				,X.USF_SCN_CD
				,X.ASST_RGS_YMD
				,X.CAR_NO
				,X.CAR_NO_VLD_TRM_STRT_YMD
				,X.CAR_NO_VLD_TRM_FNH_YMD
				,X.RGST_NO
				,X.RGST_NO_VLD_TRM_STRT_YMD
				,X.RGST_NO_VLD_TRM_FNH_YMD
				,X.INSU_NO
				,TO_CHAR(X.INSU_NO_VLD_TRM_STRT_YMD,'YYYY') as INSU_NO_VLD_TRM_STRT_YMD
				,TO_CHAR(X.INSU_NO_VLD_TRM_FNH_YMD,'YYYY') as INSU_NO_VLD_TRM_FNH_YMD
				,X.APL_STRT_TRVG_DIST
				,X.TRBL_STTS_SBC
				,X.CEQ_BKGD_SBC
				,X.PNLT_SBC
				,X.BULLT_PRF_SBC
				,X.REM_SBC
				,X.INP_YMD
				,X.IPE_EENO
				,X.MDFY_YMD
				,X.UPDR_EENO
				,X.LST_TRVG_DIST
				,X.AVG_DRY_MLG AS AVG_DRY_MLG
				,X.FILE_CNT FILE_CNT
				,X.DELI_YMD
				,X.FUEL_TYPE_CD
		FROM
		(
			SELECT 	A.CHSS_NO
					,A.CHSS_NO AS CHSS_NO_H
					,A.VEHL_CD
					,A.VEHL_COLR
					,A.CAR_TYPE_CD
					,A.CAR_TYPE_EN
					,A.KOIL_CRD
					,A.BULLT_PRF_YN
					,A.DCD
					,B.XORG_ORGA_E AS DCD_NM
					,A.COST_CD
					,A.CRGR_EENO
					,C.XUSR_NAME AS CRGR_EENO_NM
					,A.REGN_CD
					,A.USF_SCN_CD
					,TO_CHAR( A.ASST_RGS_YMD,'YYYY-MM-DD' ) AS ASST_RGS_YMD
					,A.ASST_RGS_YMD AS ASST_RGS_YMD_H
					,A.CAR_NO
					,TO_CHAR( A.CAR_NO_VLD_TRM_STRT_YMD,'YYYY-MM-DD' ) AS CAR_NO_VLD_TRM_STRT_YMD
					,TO_CHAR( A.CAR_NO_VLD_TRM_FNH_YMD,'YYYY-MM-DD' ) AS CAR_NO_VLD_TRM_FNH_YMD
					,A.RGST_NO
					,TO_CHAR( A.RGST_NO_VLD_TRM_STRT_YMD,'YYYY-MM-DD' ) AS RGST_NO_VLD_TRM_STRT_YMD
					,TO_CHAR( A.RGST_NO_VLD_TRM_FNH_YMD,'YYYY-MM-DD' ) AS RGST_NO_VLD_TRM_FNH_YMD
					,A.INSU_NO
					,A.INSU_NO_VLD_TRM_STRT_YMD AS INSU_NO_VLD_TRM_STRT_YMD
					,A.INSU_NO_VLD_TRM_FNH_YMD AS INSU_NO_VLD_TRM_FNH_YMD
					,A.TRBL_STTS_SBC
					,A.CEQ_BKGD_SBC
					,A.PNLT_SBC
					,A.BULLT_PRF_SBC
					,A.REM_SBC
					,A.INP_YMD
					,A.IPE_EENO
					,A.MDFY_YMD
					,A.UPDR_EENO
					,NVL(D.FNH_TRVG_DIST,0) AS LST_TRVG_DIST
					,NVL(D.AVG_DRY_MLG,0) AS AVG_DRY_MLG
					,NVL(D.AVG_MNTH_AMT,0) AS APL_STRT_TRVG_DIST
					,NVL(E.FILE_CNT,0) AS FILE_CNT
					,TO_CHAR( A.DELI_YMD,'YYYY-MM-DD' ) AS DELI_YMD
					,A.FUEL_TYPE_CD
			FROM 	BGAB_GASCBV01$corp_cd$ A
			LEFT OUTER JOIN BGAB_GASCZ003$corp_cd$ B
			ON A.DCD = B.XORG_ORGA_C
			LEFT OUTER JOIN BGAB_GASCZ002$corp_cd$ C
			ON A.CRGR_EENO = C.XUSR_EMPNO
			LEFT OUTER JOIN
			(
				SELECT 	MAX(CHSS_NO) AS CHSS_NO
						,MAX(FNH_TRVG_DIST) AS FNH_TRVG_DIST
						,SUM(FNH_TRVG_DIST-STRT_TRVG_DIST)/SUM(FNH_YMD - STRT_YMD+1) AS AVG_DRY_MLG
						,SUM(USE_AMT)*30/SUM(FNH_YMD - STRT_YMD +1) AS AVG_MNTH_AMT
				FROM 	BGAB_GASCBV02$corp_cd$
				WHERE	CHSS_NO = #chss_no#
			)D
			ON A.CHSS_NO=D.CHSS_NO
			LEFT OUTER JOIN
			(
				SELECT DOC_NO AS DOC_NO
					   ,COUNT(DOC_NO) AS FILE_CNT
				FROM BGAB_GASCZ011$corp_cd$
				WHERE AFFR_SCN_CD = 'BV'
				GROUP BY DOC_NO
			)  E
			ON A.CHSS_NO = E.DOC_NO
			WHERE 	A.CHSS_NO = #chss_no#
		)X
	</select>
	 <delete id="deleteBvToVehicleManagement" parameterClass="bgabGascbv01Dto">
   		DELETE	BGAB_GASCBV01$corp_cd$
   		WHERE	1 = 1
   		AND 	CHSS_NO = #chss_no#
   </delete>



	<select id="selectCountBvToVehicleList" parameterClass="bgabGascbv01Dto" resultClass="String">
		/*selectCountBvToVehicleList*/
		SELECT COUNT(*)
		FROM (
			SELECT 	A.CHSS_NO
					,B.XCOD_HNAME AS VEHL_CD
					,A.VEHL_COLR
					,C.XCOD_HNAME AS CAR_TYPE_CD
					,H.XCOD_HNAME AS CAR_TYPE_EN
					,A.KOIL_CRD
					,A.BULLT_PRF_YN
					,F.XORG_ORGA_E AS DCD
					,A.CRGR_EENO
					,G.XUSR_NAME AS CRGR_EENO_NM
					,A.COST_CD
					,D.XCOD_HNAME AS REGN_CD
					,E.XCOD_HNAME AS USF_SCN_CD
					,A.ASST_RGS_YMD
					,A.CAR_NO
					,A.CAR_NO_VLD_TRM_STRT_YMD
					,A.CAR_NO_VLD_TRM_FNH_YMD
					,A.RGST_NO
					,A.RGST_NO_VLD_TRM_STRT_YMD
					,A.RGST_NO_VLD_TRM_FNH_YMD
					,A.INSU_NO
					,A.INSU_NO_VLD_TRM_STRT_YMD
					,A.INSU_NO_VLD_TRM_FNH_YMD
					,A.APL_STRT_TRVG_DIST
					,A.TRBL_STTS_SBC
					,A.CEQ_BKGD_SBC
					,A.PNLT_SBC
					,A.BULLT_PRF_SBC
					,A.REM_SBC
					,A.INP_YMD
					,A.IPE_EENO
					,A.MDFY_YMD
					,A.UPDR_EENO
			FROM BGAB_GASCBV01$corp_cd$ A
			LEFT OUTER JOIN
			(
				SELECT * FROM BGAB_GASCZ005$corp_cd$ WHERE XCOD_KND = 'XBV01' AND LOCALE = #locale#
			) B
			ON A.VEHL_CD = B.XCOD_CODE
			LEFT OUTER JOIN
			(
				SELECT * FROM BGAB_GASCZ005$corp_cd$ WHERE XCOD_KND = 'XBV07' AND LOCALE = #locale#
			) C
			ON A.CAR_TYPE_CD = C.XCOD_CODE
			LEFT OUTER JOIN
			(
				SELECT * FROM BGAB_GASCZ005$corp_cd$ WHERE XCOD_KND = 'XBV03' AND LOCALE = #locale#
			) D
			ON A.REGN_CD = D.XCOD_CODE
			LEFT OUTER JOIN
			(
				SELECT * FROM BGAB_GASCZ005$corp_cd$ WHERE XCOD_KND = 'XBV04' AND LOCALE = #locale#
			) E
			ON A.USF_SCN_CD = E.XCOD_CODE
			LEFT OUTER JOIN
			(
				SELECT * FROM BGAB_GASCZ005$corp_cd$ WHERE XCOD_KND = 'XBV08' AND LOCALE = #locale#
			) H
			ON A.CAR_TYPE_EN = H.XCOD_CODE
			LEFT OUTER JOIN BGAB_GASCZ003$corp_cd$ F
			ON A.DCD = F.XORG_ORGA_C
			LEFT OUTER JOIN BGAB_GASCZ002$corp_cd$ G
			ON A.CRGR_EENO = G.XUSR_EMPNO
		) A
		WHERE  1 = 1
		<isNotEmpty property="vehl_cd" prepend="and">
			VEHL_CD = #vehl_cd#
		</isNotEmpty>
		<isNotEmpty property="car_type_cd" prepend="and">
			CAR_TYPE_CD = #car_type_cd#
		</isNotEmpty>
		<isNotEmpty property="car_type_en" prepend="and">
			CAR_TYPE_EN = #car_type_en#
		</isNotEmpty>
		<isNotEmpty property="dcd" prepend="and">
			DCD = #dcd#
		</isNotEmpty>
		<isNotEmpty property="crgr_eeno" prepend="and">
			CRGR_EENO = #crgr_eeno#
		</isNotEmpty>
		<isNotEmpty property="crgr_eeno_nm" prepend="and">
			CRGR_EENO_NM LIKE '%' || #crgr_eeno_nm# || '%'
		</isNotEmpty>
		<isNotEmpty property="chss_no" prepend="and">
			CHSS_NO LIKE '%' || #chss_no# || '%'
		</isNotEmpty>
		<isNotEmpty property="car_no" prepend="and">
			CAR_NO LIKE '%' || #car_no# || '%'
		</isNotEmpty>
		<isNotEmpty property="rgst_no" prepend="and">
			RGST_NO LIKE '%' || #rgst_no# || '%'
		</isNotEmpty>
		<isNotEmpty property="usf_scn_cd" prepend="and">
			USF_SCN_CD = #usf_scn_cd#
		</isNotEmpty>
		<isNotEmpty property="regn_cd" prepend="and">
			REGN_CD = #regn_cd#
		</isNotEmpty>
	</select>

	<select id="selectListBvToVehicleList" parameterClass="bgabGascbv01Dto" resultClass="bgabGascbv01Dto">
		/*selectListBvToVehicleList*/
		SELECT *
		FROM
		(
			SELECT rownum rnum, X.*
			FROM
			(
				SELECT CHSS_NO
					 , VEHL_CD
					 , VEHL_COLR
					 , CAR_TYPE_CD
					 , CAR_TYPE_EN
					 , KOIL_CRD
					 , BULLT_PRF_YN
					 , DCD
					 , CRGR_EENO
					 , CRGR_EENO_NM
					 , COST_CD
					 , REGN_CD
					 , USF_SCN_CD
					 , ASST_RGS_YMD
					 , CAR_NO
					 , CAR_NO_VLD_TRM_STRT_YMD
					 , CAR_NO_VLD_TRM_FNH_YMD
					 , RGST_NO
					 , RGST_NO_VLD_TRM_STRT_YMD
					 , RGST_NO_VLD_TRM_FNH_YMD
					 , INSU_NO
					 , INSU_NO_VLD_TRM_STRT_YMD
					 , INSU_NO_VLD_TRM_FNH_YMD
					 , APL_STRT_TRVG_DIST
					 , TRBL_STTS_SBC
					 , CEQ_BKGD_SBC
					 , PNLT_SBC
					 , BULLT_PRF_SBC
					 , REM_SBC
					 , INP_YMD
					 , IPE_EENO
					 , MDFY_YMD
					 , UPDR_EENO
				FROM (
					SELECT 	A.CHSS_NO
							,B.XCOD_HNAME AS VEHL_CD
							,A.VEHL_COLR
							,C.XCOD_HNAME AS CAR_TYPE_CD
							,H.XCOD_HNAME AS CAR_TYPE_EN
							,A.KOIL_CRD
							,A.BULLT_PRF_YN
							,F.XORG_ORGA_E AS DCD
							,A.CRGR_EENO
							,G.XUSR_NAME AS CRGR_EENO_NM
							,A.COST_CD
							,D.XCOD_HNAME AS REGN_CD
							,E.XCOD_HNAME AS USF_SCN_CD
							,A.ASST_RGS_YMD
							,A.CAR_NO
							,A.CAR_NO_VLD_TRM_STRT_YMD
							,A.CAR_NO_VLD_TRM_FNH_YMD
							,A.RGST_NO
							,A.RGST_NO_VLD_TRM_STRT_YMD
							,A.RGST_NO_VLD_TRM_FNH_YMD
							,A.INSU_NO
							,A.INSU_NO_VLD_TRM_STRT_YMD
							,A.INSU_NO_VLD_TRM_FNH_YMD
							,A.APL_STRT_TRVG_DIST
							,A.TRBL_STTS_SBC
							,A.CEQ_BKGD_SBC
							,A.PNLT_SBC
							,A.BULLT_PRF_SBC
							,A.REM_SBC
							,A.INP_YMD
							,A.IPE_EENO
							,A.MDFY_YMD
							,A.UPDR_EENO
					FROM BGAB_GASCBV01$corp_cd$ A
					LEFT OUTER JOIN
					(
						SELECT * FROM BGAB_GASCZ005$corp_cd$ WHERE XCOD_KND = 'XBV01' AND LOCALE = #locale#
					) B
					ON A.VEHL_CD = B.XCOD_CODE
					LEFT OUTER JOIN
					(
						SELECT * FROM BGAB_GASCZ005$corp_cd$ WHERE XCOD_KND = 'XBV07' AND LOCALE = #locale#
					) C
					ON A.CAR_TYPE_CD = C.XCOD_CODE
					LEFT OUTER JOIN
					(
						SELECT * FROM BGAB_GASCZ005$corp_cd$ WHERE XCOD_KND = 'XBV03' AND LOCALE = #locale#
					) D
					ON A.REGN_CD = D.XCOD_CODE
					LEFT OUTER JOIN
					(
						SELECT * FROM BGAB_GASCZ005$corp_cd$ WHERE XCOD_KND = 'XBV04' AND LOCALE = #locale#
					) E
					ON A.USF_SCN_CD = E.XCOD_CODE
					LEFT OUTER JOIN
					(
						SELECT * FROM BGAB_GASCZ005$corp_cd$ WHERE XCOD_KND = 'XBV08' AND LOCALE = #locale#
					) H
					ON A.CAR_TYPE_EN = H.XCOD_CODE
					LEFT OUTER JOIN BGAB_GASCZ003$corp_cd$ F
					ON A.DCD = F.XORG_ORGA_C
					LEFT OUTER JOIN BGAB_GASCZ002$corp_cd$ G
					ON A.CRGR_EENO = G.XUSR_EMPNO
				) A
				WHERE  1 = 1
				<isNotEmpty property="vehl_cd" prepend="and">
					VEHL_CD = #vehl_cd#
				</isNotEmpty>
				<isNotEmpty property="car_type_cd" prepend="and">
					CAR_TYPE_CD = #car_type_cd#
				</isNotEmpty>
				<isNotEmpty property="car_type_en" prepend="and">
					CAR_TYPE_EN = #car_type_en#
				</isNotEmpty>
				<isNotEmpty property="dcd" prepend="and">
					DCD = #dcd#
				</isNotEmpty>
				<isNotEmpty property="crgr_eeno" prepend="and">
					CRGR_EENO = #crgr_eeno#
				</isNotEmpty>
				<isNotEmpty property="crgr_eeno_nm" prepend="and">
					CRGR_EENO_NM LIKE '%' || #crgr_eeno_nm# || '%'
				</isNotEmpty>
				<isNotEmpty property="chss_no" prepend="and">
					CHSS_NO LIKE '%' || #chss_no# || '%'
				</isNotEmpty>
				<isNotEmpty property="car_no" prepend="and">
					CAR_NO LIKE '%' || #car_no# || '%'
				</isNotEmpty>
				<isNotEmpty property="rgst_no" prepend="and">
					RGST_NO LIKE '%' || #rgst_no# || '%'
				</isNotEmpty>
				<isNotEmpty property="usf_scn_cd" prepend="and">
					USF_SCN_CD = #usf_scn_cd#
				</isNotEmpty>
				<isNotEmpty property="regn_cd" prepend="and">
					REGN_CD = #regn_cd#
				</isNotEmpty>
				ORDER BY CHSS_NO ASC
			)X
		)K
		WHERE rnum BETWEEN #startRow# AND #endRow#
	</select>

   <select id="selectCountBvToCodeManagement" parameterClass="bgabGascbv03Dto" resultClass="String">
		/*selectCountBvToCodeManagement*/
		SELECT COUNT(*) AS tot_cnt
		FROM BGAB_GASCBV03$corp_cd$
		WHERE   1 = 1
		<isNotEmpty property="bv_ty" prepend="and">
			BV_TY = #bv_ty#
		</isNotEmpty>

	</select>
	<select id="selectListBvToCodeManagement" parameterClass="bgabGascbv03Dto" resultClass="bgabGascbv03Dto">
		/*selectListBvToCodeManagement*/
		SELECT *
		FROM
		(
			SELECT rownum rnum, X.*
			FROM
			(
				SELECT 	BV_TY
						,BV_CD
						,BV_NM
						,BV_SRT
						,USE_YN
						,INP_YMD
						,IPE_EENO
						,MDFY_YMD
						,UPDR_EENO
						,BV_TY AS BV_TY_H
						,BV_CD AS BV_CD_H
				FROM BGAB_GASCBV03$corp_cd$
				WHERE	1 = 1
				<isNotEmpty property="bv_ty" prepend="and">
					BV_TY = #bv_ty#
				</isNotEmpty>
				ORDER BY BV_TY ASC, BV_SRT ASC
			)X
		)K
		WHERE rnum BETWEEN #startRow# AND #endRow#
	</select>

	<update id="insertBvToCodeManagement" parameterClass="bgabGascbv03Dto">
     /*insertBvToCodeManagement*/
     INSERT INTO BGAB_GASCBV03$corp_cd$(
		BV_TY
		,BV_CD
		,BV_NM
		,BV_SRT
		,USE_YN
		,INP_YMD
		,IPE_EENO
		,MDFY_YMD
		,UPDR_EENO
	) VALUES (
		#bv_ty#
		,#bv_cd#
		,#bv_nm#
		,#bv_srt#
		,#use_yn#
		,TO_CHAR( TO_DATE( SYSDATE,'YYYY-MM-DD' ),'YYYYMMDD' )
		,#ipe_eeno#
		,TO_CHAR( TO_DATE( SYSDATE,'YYYY-MM-DD' ),'YYYYMMDD' )
		,#updr_eeno#
	)
	ON DUPLICATE KEY
	UPDATE
		    BV_CD               = #bv_cd#,
			BV_NM          		= #bv_nm#,
			BV_SRT           	= #bv_srt#,
			USE_YN            	= #use_yn#,
			UPDR_EENO        	= #updr_eeno#,
			MDFY_YMD 			= SYSDATE
   </update>
   <delete id="deleteBvToCodeManagement" parameterClass="bgabGascbv03Dto">
   		DELETE 	FROM BGAB_GASCBV03$corp_cd$
   		WHERE 	1 = 1
   		AND		BV_TY = #bv_ty#
   		AND		BV_CD = #bv_cd#
   </delete>


   <select id="selectCountBvToVehicleRegInfo" parameterClass="bgabGascbv01Dto" resultClass="String">
		/*selectCountBvToVehicleRegInfo*/
		SELECT COUNT(*) AS tot_cnt
		FROM BGAB_GASCBV01$corp_cd$
		WHERE  1 = 1
		AND
		(
			CAR_NO_VLD_TRM_FNH_YMD &lt; CAST( TO_DATE( DATE_ADD(SYSDATE, Interval 1 month),'YYYYMMDD' ) AS CHAR(8) )
			OR RGST_NO_VLD_TRM_FNH_YMD &lt; CAST( TO_DATE( DATE_ADD(SYSDATE, Interval 1 month),'YYYYMMDD' ) AS CHAR(8) )
			OR INSU_NO_VLD_TRM_FNH_YMD &lt; CAST( TO_DATE( DATE_ADD(SYSDATE, Interval 1 month),'YYYYMMDD' ) AS CHAR(8) )
		)
		<isNotEmpty property="chss_no" prepend="and">
			CHSS_NO = #chss_no#
		</isNotEmpty>
		<isNotEmpty property="vehl_cd" prepend="and">
			VEHL_CD = #vehl_cd#
		</isNotEmpty>
		<isNotEmpty property="car_type_cd" prepend="and">
			CAR_TYPE_CD = #car_type_cd#
		</isNotEmpty>
		<isNotEmpty property="regn_cd" prepend="and">
			REGN_CD = #regn_cd#
		</isNotEmpty>
		<isNotEmpty property="dcd" prepend="and">
			DCD = #dcd#
		</isNotEmpty>
		<isNotEmpty property="car_no" prepend="and">
			CAR_NO LIKE '%' || #car_no# || '%'
		</isNotEmpty>
		<isNotEmpty property="rgst_no" prepend="and">
			RGST_NO LIKE '%' || #rgst_no# || '%'
		</isNotEmpty>
		<isNotEmpty property="insu_no" prepend="and">
			INSU_NO LIKE '%' || #insu_no# || '%'
		</isNotEmpty>

	</select>
	<select id="selectListBvToVehicleRegInfo" parameterClass="bgabGascbv01Dto" resultClass="bgabGascbv01Dto">
		/*selectListBvToVehicleRegInfo*/
		SELECT *
		FROM
		(
			SELECT 	ROW_NUMBER() OVER(ORDER BY CHSS_NO ASC) AS rnum
					,A.CHSS_NO
					,B.XCOD_HNAME AS VEHL_CD
					,A.VEHL_COLR
					,C.XCOD_HNAME AS CAR_TYPE_CD
					,A.KOIL_CRD
					,A.BULLT_PRF_YN
					,E.XORG_ORGA_E AS DCD
					,A.COST_CD
					,D.XCOD_HNAME AS REGN_CD
					,A.USF_SCN_CD
					,A.ASST_RGS_YMD
					,A.CAR_NO
					,TO_CHAR( A.CAR_NO_VLD_TRM_STRT_YMD,'YYYY-MM-DD' ) AS CAR_NO_VLD_TRM_STRT_YMD
					,TO_CHAR( A.CAR_NO_VLD_TRM_FNH_YMD,'YYYY-MM-DD' ) AS CAR_NO_VLD_TRM_FNH_YMD
					,A.RGST_NO
					,TO_CHAR( A.RGST_NO_VLD_TRM_STRT_YMD,'YYYY-MM-DD' ) AS RGST_NO_VLD_TRM_STRT_YMD
					,TO_CHAR( A.RGST_NO_VLD_TRM_FNH_YMD,'YYYY-MM-DD' ) AS RGST_NO_VLD_TRM_FNH_YMD
					,A.INSU_NO
					,TO_CHAR( A.INSU_NO_VLD_TRM_STRT_YMD,'YYYY-MM-DD' ) AS INSU_NO_VLD_TRM_STRT_YMD
					,TO_CHAR( A.INSU_NO_VLD_TRM_FNH_YMD,'YYYY-MM-DD' ) AS INSU_NO_VLD_TRM_FNH_YMD
					,A.APL_STRT_TRVG_DIST
					,A.TRBL_STTS_SBC
					,A.CEQ_BKGD_SBC
					,A.REM_SBC
					,A.INP_YMD
					,A.IPE_EENO
					,A.MDFY_YMD
					,A.UPDR_EENO
			FROM BGAB_GASCBV01$corp_cd$ A
			LEFT OUTER JOIN
			(
				SELECT * FROM BGAB_GASCZ005$corp_cd$ WHERE XCOD_KND = 'XBV01'
			) B
			ON A.VEHL_CD = B.XCOD_CODE
			LEFT OUTER JOIN
			(
				SELECT * FROM BGAB_GASCZ005$corp_cd$ WHERE XCOD_KND = 'XBV02'
			) C
			ON A.CAR_TYPE_CD = C.XCOD_CODE
			LEFT OUTER JOIN
			(
				SELECT * FROM BGAB_GASCZ005$corp_cd$ WHERE XCOD_KND = 'XBV03'
			) D
			ON A.REGN_CD = D.XCOD_CODE
			LEFT OUTER JOIN BGAB_GASCZ003$corp_cd$ E
			ON A.DCD = E.XORG_ORGA_C
			WHERE  1 = 1
			AND
			(
				CAR_NO_VLD_TRM_FNH_YMD &lt; CAST( TO_DATE( DATE_ADD(SYSDATE, Interval 1 month),'YYYYMMDD' ) AS CHAR(8) )
				OR RGST_NO_VLD_TRM_FNH_YMD &lt; CAST( TO_DATE( DATE_ADD(SYSDATE, Interval 1 month),'YYYYMMDD' ) AS CHAR(8) )
				OR INSU_NO_VLD_TRM_FNH_YMD &lt; CAST( TO_DATE( DATE_ADD(SYSDATE, Interval 1 month),'YYYYMMDD' ) AS CHAR(8) )
			)
			<isNotEmpty property="chss_no" prepend="and">
				A.CHSS_NO = #chss_no#
			</isNotEmpty>
			<isNotEmpty property="vehl_cd" prepend="and">
				A.VEHL_CD = #vehl_cd#
			</isNotEmpty>
			<isNotEmpty property="car_type_cd" prepend="and">
				A.CAR_TYPE_CD = #car_type_cd#
			</isNotEmpty>
			<isNotEmpty property="regn_cd" prepend="and">
				A.REGN_CD = #regn_cd#
			</isNotEmpty>
			<isNotEmpty property="dcd" prepend="and">
				A.DCD = #dcd#
			</isNotEmpty>
			<isNotEmpty property="car_no" prepend="and">
				A.CAR_NO LIKE '%' || #car_no# || '%'
			</isNotEmpty>
			<isNotEmpty property="rgst_no" prepend="and">
				A.RGST_NO LIKE '%' || #rgst_no# || '%'
			</isNotEmpty>
			<isNotEmpty property="insu_no" prepend="and">
				A.INSU_NO LIKE '%' || #insu_no# || '%'
			</isNotEmpty>
		)X
		WHERE rnum BETWEEN #startRow# AND #endRow#
	</select>
   <insert id="insertBvToFile" parameterClass="BgabGascZ011Dto">
		INSERT INTO BGAB_GASCZ011$corp_cd$ (
			DOC_NO				,
			EENO				,
			SEQ					,
			AFFR_SCN_CD			,
			OGC_FIL_NM			,
			FIL_NM				,
			FIL_MGN_QTY			,
			INP_YMD				,
			IPE_EENO
		)VALUES(
			#doc_no#			,
			#eeno#				,
			#seq#				,
			#affr_scn_cd#		,
			#ogc_fil_nm#		,
			#fil_nm#			,
			#fil_mgn_qty#		,
			SYSDATE,
			#ipe_eeno#
		)
   </insert>

   <select id="selectBvToFile" resultClass="BgabGascZ011Dto" parameterClass="BgabGascZ011Dto">
		SELECT
			DOC_NO				,
			EENO				,
			SEQ					,
			AFFR_SCN_CD			,
			FIL_NM				,
			OGC_FIL_NM			,
			FIL_MGN_QTY			,
			INP_YMD				,
			IPE_EENO
		FROM BGAB_GASCZ011$corp_cd$
		WHERE DOC_NO = #doc_no#
		AND EENO = #eeno#
		AND SEQ = #seq#
		AND AFFR_SCN_CD = #affr_scn_cd#
		<isNotEmpty property="ogc_fil_nm" prepend="and">
			OGC_FIL_NM = #ogc_fil_nm#
		</isNotEmpty>
		ORDER BY FIL_NM
   </select>

   <delete id="deleteBvToFile" parameterClass="BgabGascZ011Dto">
		DELETE FROM BGAB_GASCZ011$corp_cd$
		WHERE DOC_NO = #doc_no#
		AND EENO = #eeno#
		AND SEQ = #seq#
		AND AFFR_SCN_CD = #affr_scn_cd#
		AND OGC_FIL_NM = #ogc_fil_nm#
   </delete>

	<update id="updateInfoBvToReject" parameterClass="bgabGascbv02Dto">
	/* updateInfoBvToReject */
   		UPDATE	BGAB_GASCBV02$corp_cd$
		SET 	PGS_ST_CD  = #pgs_st_cd#
				,IF_ID     = ''
				,RPTS_EENO = ''
				,RPTS_YMD  = ''
				,RDCS_EENO = ''
				,RDCS_YMD  = ''
				,ACPC_EENO = ''
				,ACPC_YMD  = ''
				,SNB_RSON_SBC = #snb_rson_sbc#
				,UPDR_EENO = #updr_eeno#
				,MDFY_YMD  = SYSDATE
		WHERE	1 = 1
		AND		DOC_NO = #doc_no#
	</update>

	<insert id="insertMaintenanceToFile" parameterClass="BgabGascZ011Dto">
		/* insertMaintenanceToFile */
		INSERT INTO BGAB_GASCZ011$corp_cd$ (
			DOC_NO ,
			EENO ,
			SEQ ,
			AFFR_SCN_CD ,
			OGC_FIL_NM ,
			FIL_NM ,
			FIL_MGN_QTY ,
			INP_YMD ,
			IPE_EENO
		)VALUES(
			#doc_no# ,
			#eeno# ,
			#seq# ,
			#affr_scn_cd# ,
			#ogc_fil_nm# ,
			#fil_nm# ,
			#fil_mgn_qty# ,
			SYSDATE,
			#ipe_eeno#
		)
	</insert>

	<select id="selectMaintenanceToFile" resultClass="BgabGascZ011Dto" parameterClass="BgabGascZ011Dto">
		/* selectMaintenanceToFile */
		SELECT
			DOC_NO ,
			EENO ,
			SEQ ,
			AFFR_SCN_CD ,
			FIL_NM ,
			OGC_FIL_NM ,
			FIL_MGN_QTY ,
			INP_YMD ,
			IPE_EENO
		FROM BGAB_GASCZ011$corp_cd$
		WHERE DOC_NO = #doc_no#
		AND EENO = #eeno#
		AND SEQ = #seq#
		AND AFFR_SCN_CD = #affr_scn_cd#
		<isNotEmpty property="ogc_fil_nm" prepend="and">
			OGC_FIL_NM = #ogc_fil_nm#
		</isNotEmpty>
		ORDER BY FIL_NM
	</select>

	<delete id="deleteMaintenanceToFile" parameterClass="BgabGascZ011Dto">
		/* deleteMaintenanceToFile */
		DELETE FROM BGAB_GASCZ011$corp_cd$
		WHERE DOC_NO = #doc_no#
		AND EENO = #eeno#
		AND SEQ = #seq#
		AND AFFR_SCN_CD = #affr_scn_cd#
		AND OGC_FIL_NM = #ogc_fil_nm#
	</delete>

	  <update id="updateInfoBvToApproveStatus" parameterClass="bgabGascbv02Dto">
	  /* updateInfoBvToApproveStatus */
   		UPDATE	BGAB_GASCBV02$corp_cd$
		SET 	PGS_ST_CD  = #pgs_st_cd#
				,UPDR_EENO = #updr_eeno#
				,MDFY_YMD  = SYSDATE
		WHERE	DOC_NO = #doc_no#
   </update>

   <select id="selectCountMaintenanceExpenseManagement" parameterClass="BgabGascbt06" resultClass="String">
		/* businessVehicles.xml :: selectCountMaintenanceExpenseManagement */
		SELECT
		COUNT(NAT_G_SCN_CD)
		FROM BGAB_GASCBV04$corp_cd$
		WHERE 1 = 1
		<isNotEmpty property="prvs_scn_cd" prepend="and">
			PRVS_SCN_CD =
			#prvs_scn_cd#
		</isNotEmpty>
	</select>

	<select id="selectMaintenanceExpenseManagement" resultClass="BgabGascbt06"
		parameterClass="BgabGascbt06">
		/* businessVehicles.xml :: selectMaintenanceExpenseManagement */
		SELECT * FROM (
			SELECT rownum rnum, k.*
			FROM(
				SELECT
				NAT_G_SCN_CD AS NAT_G_SCN_CD_OLD ,
				NAT_G_SCN_CD ,
				SEQ ,
				POA_G1_AMT ,
				POA_G2_AMT ,
				POA_G3_AMT ,
				POA_G4_AMT ,
				POA_G6_AMT
				FROM BGAB_GASCBV04$corp_cd$
				WHERE 1 = 1
				<isNotEmpty property="nat_g_scn_cd" prepend="and">
					nat_g_scn_cd = #nat_g_scn_cd#
				</isNotEmpty>
				ORDER BY NAT_G_SCN_CD, SEQ
			) k
		) j WHERE rnum between #startRow# AND #endRow#
	</select>

	<insert id="insertListToMaintenanceExpenseManagement" parameterClass="BgabGascbt06">
		/*
		businessVehicles.xml :: insertListToMaintenanceExpenseManagement */
		INSERT INTO BGAB_GASCBV04$corp_cd$ (
		nat_g_scn_cd ,
		seq ,
		poa_g1_amt ,
		poa_g2_amt ,
		poa_g3_amt ,
		poa_g4_amt ,
		poa_g6_amt ,
		inp_ymd ,
		ipe_eeno ,
		mdfy_ymd ,
		updr_eeno
		)VALUES(
		#nat_g_scn_cd# ,
		(SELECT NVL(MAX(SEQ), 0) + 1
		FROM BGAB_GASCBV04$corp_cd$
		WHERE nat_g_scn_cd = #nat_g_scn_cd#) ,
		#poa_g1_amt# ,
		#poa_g2_amt# ,
		#poa_g3_amt# ,
		#poa_g4_amt# ,
		#poa_g6_amt# ,
		SYSDATE ,
		#ipe_eeno# ,
		SYSDATE ,
		#updr_eeno#
		)
	</insert>

	<update id="updateListToMaintenanceExpenseManagement" parameterClass="BgabGascbt06">
		/*
		businessVehicles.xml :: updateListToMaintenanceExpenseManagement */
		UPDATE
		BGAB_GASCBV04$corp_cd$ SET
		nat_g_scn_cd = #nat_g_scn_cd# ,
		poa_g1_amt = #poa_g1_amt# ,
		poa_g2_amt = #poa_g2_amt# ,
		poa_g3_amt = #poa_g3_amt# ,
		poa_g4_amt = #poa_g4_amt# ,
		poa_g6_amt = #poa_g6_amt# ,
		mdfy_ymd = SYSDATE ,
		updr_eeno = #updr_eeno#
		WHERE nat_g_scn_cd = #nat_g_scn_cd_old#
		AND seq = #seq#
	</update>

	<delete id="deleteListToMaintenanceExpenseManagement" parameterClass="BgabGascbt06">
		/*
		businessVehicles.xml :: deleteListToMaintenanceExpenseManagement */
		DELETE FROM
		BGAB_GASCBV04$corp_cd$
		WHERE NAT_G_SCN_CD = #nat_g_scn_cd#
		AND SEQ = #seq#
	</delete>

</sqlMap>
